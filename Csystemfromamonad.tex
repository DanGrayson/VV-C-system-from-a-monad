\documentclass[12pt]{amsart}
\usepackage[utf8]{inputenc}
\usepackage{csquotes}
\usepackage[pdf,all,2cell]{xy}\SelectTips{cm}{10}\SilentMatrices\UseAllTwocells
\usepackage{amsmath, amssymb, amsfonts, amsthm, amscd}
\usepackage[T1]{fontenc}
\usepackage{verbatim}
\usepackage{xspace}
\usepackage{xcolor}
\usepackage{url}
\usepackage{hyperref}
\usepackage{graphicx}
%\usepackage{eufrak}
%\usepackage{amscd, amssymb}
%\usepackage{enumerate}
%
\usepackage{enumitem}
\setlist[enumerate]{topsep=0pt,itemsep=.5ex,partopsep=1ex,parsep=1ex}
\setenumerate[1]{label=(\arabic*)}
\setenumerate[0]{label=(\arabic{enumi}.\arabic{enumii}) }
%
%\usepackage{hyperref}
% lscape.sty Produce landscape pages in a (mainly) portrait document.
%\usepackage{lscape}
%
\textwidth = 6 in
\textheight = 9 in
\oddsidemargin = 0.0 in
\evensidemargin = 0.0 in
%\topmargin = 0.0 in
%\headheight = 0.0 in
%\headsep = 0.0 in
%\parindent = 0.0in

%\renewcommand{\thesubsection}{\arabic{subsection}}
%
%
%
%\newenvironment{proof}{{\bf Proof}:}{\vskip 5mm }
\newenvironment{rem}{{\bf Remark}:}{\vskip 5mm }
\newenvironment{remarks}{{\bf Remarks}:\begin{enumerate}}{\end{enumerate}}
\newenvironment{examples}{{\bf Examples}:\begin{enumerate}}{\end{enumerate}}  
%
\newtheorem{proposition}{Proposition}[section]
\newtheorem{lemma}[proposition]{Lemma}
\newtheorem{definition}[proposition]{Definition}
\newtheorem{theorem}[proposition]{Theorem}
\newtheorem{cor}[proposition]{Corollary}
\newtheorem{conjecture}{Conjecture}
\newtheorem{pretheorem}[proposition]{Pretheorem}
\newtheorem{hypothesis}[proposition]{Hypothesis}
\newtheorem{example}[proposition]{Example}
\newtheorem{remark}[proposition]{Remark}
\newtheorem{ex}[proposition]{Exercise}
\newtheorem{cond}[proposition]{Conditions}
\newtheorem{cons}[proposition]{Construction}

\newtheorem{problem}[proposition]{Problem}
\newtheorem{construction}[proposition]{Construction}
%

%
%
%\newcommand{\C}[4]{\preceqft[\begin{array}{rcl}&#1\\#3&\dw\dw&#4\\&#2\end{array}\right]}
%\newcommand{\llabel}[1]{\label{#1}[{\bf #1}]}
\newcommand{\llabel}[1]{\label{#1}}
\renewcommand{\comment}[1]{}    %commenting this out results in an empty pdf file
\newcommand{\sr}{\rightarrow}
\newcommand{\lr}{\longrightarrow}
\newcommand{\xr}{\xrightarrow}
\newcommand{\dw}{\downarrow}
\newcommand{\nn}{{\mathbb N}}
\newcommand{\nat}{\nn}
\newcommand{\oo}{\otimes}
\newcommand{\uu}{\underline}
\newcommand{\ih}{\uu{Hom}}
\newcommand{\af}{{\bf A}^1}
\newcommand{\wt}{\widetilde}
\newcommand{\gm}{{\bf G}_m}
\newcommand{\dsr}{\stackrel{\sr}{\scriptstyle\sr}}
%\newcommand{\PP}{$P_{\infty}$}
\newcommand{\tp}{\wt{D}}
\newcommand{\HH}{$H_{\infty}$}
\newcommand{\ii}{\stackrel{\scriptstyle\sim}{\sr}}
\newcommand{\BB}{_{\bullet}}
\newcommand{\DD}{\Delta}
\newcommand{\colim}{{\rm co}\hspace{-1mm}\lim}
\newcommand{\cf}{{\it cf} }
\newcommand{\msf}{\mathsf }
\newcommand{\mcal}{\mathcal }
\newcommand{\ep}{\epsilon}
\newcommand{\tl}{\widetilde}
\newcommand{\ub}{\mbox{\rotatebox{90}{$\in$}}}
\newcommand{\ssp}{\,\,\,\,\,\,\,\,}
\newcommand{\red}{\twoheadrightarrow}
\newcommand{\eqg}{\stackrel{\Gamma}{\approx}}
\newcommand{\alphaeq}{\stackrel{\alpha}{\sim}}
\newcommand{\rtr}{\triangleright}
\newcommand{\wh}{\widehat}
\newcommand{\bind}[1]{{#1^*}}
\newcommand{\mbind}[1]{{#1^*}}
\newcommand{\hc}{\circ_{T}}
%
\newcommand{\piece}{\vskip 3mm\noindent\refstepcounter{proposition}{\bf
\theproposition}\hspace{2mm}}
\newcommand{\subpiece}{\vskip 3mm\noindent\refstepcounter{equation}{\bf\theequation}
\hspace{2mm}}{\vskip
3mm}

\newcommand{\spc}{{\,\,\,\,\,\,\,}}
\newcommand{\impl}{{\Rightarrow}}

\newcommand{\B}{{\bf B}}
\newcommand{\TT}{{\bf T}}
\renewcommand{\SS}{{\bf S}}
\newcommand{\BD}{{\bf BD}}

\newcommand{\JJ}{{\mathcal J}}

\newcommand{\R}{{\bf R}}

\newcommand{\RR}{{\bf RR}}
\newcommand{\LM}{{\bf LM}}

\newcommand{\rh}{{\,\rhd\,\,}}
\newcommand{\type}{\,\,type}

\newcommand{\C}{{\mathcal C}}
\newcommand{\D}{{\mathcal D}}
\newcommand{\E}{{\mathcal E}}
\newcommand{\F}{{\mathcal F}}

\newcommand{\FF}{{\mathbb F}}

\newcommand{\ff}[1]{\uu{#1}}

\newcommand{\crc}{^{\circ}}
\newcommand{\ec}{\hfill $\square$ \end{construction}}

\begin{document}
%
\parskip = 2mm

\comment{
\begin{center}
{\bf\Large C-system of a module over a $Jf$-relative monad\footnote{\em 2000 Mathematical Subject Classification: 
%
18D99, % category theory and homological algebra, categories with structures, none of the above, but in this section
18C50  %	Categorical semantics of formal languages 
%
}}

%{\keywords Contextual categories, relative monads, modules over monads.}

\vspace{3mm}

{\large\bf Vladimir Voevodsky}\footnote{School of Mathematics, Institute for Advanced Study,
Princeton NJ, USA. e-mail: vladimir@ias.edu}
\vspace {3mm}
%

{\large\bf September 2015}  
\end{center}
}

\title{C-system of a module over a $Jf$-relative monad}
\author{Vladimir Voevodsky}
\address{School of Mathematics, Institute for Advanced Study,
Princeton NJ, USA. e-mail: vladimir@ias.edu
}

\begin{abstract}
Let $\FF$ be the category with the set of objects $\nat$ and morphisms given by
the functions between the standard finite sets of the corresponding
cardinalities. Let $Jf:\FF\sr Sets$ be the obvious functor from this category
to the category of sets. In this paper we construct, for any $Jf$-relative
monad $\RR$ and any left $\RR$-module $\LM$, a C-system $C(\RR,\LM)$ and
explicitly compute the action of the four B-system operations on its B-sets.

In the introduction we explain in detail the relevance of this result to the
construction of the term C-systems of type theories.\end{abstract}

%(2014.09.27) Make a note about the functoriality of C(\RR,\LM) on the "large module category" %of Hirschowitz-Maggesi. 
%Change the name of the monad from M to R. Also \mu, \eta for the monad structure and 
%\rh o for the module structure.

%$$\mathfrak{S}$$

%??? Make the dependence on the choice of a universe explicit? Then need to understand what is required from a set $UU$ or a type universe $UU$ in order to be able to realize the results of this paper. Can one consider LM in Prop? Is it relevant for the formalization of predicate logic?

%### Update references based on what has been already published.

%###!! What does it mean to add some constants and some definitional equalities to a type theory. Maybe to a type theory in a Martin-Lof presentation???

%###replace [ '] and [' ] with `` and ''?

\maketitle

\tableofcontents

\section{Introduction}

The first few steps in all approaches to the set-theoretic semantics of
dependent type theories remain insufficiently understood. The constructions
that have been worked out in detail in the case of a few particular type
systems by dedicated authors are being extended to the wide variety of type
systems under consideration today by analogy. This is not acceptable in
mathematics. Instead we should be able to obtain the required results for new
type systems by {\em specialization} of general theorems and constructions
formulated for abstract objects, the instances of which combine to
produce a given type system.

%###interpretation instead of representation
%###check references in view of publication of former preprints

%???!!## Explain through reference to Martin Hofmann Section 2.3 about pre-syntax. The word "associative" does not even appear in that paper. Sections 2.3, 2.4 The "construction" of term model (which is what the present paper is about) in 3.1 lacks proofs and even precise statements entirely. 

%Also a reference to Jacob where he says that proving associativity is non-trivial. 

%The Ty/Tm definition of CwF appears already in Hofmann (3.1). 

%Mention that our description of general sub-quotients allows to use our results for the study of the semantics of type systems with context-dependent computation.

An approach that follows this general philosophy was outlined in
\cite{CMUtalk}. In this approach the connection between type theories,
which belong to the concrete world of logic and programming, and abstract
mathematical concepts, such as sets or homotopy types, is constructed through the
intermediary of C-systems.

C-systems were introduced in \cite{Cartmell0} (see also \cite{Cartmell1}) under
the name ``contextual categories''. A modified axiomatics of C-systems and the
construction of new C-systems as subobjects and regular quotients of 
existing ones in a way convenient for use in type-theoretic applications is
considered in \cite{Csubsystems}. A C-system equipped with additional
operations corresponding to the inference rules of a type theory is called a
{\em model} or a {\em C-system model} of these rules or of this type theory. There are
other classes of objects on which one can define operations corresponding to
inference rules of type theories, the most important of which is {\em categories with families}.
They lead to other classes of models.

In the approach of \cite{CMUtalk}, in order to provide an interpretation for a
type theory one first constructs two C-systems.  The first C-system, which we will
call the {\em proximate} or {\em term} C-system of a type theory, is constructed from
formulas of the type theory using the main construction of the present paper.
The second C-system is constructed from a category of abstract mathematical
objects using the results of \cite{Cfromauniverse}. These C-systems are then
equipped with additional operations corresponding to the inference rules of the
type theory, making them into models of type theory.  The model whose underlying
C-system is the term C-system is called the {\em term model}.

A crucial component of this approach is the expected result that, for a
particular class of inference rules, the term model is an initial object in the
category of models. This is known as the {\em Initiality Conjecture}. In the case of
the pure Calculus of Constructions with a ``decorated'' application operation
this conjecture was proved in 1988 by Thomas Streicher \cite{Streicher}. The
problem of finding an appropriate formulation of the general version of the
conjecture and of proving this general version will be the subject of future
work.

For such inference rules, then, there is a unique homomorphism from the term
C-system to the abstract C-system that is compatible with the corresponding
systems of operations. Such homomorphisms are called {\em representations} or
{\em interpretations} of the type theory. More generally, any functor from the
category underlying the term C-system of the type theory to another category
may be called a representation of the type theory in that category. Since
the objects and morphisms of term models are built from formulas of the type theory,
and the objects and morphisms of abstract C-systems are built from mathematical
objects, such as sets or homotopy types and the corresponding functions, such
representations provide a mathematical meaning to formulas of type theory.

The existence of these homomorphisms in the particular case of the ``standard
univalent models'' of Martin-L\"{o}f type theories and of the Calculus of
Inductive Constructions (CIC) provides the only known justification for the use
of proof assistants such as {\em Coq} for the formalization of mathematics in the
univalent style \cite{UniMath2015,UniMath}.

Only if we know that the Initiality Conjecture holds for a given type theory can we
claim that a  model defines a representation. A similar  problem also arises in
predicate logic, but there, since one considers  only one fixed  system of
syntax and inference rules, it can be and has been solved once and for all without the
development of a general  theory. The term models for a  class of type theories
can be  obtained by  considering slices of  the term model  of the  type theory
called Logical  Framework (LF), but unfortunately  it is unclear how  to extend
this approach  to type  theories that  have more  substitutional (definitional)
equalities than LF itself.

A construction of a model for the version of Martin-L\"{o}f type theory
that is used in the {\em UniMath} library \cite{UniMath,UniMath2015} is
sketched in \cite{KLV1}. When that paper was written it was
unfortunately assumed that a proof of the Initiality Conjecture can be found in the
existing body of work on type theory, as reflected in \cite[Theorem
  1.2.9]{KLV1}.  (See also \cite[Example 1.2.3]{KLV1}, which claims as obvious
everything that is done in tens of papers by computer scientists, in the
present paper, and in \cite{Csubsystems}).  Since then it became clear that this
is not the case, and that a mathematical theory leading to a proof of the Initiality
Conjecture is lacking and needs to be
developed.

As the criteria for what constitutes an acceptable proof were becoming more
clear as a result of continuing work on formalization, it also became clear
that more detailed and general proofs need to be given for many of the theorems
of \cite{KLV1} that are related to the model itself. For two of the several
main groups of inference rules of current type theories it is done in
\cite{fromunivwithPiI}, \cite{fromunivwithPiII}, and
\cite{fromunivwithpaths}. Other groups of inference rules will be considered in
further papers of that series.

That work concerned the construction of the second, ``abstract'', C-system
model used in the construction of a representation.

The work done in this paper provides the first step in the construction of the
``concrete'' term C-system model. The result of our construction is equivalent
to the results of constructions sketched by earlier authors \cite{Hofmann}. The
main innovation, other than the first careful mathematical proofs of all the
required assertions, is the observation that one can take {\em all} raw
judgments as the source for the construction and build from them a
C-system. The term C-system of a type theory with a given raw syntax is then a
sub-quotient of the raw syntax C-system. The raw syntax C-system can be either
defined directly in a way that allows for a straightforward rigorous
verification of all the axioms, see Remark \ref{}, or understood from the
perspective of the abstract mathematical theory of C-systems as a particular
case of a more general construction of presheaf extensions of C-systems. In
this paper we follow the second path, which also allows us to connect our
construction to the main constructions of \cite{LandJf} and \cite{LandC}.

The description of a type theory in a modern paper is usually given in terms of
five kinds of ``sequents'' originally introduced by Per Martin-L\"{o}f in
\cite[p.~161]{MLTT79}\footnote{This paper is highly recommended. It is a
  foundational one for many ideas of type theory and for the modern approach to
  constructive mathematics in general.}.  If we consider the type theory as a
language, then sequents are complete sentences in this language---the smallest
units that have semantical meaning when an interpretation is chosen. Below we
use the word ``sentence'' instead of the word ``sequent'' to avoid confusion
with the meaning of the word ``sequent'' in logic. The five kinds of sentences
considered by Martin-L\"{o}f are sequences of expressions of the following
forms
%
%
\begin{flalign}
\llabel{2017.02.06.eq1}
x_0:T_0,\dots,x_{n-1}:T_{n-1}\rh& ok\\
\llabel{2017.02.06.eq2}
x_0:T_0,\dots,x_{n-1}:T_{n-1}\rh& T\type\\
\llabel{2017.02.06.eq3}
x_0:T_0,\dots,x_{n-1}:T_{n-1}\rh& t:T\\
\llabel{2017.02.06.eq4}
x_0:T_0,\dots,x_{n-1}:T_{n-1}\rh& T\equiv T'\\
\llabel{2017.02.06.eq5}
x_0:T_0,\dots,x_{n-1}:T_{n-1}\rh& t\equiv t':T
\end{flalign}
%
Here $x_0,\dots,x_{n-1}$ are names of variables, $T_i$ is an expression with
free variables from the set $\{x_0,\dots,x_{i-1}\}$, and $T$ and $t$ are
expressions with free variables from the set $\{x_0,\dots,x_{n-1}\}$. If one
wants to emphasize that a variable $x$ may appear as a free variable in the
expression $T$ one writes $T(x)$, but {\em in most cases the set of allowed
  free variables in an expression should be inferred from its position in the
  sentence}.

In many modern papers on type theory the symbol $\vdash$ is used where we use
the triangle symbol $\rh$. We made this choice because the meaning of the
former symbol in type theory may conflict with its meaning in logic.

The part of a sentence to the left of $\rh$ is called the {\em context} and the part
to the right of this symbol is called the {\em judgment}. When the names of
variables and the expressions of the context are not important or can be
inferred from some data or conventions, it is customary to denote the context
by a capital Greek letter, such as $\Gamma$ or $\Delta$.

There are some other versions equivalent to Martin-L\"{o}f's approach. For
example, Martin Hofmann, in \cite{Hofmann}, considers six kinds of judgments,
adding equality of contexts, $\rh \Gamma\equiv\Delta$, as a separate kind.

In any approach sentences are sequences of expressions with some restrictions
on allowed free variables. Therefore we may say:

{\em The first step towards a mathematical theory of type theories is to find a
  way to view ``expressions'' as mathematical objects.}

In practice, what ``expressions'' are, and how they are used to form the sentences of a type theory,
is most likely to be specified in detail when this type theory is
used as a basis of a computer proof assistant. Depending on the programming
language in which the proof assistant is written and on the personal tastes of
the developers, ``expressions'' will be represented as elements of various
datatypes. They may be represented as strings of characters, or as trees
with labels at nodes and edges, or as something else entirely.  While
each of these representations can be given a precise mathematical form, it would
clearly be wrong to make the mathematical theory of type theories dependent on
which of these representations is chosen.  Therefore, we need a concept of
abstract expression, or, as we will see below, two concepts: one for abstract
element expressions and one for abstract type expressions.

This problem has been addressed by many authors, first in the context of
algebraic expressions, and later in the context of expressions with binders,
that is, expressions that may contain bound variables. As far as we know, the
first mathematical abstraction in the case of expressions with binders was
described by Fiore, Plotkin and Turi in \cite{FPT}. Later a different abstraction,
more convenient for mathematicians, was described by Hirschowitz and
Maggesi in a series of papers, which includes \cite{HM2010}.  The two approaches were
shown to be equivalent in \cite{ACU,ACU2} using the concept of {\em well
behaved functor}.
%### Is it true? Ask Fiore to check and find references.  DRG - I've asked Marcelo.
The proof of equivalence in \cite{ACU,ACU2} was based on the important
observation that the monoids of \cite{FPT} are particular cases of {\em
  relative monads}.

These results would have closed the issue, and in
this paper we probably would have used the concept of abstract expression
due to Hirschowitz and Maggesi, which is based
on the concept of a monad, if not for the fact that the proof of the equivalence
uses the axiom of choice.

This may be the place to say a few words about the intended meta-theories of
the present paper. By an intended meta-theory of a paper we mean a foundation
of mathematics in which its results can be stated and proved. It has become
customary not to specify intended meta-theories for papers in pure mathematics
due to the tacit assumption that this meta-theory is Zermelo-Fraenkel set
theory with the Axiom of Choice (ZFC).  Here ZFC, or any other foundation that we
may mention, is considered as a body of mathematical knowledge that includes
both the underlying formal theory and the dictionary that is needed to
translate informal mathematics into the statements about this formal system. In
the case of ZFC, the formal deduction system is classical predicate logic
with a distinguished theory, and statements of informal mathematics are
translated into statements of provability for various formulas of this
theory.

We intend two meta-theories for the present paper. The first one is 
ZFC with a Grothendieck universe $U$. The second one is a univalent foundation
called {\em UniMath}.  We consider ZFC to be the primary meta-theory and {\em UniMath} a
secondary one. That is, we take care to adapt our definitions and proofs
precisely for ZFC, while accepting that {\em UniMath} formalization will require
some small degree of modification.
%
Having {\em UniMath} as a secondary meta-theory imposes strong
restrictions on the features of ZFC that we can use.  Most
notably, we can not use the law of excluded middle and we can not use the axiom
of choice.

Let us go back to the concept of abstract expression. Let us consider the
case of algebraic expressions first.  The modern mathematical theory of algebraic
expressions has been developed at least as far back as the 1963 Ph.D.{} thesis of
Bill Lawvere \cite{Lawvere}. However, our interest in having the theory
extended to operations with bound variables, such as the $\forall$
quantifier, together with the need to have our approach adapted for a
constructive meta-theory, bring forward aspects of this theory that are easy to
miss otherwise.

Systems of algebraic expressions are specified by {\em algebraic signatures}---pairs
consisting of a set $Op$, called the set of {\em operations}, and a function
$Ar:Op\sr \nat$, called {\em arity}.  Given a signature $Sig$ and a set $V$ such that
$V\cap Op=\emptyset$, one can define, for any $X\subset V$, the set $Exp(X)$ of
expressions relative to $Sig$ with (free) variables from $X$. Note that when we
write $Exp(X)$ we assume that the signature $Sig$ and the set $V$ have been
fixed.

There are many families of sets $Exp(X)$ whose elements may be called
expressions. For example, one can use a subset of the set of sequences (lists)
of elements of $Op\cup X$. Alternatively, one can use some axiomatization of
planar rooted trees with labels from $Op\cup X$ on the nodes. Translating from
a representation of the first kind into a representation of the second is done,
in the concrete world of computer programs, by programs called parsers, and there
is a beautiful mathematical theory behind it that many of us are robbed of the
joy of learning.

Let $U$ be a universe that contains $Op$, $V$, and $Exp(X)$ for all $X\subset V$.
Let $2^V$ denote the set of subsets of $V$,
let $Sets(2^V)$ be the category of sets whose set of objects is $2^V$, let
$Sets(U)$ be the category of sets whose set of objects is $U$, and let
$J_V:Sets(2^V)\sr Sets(U)$ be the inclusion functor.

We may consider $Exp$ as a function $2^V\sr U$. In the chosen representation of
expressions one can construct the {\em substitution} operation, which for any
$X,Y\subset V$ and for any $f:X\sr Exp(Y)$, defines a function $\mbind{f}:Exp(X)\sr
Exp(Y)$. In addition, for any $X\subset V$ one can define the function
$\eta_{X}:X\sr Exp(X)$. The triple $(Exp,\eta,\mbind{-})$ satisfies the
conditions of Definition \ref{2015.12.22.def1}, thereby making it into a $J_V$-relative
monad.

{\em This is how relative monads appear in the theory of expressions with variables.}

Next, following \cite{FPT}, we let $\FF$ denote the category with set of
objects $\nat$ and with set of morphisms
%
\begin{equation}
\llabel{2017.02.24.eq1}
Mor(\FF)=\cup_{m,n}Fun(stn(m),stn(n)),
\end{equation}%
%
where $stn(m)=\{i\in\nat\,|\,i<m\}$ is our choice for the standard set with $m$
elements, and where, for two sets $X$ and $Y$, $Fun(X,Y)$ is the set of functions
from $X$ to $Y$, defined as in \cite[p.~81]{Bourbaki.Sets}, so that each
function has a well defined domain and codomain. Then the union in
(\ref{2017.02.24.eq1}) is disjoint and
%
$$Mor_{\FF}(m,n)=Fun(stn(m),stn(n))$$
%
It is sometimes convenient to distinguish natural numbers used as objects of
$\FF$ from their other uses. For this purpose we will write $\ff{n}$ for $n$
used as an object of $\FF$.

Let $Jf:\FF\sr Sets(U)$ be the functor given by $\ff{n}\mapsto stn(n)$ on
objects and by inclusion of the sets of morphisms on morphisms.

Assume that $\nat\cap Op=\emptyset$. Then our previous construction applies to
$V=\nat$. Consider the functor $\Phi:\FF\sr Sets(2^{\nat})$ that takes $\ff{n}$
to $stn(n)$ and that is the inclusion of the sets of morphisms.

Relative monads on a functor $\C_1\sr \C_2$ can be precomposed with functors $\C_0\sr\C_1$; see Construction \ref{2017.02.24.constr1}. Precomposing the monad of expressions ${\bf Exp}^{\nat}$ with $\Phi$ and observing that $\Phi\circ J_{\nat}=Jf$, we obtain, for any algebraic signature $Sig$ such that $Op\cap \nat=\emptyset$, a $Jf$-relative monad, which we will denote by ${\bf Exp}_{Sig}$. 

{\em This is how $Jf$-relative monads appear in the theory of algebraic expressions.} 

Note that that up to this point our constructions have been completely elementary. 

Suppose now that we want to associate with the family of sets $Exp(X)$ not a
relative monad, but a monad. First we would need to extend the function
$Exp:2^V\sr U$ to a function $U\sr U$. There is no way of doing it in
{\em UniMath}, and I do not know of any way of doing it in any constructive
foundation. The best one could achieve is to construct a function $Exp':U\sr U$
and a family of isomorphisms $\phi_V:Exp(X)\sr Exp'(X)$ for $X\subset V$. This
requires developing a constructive theory of filtered colimits and functors
that commute with such colimits, and it is not an obvious task.

Alternatively, one can build a monad $Exp''$ corresponding to a signature
directly by constructing the set $Exp''(X)$ as an initial algebra over the
functor $F_{Sig,X}:Sets(U)\sr Sets(U)$ given on objects by the formula
%
$$F_{Sig,X}(A):=X\coprod(\coprod_{O\in Op}A^{Ar(O)}).$$
%
Constructing initial algebras for $F_{Sig,X}$ also requires the use of
colimits, but only $\omega$-colimits, that is, colimits of sequences, see,
e.g., \cite{Adamek1974}. The monad structure on the family of sets $Exp''(X)$
can be constructed from the initial algebra structures, see \cite{Barr1970} or
\cite[Th.3, p.~161]{MatthesUustalu}. One is then left with the task of
establishing a family of bijections between $Exp''(X)$ and $Exp(X)$ for
$X\subset V$ that are compatible with substitution, which can be done but
requires extra work.

In general, a monad on $Sets(U)$ is a richer object than a $Jf$-relative monad,
and there may be situations where a monad associated with a signature is
required as an intermediary between the syntax and an abstract mathematical
construction. However, in our case, when we want to construct from the syntax a
C-system, a $Jf$-relative monad is precisely what we need, so that even when we
have a monad at our disposal we have to restrict it to a $Jf$-relative monad
first in order to perform our construction.

{\em This is why we use $Jf$-relative monads and not the usual monads.}

Let us now explain another important point. At the start of our
explanation of how $Jf$-relative monads are related to expressions, we said
that we will consider {\em algebraic} expressions. However, the expressions
that appear in the sentences of type theories are often not algebraic, because
they contain operations that bind some of the variables in their
arguments. For example, the expression $\prod\,x:A,B$ that appears in
(\ref{2017.03.02.eq1}) can be rewritten as $\prod(A,x.B)$, which makes it
visible that it is the result of an operation $\prod$ applied to two arguments
$A$ and $B$, and that this operation binds one variable, here called $x$, in its
second argument.

{\em Expressions that contain operations that may bind variables in their
  arguments are called expressions with binders}.
 
Expressions with binders are specified by {\em binding signatures}% 
%### Fiore's *second-order signatures* is better, ask Marcelo for a reference to one of his papers?
---pairs consisting of a set of operations $Op$ and an arity function $Ar:Op\sr Fseq(\nat)$.
Here $Fseq(\nat)$ is the set of finite sequences of elements of
$\nat$. The set $\nat$ may be identified with a subset of $Fseq(\nat)$ through the
embedding taking $d$ to the sequence $(0,\dots,0)$ of length $d$. This defines
an inclusion of algebraic signatures into binding signatures. The earliest
mention of a concept equivalent to binding arity that we know of is in
\cite{Aczel1978}. The meaning of an operation $E$ with algebraic arity $d$
is that $E$ has $d$ arguments. The meaning of an operation $E$ with binding
arity $(i_1,\dots,i_d)$ is that $E$ has $d$ arguments and binds $i_k$ variables
in its $k$-th argument.

To apply an operation $Op$ with arity $(n_0,\dots,n_{d-1})$ to expressions
$E_0,\dots,E_{d-1}$ one has to specify, in addition to the expressions
themselves, $d$ sequences, of lengths $n_0,\dots,n_{d-1}$ respectively, of
names of variables. These sequences will show which of the variables are bound
in each argument.

The best known examples of operations with binders are the quantifiers
$\forall$ and $\exists$ of predicate logic and the $\lambda$-abstraction of the
(untyped) lambda calculus \cite{Church1932,Barendregt}. All three of
these operations have arity $(1)$, that is, they have one argument in which
they bind one variable.

To get an example with arity $(2)$ one may consider the operation that one gets by applying an operation of arity $(1)$ twice.

Consider expressions formed by operations with binders applied to
variables. For example, consider expressions generated by one operation of
arity $(1)$ that we will call $\lambda$. Every such expression is of the form
%
$$E=\lambda\,x_{n-1}.\lambda\,x_{n-2}.\dots.\lambda\,x_0.x$$
%
Here $x_{n-1},\dots,x_{0}$ are bound variables.  We do not assume that $x_i\ne x_j$
for $i\ne j$ or that $x_i\ne x$. In particular $x$ is a free variable if
$x_i\ne x$ for all $i\ge 0$ and is a bound variable otherwise. The usual, but hard to
formulate precisely, rules of $\alpha$-equivalence (see, e.g., \cite[Def. 2.1.11,
  p.~26]{Barendregt}) imply that if we rename the bound variables in any way
that preserves the rightmost occurrence of $x$ among the $x_i$'s, then the
resulting expression will be $\alpha$-equivalent to the original one. In
particular, we can always rename the variables $x_i$ so that $x_i\ne x_j$ for $i\ne j$ and
there is an most one $k$ such that $x_k=x$. If such a $k$ exists, then $E$ has
no free variables, and if it does not, then $E$ has one free variable, namely $x$.

If $x$ is a free variable, then we can substitute another expression $E'$ of the
same form for $x$, yielding an expression denoted $E[E'/x]$.  However, we can not do it directly. Instead we have to use
something called {\em capture avoiding substitution} to avoid the
``capture'' of variable names by binders. For example, let $E=\lambda\,x_0.x$,
where $x$ is free, and let $E'=x'$ be a variable.  Then we have two cases---if $x_0\ne x'$, then we
can directly substitute $E'$ for $x$, obtaining $E[E'/x]=\lambda\,x_0.x'$. If $x_0=x'$
we must first rename $x_0$ into $x_0'$, chosen so that $x_0'\ne x'$, and then
substitute, obtaining $E[E'/x]=\lambda\,x_0'.x'$. If we were to use direct
substitution, then the resulting operation would not respect 
$\alpha$-equivalence.  Capture avoiding substitution does.

One shows, and it should be clear from the above that it is not easy, that for
any binding signature $(Op,Ar)$ one can define, for expressions constructed
using operations of this signature and names of variables from a given set $V$,
which occurrences of variable names among the arguments of the operations are
free and which are bound. From this one can define, for any subset $X$ of $V$,
the set $Exp^{\cdot}(X)$ of expressions with free variables from $X$. Next one
can define the concept of $\alpha$-equivalence on each of the sets
$Exp^{\cdot}(X)$ and define the sets $Exp^{\alpha}(X)$ of $\alpha$-equivalence
classes of expressions with free variables from $X$. Most definitions of
$\alpha$-equivalence require $V$ to be a set with an additional operation that
for every finite subset of $V$ gives an element in the complement of this
subset. Let us call it a {\em freshness operation}. Some approaches to 
$\alpha$-equivalence and further constructions discussed below, notably the
approach through nominal sets \cite{Pitts}, may require only that for any
finite subset of $V$ there exist an element in the complement of this
subset. In the latter case we will say that $V$ has the freshness property. In
ZFC a set has the freshness property if and only if it is infinite. In
constructive meta-theories the situation may be more involved and it is
convenient to have a special name for this property.

If $V$ has the freshness property, then one can define, and again it is not at all
easy, simultaneous capture avoiding substitution of expressions 
$E_x\in Exp^{\cdot}(Y)$, $x\in X$, for the free variables of an expression 
$E' \in Exp^{\cdot}(X)$, in a way that is compatible with $\alpha$-equivalence.
After passage to $\alpha$-equivalence classes these constructions
become equivalent and one obtains, for any function $X\sr Exp^{\alpha}(Y)$ and for
any element of $Exp^{\alpha}(X)$, an element of $Exp^{\alpha}(Y)$. In addition
one has, for any $X\subset V$, a function $X\sr Exp^{\alpha}(X)$.

This brings us again to a structure of the same form as we obtained in the case
of algebraic operations---a $J_V$-relative monad, where $J_V$ is the obvious
functor from $Sets(2^V)$ to $Sets(U)$. Performing the same construction as the
one described above in the case of algebraic expressions, one obtains from a
$J_{\nat}$-relative monad, a $Jf$-relative monad ${\bf Exp}_{Sig}$. This is a
direct generalization of the construction that we described previously from
algebraic expressions to expressions with binders. The main idea behind this
generalization goes back to Fiore, Plotkin, and Turi \cite{FPT}, where structures
equivalent to $Jf$-relative monads are introduced under the name of
{\em abstract clones}.

{\em This is how $Jf$-relative monads appear in the theory of expressions with binders.}

Let us calculate what we get from this construction when the signature is given
by one operation $\lambda$ with arity $(1)$. The expressions then are the
expressions that we considered above. We have seen that
%
$$Exp^{\alpha}(\emptyset)=\{a_{n,k}\,|\,n\in\nat,k=0,\dots,n-1\},$$
%
where $a_{n,k}$ is (the equivalence class of) the expression with $n$
$\lambda$-abstractions such that $k$ is the smallest index satisfying $x_k=x$.

Next, we know that
%
$$Exp^{\alpha}(\{x\})=Exp^{\alpha}(\emptyset)\cup \{b_n(x)\,|\,n\in \nat\},$$
%
where $b_n(x)$ is the expression with $n$ $\lambda$-abstractions ending with
$x$ and such that $x_i\ne x$ for all $n-1\ge i\ge 0$. We have to add
$Exp^{\alpha}(\emptyset)$, because an expression without free variables is an
expression with free variables from the set $\{x\}$.

Finally, for a general $X\subset V$ we have
%
$$Exp^{\alpha}(X)=Exp^{\alpha}(\emptyset)\cup (\cup_{x\in X}\{b_n(x)\,|\,n\in \nat\}),$$
%
and the unions on the right hand side are disjoint. 

Capture avoiding substitution in the case of one free variable is of the form
%
$$b_n(x)[a_{n',k'}/x]=a_{n+n',k'}$$
$$b_n(x)[b_{n'}(x')/x]=b_{n+n'}(x').$$
%
For many free variables the substitution is determined by the case of one free
variable, because in any one expression there is at most one free variable.

It is easy to see that the $Jf$-monad that we obtain in this case is isomorphic
to the $Jf$-monad defined by the algebraic signature with operations $a_k$,
$k\in\nat$, and $b$, where the arity of $a_k$ is $0$ and the arity of $b$ is
$1$. The elements corresponding under this isomorphism to $a_{n,k}$ are
$b^n(a_k)$, and the elements corresponding to $b_n(x)$ are $b^n(x)$.

Church's famous $\lambda$-calculus starts with the system of abstract
expressions corresponding to two operations $ap$ and $\lambda$, with the arity
of $ap$ being $(0,0)$ and the arity of $\lambda$ being $(1)$.  The operation $ap$ is
called {\em application} and is usually denoted using infix notation with the
empty operation symbol, that is, $ap(E,E')$ is denoted by $E\,E'$.

I do not know of an algebraic representation similar to what we have described
above for free Church $\lambda$-expressions, that is, for the $Jf$-monad
corresponding to the binding signature
%
$$Sig_{\Lambda}=(\{ap,\lambda\}, Ar(ap)=(0,0), Ar(\lambda)=(1))$$
%
More generally, one may ask whether for any binding signature $Sig$ one may
construct an algebraic signature $Alg(Sig)$ and an isomorphism between the
$Jf$-relative monads corresponding to $Sig$ and $Alg(Sig)$, as we have done in
the case when $Sig=(\{\lambda\},Ar(\lambda)=(1))$.

To obtain the $\lambda$-calculus, or more specifically, the
$\lambda_{\eta\beta}$-calculus, one has to add to the system of expressions
defined by $Sig_{\Lambda}$ two relations that are called $\beta$-reduction and 
$\eta$-reduction. The fact that one still gets a $Jf$-monad structure after
passing to equivalence classes under the equivalence relation generated by
these ``reductions'' requires proof.

It appears that the $Jf$-monad corresponding to the
$\lambda_{\eta\beta}$-calculus has an algebraic presentation closely related to
the combinatory logic of SchÃ¶nfinkel \cite{Schonfinkel1924} (translated in
\cite{FtoG}) and Curry \cite{Curry1930}.  However, many subtle difficulties arise
in making it precise (cf.{} \cite{2002Selinger}), and we know of no theorem
asserting such a presentation in terms of relative monads or monads.

{\em This is how $Jf$-relative monads corresponding to binding signatures
  relate to the $Jf$-relative monads corresponding to algebraic signatures.}

What we said about the direct extension of ${\bf Exp}_{Sig}$ from a
$Jf$-relative monad to a monad immediately generalizes from the algebraic case
to the case of operations with binders.

One may also generalize the discussion above by using category theory directly
to construct the monad corresponding to a signature.  The beginnings
of this generalization can be see in \cite{FPT}. It is highly non-trivial.
Operations that bind variables change the set of free variables, e.g., for $x\in
X$, the operation $\lambda\,x$ can be seen as an operation from
$Exp(X\coprod\{x\})$ to $Exp(X)$. Because of this, the individual sets
$Exp^{\alpha}(X)$ do not have a universal characterization.  Instead, a universal
characterization can be given to a functor $Exp:Sets(U)\sr Sets(U)$, which will
be given a monad structure later.  This functor has an initial algebra structure
for $\uu{Id}+H_{Sig}$, where $H_{Sig}$ is a {\em functor of the second order}---%
a functor from functors to functors and $\uu{Id}$ is the functor of second
order that takes any $F$ to the identity functor of $Sets(U)$. The functor
$H_{Sig}$ can be directly constructed from the binding signature
$Sig$. Bindings correspond to the operation on functors $F\mapsto F'$, where
$F'(X)=F(X\coprod pt)$. The general theory of initial algebras for
$\omega$-cocontinuous functors from \cite{Adamek1974} is applicable here as
well, and an initial algebra $Exp''$ for $\uu{Id}+H_{Sig}$ can be constructed as
the colimit of the sequence of functors $(\uu{Id}+H_{Sig})^n(\uu{\emptyset})$,
where $\uu{\emptyset}$ is the functor $X\mapsto \emptyset$. Since the initial
algebras are unique up to a unique algebra isomorphism the sets $Exp''(X)$
constructed by the colimit construction are in a bijective correspondence with
the sets $Exp(X)$ of $\alpha$-equivalence classes of expressions. The set
$Exp''$ are closely related to the sets that one obtains when 
$\alpha$-equivalence classes are represented using de Bruijn levels or indexes. 
There is more
to tell here, but it is outside of the scope of the present
paper.

Next one needs to construct a monad structure on $Exp''$. The corresponding
theory is developed in \cite{MatthesUustalu}, \cite{AM2016}, and
\cite{AMM2016}. An outline of the theory that allows one to give a universal
characterization of the monad structure itself can be found in
\cite{HM2012}. Not all is understood yet, and it remains an active area of
research. Much of the work being done today is being simultaneously
formalized in {\em UniMath} \cite{}. The key question here is: what structure on $H$ has
to be specified in order to obtain a monad structure on the initial algebra of
$\uu{Id}+H$?  The main idea was introduced in \cite{MatthesUustalu}. In
\cite{AM2016} a functor with this structure is called an (abstract)
{\em signature}. As became understood later in \cite{AMM2016}, the additional
condition of $H$ being $\omega$-cocontinuous allows one to remove the condition
of the existence of the right adjoints from the main theorem \cite[Th. 15,
  p.~170]{MatthesUustalu}, leading to \cite[Th. 48]{AMM2016}.

The case that is most important for us, that of monads defined by
binding signatures, has been fully formalized in {\em UniMath}. There remains the
problem of showing that the families of sets of $J_V$-relative monads
corresponding to this monad are isomorphic to the sets of expressions modulo
$\alpha$-equivalence and that the monad structure that one obtains
satisfies the universality conditions of \cite{HM2012}.

\comment{As was envisioned in \cite{FPT}, the isomorphisms, for $X\subset V$,
  between the sets $Exp''(X)$ and the corresponding sets of expressions modulo
  $\alpha$-equivalence depend on the choice of the binary coproduct
  structure on $Sets(U)$. Choosing the usual inclusions of $X$ and $Y$ into
  $X\coprod Y$ as the structural ones leads to one set of isomorphisms while
  choosing the inclusions composed with the permutation of $X$ and $Y$ as the
  structural ones to another. The first set, for $X=stn(n)$, corresponds to the
  description of the $\alpha$-equivalence classes using De Bruijn {\em levels}
  (numbered from $0$) while the second one corresponds to the description using
  De Bruijn {\em indices} (also numbered from $0$). For the details see
  \cite{FPT} and \cite{deBruijn72}. It is quite beautiful how two approaches to
  choosing canonical representatives in the $\alpha$-equivalence classes, which
  have long been known and used in the practice of programming, correspond to
  two different choices of the binary coproduct structure on the category of
  sets!
%Two different structures actually lead to two different sets $Exp''(stn(n))$. Each of this sets comes with a filtration and the isomorphisms }
}

{\em The preceding discussion shows how monads corresponding to binding
  signatures can be constructed by methods of category theory.}

The raw syntax of a type theory can be specified by a binding
signature\footnote{The type theories whose syntax can be specified by an
  algebraic signature correspond to the ``generalized algebraic theories'' of
  John Cartmell \cite{Cartmell1,Cartmell0,Garner}.}.  For
example, the raw syntax of Streicher's formulation of the Calculus of
Constructions of G. Huet and T. Coquand (CC-S), when brought into standard
form, consists of six operations $\prod$, $Prop$, $Proof$, $\lambda$, $app$, and
$\forall$, with the corresponding arities $(0,1)$, $()$, $(0)$, $(0,1)$,
$(0,1,0,0)$, and $(0,1)$; see \cite[p.~157]{Streicher}.

In view of the preceding discussion, this suggests that the class of abstract
mathematical objects that can be used to most directly model the raw syntax of
type theories is the class of $Jf$-relative monads. However, in this paper we
use pairs consisting of a $Jf$-relative monad $\RR$ and a left module $\LM$ (see
Definition \ref{2017.03.16.def1}) over this monad. Let us explain why we need
such pairs and how one can generate them from data similar to binding
signatures.

To obtain the binding signature of the raw syntax from the usual presentation
of a type theory by a list of inference rules, such as (\ref{2017.03.02.eq1}),
one should make the list of operations that these inference rules introduce
with their names and their binding arities. Often operations will be given in a
non-standard form, such as $\prod\,x:A,B$, instead of $\prod(A,x.B)$, but for
unambiguous inference rules it should be easy to see what the corresponding
standard form should be.

Among those operations will be operations that introduce {\em types} and
operations that introduce {\em elements} (also called {\em objects}) of types.

For example, in the type theory CC-S the operations $\prod$, $Prop$ and $Proof$
introduce types while operations $\lambda$, $app$ and $\forall$ introduce
elements.  In addition, some arguments of each operation must be types and some
elements. However, {\em only element variables can be bound}.

Define a {\em restricted 2-sorted binding signature} to be a signature where the arities of the
operations are given by sequences
$((n_0,\epsilon_0),\dots,(n_{d-1},\epsilon_{d-1}),\epsilon)$, where
$\epsilon\in\{0,1\}$ with $0$ corresponding to elements and $1$ to types. Such
two sorted arities of the six operations of CC-S are, correspondingly,
$((0,1),(1,1),1)$, $(1)$, $((0,0),1)$, $((0,1),(1,0),0)$,
$((0,1),(1,1),(0,0),(0,0),0)$ and $((0,1),(1,0),0)$.

From any restricted 2-sorted binding signature one may construct a 1-sorted binding signature,
where the set of operations is the same, and the arity function is the
composition of the original arity function with the function that maps
$((n_0,\epsilon_0),\dots,(n_{d-1},\epsilon_{d-1}),\epsilon)$ to
$(n_0,\dots,n_d)$.

Let $Sig_2$ be a (restricted) 2-sorted binding signature and $Sig_1$ the
corresponding 1-sorted one. Let $Z$ be a set such that the set of expressions
with respect to $Sig_1$ with variables from $Z$ is defined. Let us fix two
subsets $V,Y\subset Z$ such that $V\cap Y=\emptyset$. Consider the subset
$Exp_{Sig_2}[V,Y]$ of expressions that conform to the additional rules defined
by the sequences $(\epsilon_0,\dots,\epsilon_{n-1},\epsilon)$ of the 2-sorted
arities of the operations of $Sig_2$ under the assumption that a variable can
be used as an element variable if and only if it is in $V$ and as a type
variable if and only if it is in $Y$. This subset will be the disjoint union of
two smaller subsets $ElExp_{Sig_2}[V,Y]$ and $TyExp_{Sig_2}[V,Y]$, where the
first one consists of expressions of sort ``element'', and the second one of
expressions of sort ``type''.

Next, for a subset $X$ of $V$ let $Exp^{\cdot}_{Sig_2}(X,Y)$ be the subset of
$Exp_{Sig_2}[V,Y]$ that consists of expressions where an element variable is
free if and only if it belongs to $X$ with a similar notation for $ElExp$ and
$TyExp$. Let us assume in addition that $V$ has the freshness property. Then
one can define the $\alpha$-equivalence relation on $Exp^{\cdot}_{Sig_2}[V,Y]$
and therefore on $ElExp^{\cdot}_{Sig_2}(X,Y)$ and
$TyExp^{\cdot}_{Sig_2}(X,Y)$. Let $ElExp^{\alpha}_{Sig_2}(X,Y)$ and
$TyExp_{Sig_2}^{\alpha}(X,Y)$ be the corresponding sets of equivalence classes.

Let us fix a set $PrTy\subset Z$ such that $V\cap PrTy=\emptyset$. This set
will eventually play the role of the set of primitive types that we add to the
base type theory. Consider $X$ as a variable, writing $RR_V(X)$ and $LM_V(X)$
instead of $ElExp^{\alpha}_{Sig_2}(X,PrTy)$ and
$TyExp_{Sig_2}^{\alpha}(X,PrTy)$.

The structures that we get on the families of sets $RR_V(-)$ and $LM_V(-)$ are
slightly different. On $RR$ we get a $J_V$-relative monad structure---for any
$X\subset V$ we have a function $\eta_X:X\sr RR_V(X)$, and for any $X,Y\subset V$
and for any function $f:X\sr RR_V(Y)$ we have a function
%
$$rr_{X,Y}(f):RR_V(X)\sr RR_V(Y)$$
%
On the other hand, on the $LM_V$ we do not have $\eta_X$ since variables from
$X$ are not type expressions, and substitution defines for any $X,Y\subset V$
and for any function $f:X\sr RR_V(Y)$, a function
%
$$lm_{X,Y}(f):LM_V(X)\sr LM_V(Y)$$
%
This operation makes the family of sets $LM_V(X)$ into a left module
$\LM_V:=(LM_V, lm)$ over the $J_V$-monad $\RR_V=(RR_V,\eta,rr)$.

Precomposing $\RR_{\nat}$ and $\LM_{\nat}$ with the obvious functor
$\Phi:\FF\sr Sets(2^{\nat})$ using Constructions \ref{2017.02.24.constr1} and
\ref{2017.03.12.constr1} we obtain a pair $(\RR,\LM)$ consisting of a $J_f$-relative monad
and a left module over it.

In some type theories all types are elements of universes, and, moreover, element
expressions are not syntactically distinguishable from type expressions. For
example, it is the case in the very important type theory MLTT79---the
Martin-L\"{o}f type theory from \cite{MLTT79}. The inference rules related to
the universes \cite[p.~172]{MLTT79} make all type expressions also element
expressions, and an element expression of any form may be used as a type. In our
notation it means that $LM(X)=RR(X)$.

{\em The preceding discussion shows how pairs consisting of a $Jf$-relative monad $\RR$
  and a left module $\LM$ over it correspond to the raw syntax of type theories,
  because some expressions are type expressions and some are element
  expressions.}

To construct the pair $(\RR,\LM)$ by methods of category theory without a
reference to expressions one can proceed as follows.

A restricted 2-sorted binding signature defines a monad on the category
$Sets(U)\times Sets(U)$. See \cite{Zsido} for the much more general case of multi
sorted signatures. For the formalization of this construction in {\em UniMath} see
\cite{AMM2017}.
%### Check with B. whether what is being formalized is what is described in \cite{Zsido}.

Choosing an object $PrTy$ of $Sets(U)$ and applying Construction
\ref{2017.04.23.constr1} we obtain a monad on $Sets(U)$. Let us denote it by
$\RR^*$. Applying Construction \ref{2017.04.23.constr3} we obtain a module
$\LM^*$ over this monad with values in $Sets(U)$.  Precomposing with the
functor $Jf:\FF\sr Sets(U)$ using Constructions \ref{2017.02.24.constr1} and
\ref{2017.03.12.constr1} one obtains a pair $(\RR,\LM)$ consisting of a $Jf$-monad and a
module over it.

{\em This is how the pairs $(\RR,\LM)$ can be obtained from a restricted
  2-sorted binding signature by methods of category theory.}

To make it easier to compare the constructions that follow with the earlier
constructions let us recall that when $\RR$ and $\LM$ are obtained as sets
of $\alpha$-equivalence classes of expressions as described above, then the
substitution structure on elements of $RR(\ff{n})$ and $LM(\ff{n})$ can be
easily expressed in terms of the structures of the relative monad and a module
over it.  Namely, if $E_1,\dots,E_k\in RR(\ff{m})$, 
$E\in RR(\ff{n})$ and $0\le i_1,\dots,i_k\le n-1$, then 
$E[E_1/i_1,\dots,E_k/i_k]\in RR(\ff{m})$ is the element $rr(f)(E)$, where $f:stn(n)\sr RR(\ff{m})$ is given
by $f(i)=\eta{i}$ for $i\ne i_1,\dots,i_k$ and $f(i_j)=E_j$. Exactly the same
formula with the replacement of $RR(n)$ by $LM(n)$ describes
$T[E_1/i_1,\dots,E_k/i_k]$ for $T\in LM(n)$.

This completes a large section of our introduction. We can now view the
$\alpha$-equivalence classes of the type expressions and the element expressions with given
sets of free variables as mathematical objects.

Let us return to the sentences of type theory, which are of the five kinds
(\ref{2017.02.06.eq1})-(\ref{2017.02.06.eq5}) listed above.  The expressions in the sentences
are considered modulo $\alpha$-equivalence. Moreover, the sentences
themselves are also considered modulo $\alpha$-equivalence, that is, modulo
the renaming of the variables $x_0,\dots,x_{n-1}$ introduced by the
context. Using this $\alpha$-equivalence we may assume that
$(x_0,\dots,x_{n-1})=(0,\dots,n-1)$. Then $T_i$ has free variables from
$stn(i)$ and $T,T',t$ and $t'$ free variables from $stn(n)$. When we are given
all the necessary additional information for the construction of the pair
$(\RR,\LM)$, where $RR(n)$ and $LM(n)$ are the $\alpha$-equivalence classes of
type and element expressions with free variables from the sets $stn(n)$, then we
obtain the following description of the sets of all possible sentences of the
five main kinds.
%
\begin{enumerate}
\item a sentence of the form (\ref{2017.02.06.eq1}) is an element of
%
$$B(\RR,\LM)=\coprod_{n\ge 0} \prod_{i=0}^{n-1}LM(\ff{i})$$
%
\item a sentence of the form (\ref{2017.02.06.eq2}) is an element of
%
$$Bt(\RR,\LM)=(\coprod_{n\ge 0} \prod_{i=0}^{n-1}LM(\ff{i}))\times LM(\ff{n})$$
%
\item a sentence of the form (\ref{2017.02.06.eq3}) is an element of
%
$$\wt{B}(\RR,\LM)=(\coprod_{n\ge 0} \prod_{i=0}^{n-1}LM(\ff{i}))\times RR(\ff{n})\times LM(\ff{n})$$
%
\item a sentence of the form (\ref{2017.02.06.eq4}) is an element of
%
$$Beq(\RR,\LM)=(\coprod_{n\ge 0} \prod_{i=0}^{n-1}LM(\ff{i}))\times LM(\ff{n})\times LM(\ff{n})$$
%
\item a sentence of the form (\ref{2017.02.06.eq5}) is an element of
%
$$\wt{Beq}(\RR,\LM)=(\coprod_{n\ge 0} \prod_{i=0}^{n-1}LM(\ff{i}))\times RR(\ff{n})\times RR(\ff{n})\times LM(\ff{n})$$
%
\end{enumerate}
%
In any approach to Martin-L\"of type theory a sentence of the form
$0:T_0,\dots,n-1:T_{n-1}\rh T\type$ is equivalent to the sentence $0:T_0,\dots,
n-1:T_{n-1},n:T\rh ok$. This allows one not to consider sentences of the form
(\ref{2017.02.06.eq2}).

This description of sentences immediately generalizes from the pairs
$(\RR,\LM)$ corresponding to the $\alpha$-equivalence classes of expressions to
all pairs $(\RR,\LM)$, where $\RR$ is a $Jf$-relative monad and $\LM$ a left
module over $\RR$.

%### Explain that we can now define subsets in ... of the derivable sentences as the smallest subsets closed under the operations defined by the inference rules. First, that we can interpret the inference rules as systems of operations on the sets of raw sentences, that is, sets ... . 

Next, we need to construct a C-system $CC$ from $(\RR,\LM)$, $B$, $\wt{B}$, $Beq$, and
$\wt{Beq}$.  This construction should be compatible with the
constructions outlined in earlier papers, such as the construction of the
category with families outlined in \cite{Hofmann}. In particular, the set of
objects of $CC$ should be defined together with an isomorphism with the quotient
set $B/{\sim}$ of the set $B$ by the equivalence relation defined by the set
$Beq$, according to the rule that $(T_0,\dots,T_{n-1})$ is equivalent to
$(T'_0,\dots,T'_{n'-1})$ if and only if $n'=n$ and the sequences defined by the
table (\ref{2017.04.07.eq1}) are in $Beq$.

Hofmann and some other authors suggest to directly construct the set of
morphisms and all the required structures using the subsets $\wt{B}$ and
$\wt{Beq}$. Already the first step, the definition from $\wt{B}$ of a set, which
will later have to be factorized by an equivalence relation coming from
$\wt{Beq}$ to produce the set of morphisms, is non-trivial, cf.{} \cite[Def. 2.11,
  p.~97]{Hofmann}. Constructing the composition and proving its properties, such
as associativity, present additional difficulties.

We proceed in a different manner. Instead of starting with $B/{\sim}$ and
building the C-system structure on it, we will construct a C-system
$C(\RR,\LM)$ that knows nothing about the subsets
$B$, $\wt{B}$, $Beq$, $\wt{Beq}$, and then we use the results of \cite{Csubsystems}
to show how any quadruple of subsets $B$, $\wt{B}$, $Beq$, $\wt{Beq}$ satisfying
certain properties defines a sub-quotient C-system of $C(\RR,\LM)$. This
sub-quotient will be the term model C-system of our type theory.

The conditions on the $B$-subsets will be seen to include many
which have been long known as the ``structural properties'', which the valid
sentences of all type theories must satisfy. By approaching them from the
direction of \cite{Csubsystems} we will see why these conditions are
necessary and sufficient for a type theory to ``make sense''.

The main property of a sentence is its validity. Validity of sentences is
determined on the basis of the inference rules.

The validity of a sentence of the form $0:T_0\rh ok$ asserts that $T_0$, which
must be a closed expression according to the rules stated above, is a valid
expression that describes {\em a type} in the system. For example, in any of
the Martin-L\"{o}f type theories, there is a type $\nat$, which is called the
{\em type of natural numbers}. The formal equivalent of this assertion is that $\nat$
is an expression and the sentence $0:\nat\rh ok$ is valid.

One often uses the words ``type'', ``type expression'' and ``expression that
describes a type'' interchangeably. The same applies to ``element'', ``element
expression'' and ``expression that describes an element''.\footnote{Note from
  editor: I'm considering inserting a warning about this.}

A sentence of the form $0:T_0,1:T\rh ok$ asserts that $T_0$ is a valid closed
type expression, and that $T$ is an expression with the only possible free variable
being $0$, thereby describing {\em a family of types} parametrized by $T_0$. For
example, in any of the Martin-L\"{o}f type theories, given a type $T$ and two
elements $t,t':T$ of $T$, there is a type $Id\,T\,t\,t'$ whose elements are to
be thought of as constructions of equalities between $t$ and $t'$ in
$T$. Correspondingly, the sentence $0:T, 1:Id\,T\,0\,0\rh ok$ is valid if and
only if the sentence $0:T\rh ok$ is.

Sentences of the form (\ref{2017.02.06.eq2}) with $n>1$ describe ``iterated
type families''. For example, for $n=2$, $T_0$ is a type, $T_1$ is a type
family parametrized by $T_0$ and $T_2$, which is an expression that may contain
$x_0$ and $x_1$ as free variables, is a type family with two parameters
$x_0:T_0$ and $x_1:T_1(x_0)$.

Let $\Gamma=(x_0:T_0,\dots,x_{n-1}:T_{n-1})$. If the sentence
(\ref{2017.02.06.eq3}) is valid then so is the sentence $\Gamma\rh T\type$.\footnote{From the editor: why is this true?}  A
sentence (\ref{2017.02.06.eq3}) with $n=0$, that is a sentence of the form $\rh
t:T$, asserts that $T$ is a valid (closed) type expression and $t$ is a valid
(closed) expression that describes an element of type $T$. For example, the
element $0$ of $\nat$ in the Martin-L\"{o}f type theories is denoted by $O$ so
that the sentence $\rh O:\nat$ is valid in all these theories. A sentence of
the form (\ref{2017.02.06.eq3}) with $n=1$ describes a family $T$ of types
parametrized by $T_0$ together with a ``section'' of this family, that is, a
family of elements $t(x_0)$ of types $T(x_0)$ for all $x_0$. If $T$ does not
contain $x_0$, then the family of types is constant and the sentence
(\ref{2017.02.06.eq3}) is a syntactic representation of a function from $T_0$
to $T$.

If the sentence (\ref{2017.02.06.eq4}) is valid than so are the sentences
$\Gamma\rh T\type$ and $\Gamma\rh T'\type$.\footnote{From the editor: why is this true?}  The validity of
(\ref{2017.02.06.eq4}) asserts that the type expressions $T$ and $T'$ are {\em
  definitionally equal} in the context $\Gamma$.  The analogous meaning is
assigned to sentences of the form (\ref{2017.02.06.eq5}).
%### want to say about "substitutional", but can not without a previous discussion of capture avoiding substitution...

Definitional equality of type expressions can be used to define definitional
equality of contexts. Namely, one defines two contexts
$\Gamma = (x_0:T_0,\dots,x_{n-1}:T_{n-1})$ and $\Gamma' = (x_0:T'_0,\dots,x_{n-1}:T'_{n-1})$ to be
{\em definitionally equal} if the sentences in the following sequence are valid
%
\begin{flalign}\llabel{2017.04.07.eq1}
\rh &\,\, T_0\equiv T_0'\\
x_0:T_0\rh &\,\, T_1\equiv T_1'\\
\dots\\
x_0:T_0,\dots,x_{n-2}:T_{n-2}\rh &\,\, T_{n-1}\equiv T_{n-1}'
\end{flalign}
%
We will use the notation $\Gamma \equiv \Gamma'$ to denote this condition.

This provides us with the concept of definitional equality of sentences of the
form (\ref{2017.02.06.eq1}). Two such sentences are called {\em definitionally equal}
if their contexts are.

Two sentences of the form (\ref{2017.02.06.eq2}) $\Gamma\rh T\type$ and
$\Gamma'\rh T'\type$ are {\em definitionally equal} if $\Gamma\equiv \Gamma'$ and
$\Gamma\rh T\equiv T'$.

Similarly, one can use definitional equality of type expressions and
definitional equality of element expressions defined by sentences of the form
(\ref{2017.02.06.eq4}) and (\ref{2017.02.06.eq5}) to define definitional
equality of sentences of the form (\ref{2017.02.06.eq3}). Two such sentences
$\Gamma\rh t:T$ and $\Gamma'\rh t':T'$ are called {\em definitionally equal} if
$\Gamma\equiv \Gamma'$ and the following two sentences are valid:
%
\begin{flalign*}
\Gamma\rh &\,\, T\equiv T'\\
\Gamma\rh &\,\, t\equiv t':T
\end{flalign*}
%
It should be immediately clear from the asymmetry of these rules that in order
for the definitional equality relations on sentences of the form
(\ref{2017.02.06.eq1}), (\ref{2017.02.06.eq2}), and (\ref{2017.02.06.eq3}) to be
equivalence relations the sets of sentences of various kinds should satisfy
more conditions than the ones that we have mentioned so far. These conditions
are among the conditions whose mathematical meaning is established in
this paper.

If we write $x\notin \Gamma$ for the condition that $x$ is the name of a free
variable not contained in the set of names declared in $\Gamma$, then this
assertion\footnote{From the editor: what assertion?} can be expressed in the form of a pair of inference rules:\footnote{From the editor: this paragraph seems to have been marked ``incomplete'' by the author.}
%
$$
\frac{\Gamma\rh T\type \spc x\notin\Gamma\spc}{\Gamma, x:T\rh ok}
\spc\spc\spc
\frac{\Gamma, x:T\rh ok}{\Gamma\rh T\type}
$$
%


@@@
the form of a list of ``inference rules'' that may look like, for example, this one:
%
\begin{equation}
\llabel{2017.03.02.eq1}
\frac{\Gamma,x:A\vdash B\,type}{\Gamma\vdash \prod\,x:A,B\,type}
\end{equation}%
%
These inference rules are formulated in@@@


To speak about the mathematical meaning of the conditions that the valid sentences should satisfy, we need to find a way to view the structure formed by the five kinds of sentences as a mathematical object and to describe and analyze a construction that generates a C-system from such an object.

...  that were specified through their raw syntax and typing algorithms or,
extensionally speaking, the subsets of well-typed context-judgment pairs.
%###

%@@@

For $p:X\sr Y$ in a category, let $sec(p)=\{s:Y\sr X\,|\,s\circ p=Id_X\}$. 
Elements of $sec(p)$ are called {\em sections} of $p$. To any C-system
$CC$ one associates a pair of sets $(Ob(CC),\wt{Ob}(CC))$, where $Ob(CC)$ is the
set of objects of the category underlying $CC$, and where
%
\begin{equation}
\llabel{2017.02.04.eq1}
\wt{Ob}(CC):=\{s\in Mor(CC)\,|\,s\in sec(p_{codom(s)}), l(codom(s))>0\},
\end{equation}%
%
i.e., where $\wt{Ob}(CC)$ is the set of sections of the non-trivial
p-morphisms of $CC$. When $CC$ is clear from the context we will abbreviate
$Ob(CC)$ and $\wt{Ob}(CC)$ to $Ob$ and $\wt{Ob}$ respectively.

The sets $(Ob,\wt{Ob})$ are equipped with a system of operations
$(l,ft,\partial,T,S,\wt{T},\wt{S},\delta)$. Pairs of sets equipped with
operations of such form are called (unital) pre-B-systems
(cf.{} \cite{Bsystemsnew}). The first main result of \cite{Csubsystems},
Proposition 4.2, shows how to construct from a sub-pre-B-system $(B,\wt{B})$ of
$(Ob,\wt{Ob})$ a sub-C-system of $CC$ whose associated pre-B-system is
$(B,\wt{B})$. The second main result of that paper, Proposition 5.4, shows how
to construct, from a pair of equivalence relations $(\sim,\approx)$ on $Ob$ and
$\wt{Ob}$ respectively that satisfies certain conditions, a quotient C-system
of $CC$ whose associated pre-B-system is $(Ob/{\sim},\wt{Ob}/\approx)$. These
conditions are shown in Proposition \ref{} of the present paper to be
compatible with isomorphisms of pre-B-systems.

After defining $C(\RR,\LM)$ in Sections \ref{} and \ref{}
%### a little more words, functoriality
we define, in Construction \ref{}, a pre-B-system structure on the sets
$(B(\RR,\LM),\wt{B}(\RR,\LM))$ and, in Constrcution \ref{}, an isomorphism
between this pre-B-system and the pre-B-system of $C(\RR,\LM)$.

Using this isomorphism we formulate the conditions on subsets $B\subset
B(\RR,\LM)$ and $\wt{B}\in \wt{B}(\RR,\LM)$ that are necessary and sufficient
for such a pair to correspond to a sub-C-system of $C(\RR,\LM)$.

Next, we construct, for any subsets $B$, $\wt{B}$, $Beq$, and $\wt{Beq}$, a pair
of relations $\sim$ and $\approx$ on $B$ and $\wt{B}$ respectively, and we show
under what condition on $Beq$ and $\wt{Beq}$ the transport of these relations to
the subsets of $(Ob(C(\RR,\LM))$ and $\wt{Ob}(C(\RR,LM)))$ corresponding to $B$ and
$\wt{B}$ satisfy the conditions of \cite[Prop. 5.4]{Csubsystems}, and therefore
define a (regular) quotient of the C-system corresponding to $(B,\wt{B})$.

Summing it up in Construction \ref{} we obtain a construction, for any four
subsets $B$, $\wt{B}$, $Beq$, $\wt{Beq}$ satisfying certain conditions, of a
C-system. This is the final construction of the paper.

It should be possible to approach this construction in a more direct
way. First, one would define the concept of a B-system as a pre-B-system whose
operations satisfy some axioms. Next one would show that for a C-system $CC$
the pre-B-system $(Ob(CC),\wt{Ob}(CC))$ is a B-system and that the mapping
%
$$CC\mapsto (Ob(CC),\wt{Ob}(CC))$$
%
is the object component of a functor from the category of C-systems to the
category of B-systems with obviously defined homomorphisms as morphisms. Next,
one would construct, using in particular an abstract analog of
\cite[Def. 2.11]{Hofmann}, a functor in the opposite direction, from B-systems
to C-systems. Finally, one would construct two functor isomorphisms extending
this pair of functors to an equivalence between the categories of C-systems and
B-systems.

Then one would prove that for any $\RR$, $\LM$ the pre-B-system structure that
we define on $(B(\RR,\LM),\wt{B}(\RR,\LM))$ is a B-system structure. A
sub-pre-B-system of a B-system is a B-system. Therefore the subsets
$(B,\wt{B})$ should define a B-system and the relations $(\sim,\approx)$
constructed from the subsets $(Beq,\wt{Beq})$ should be a congruence relation
such that the quotients $(B/{\sim},\wt{B}/\approx)$ again carry a structure of a
B-system. Finally, applying the inverse functor to this B-system we would
obtain a C-system that will be the C-system corresponding to the quadruple of
sets $B$,$\wt{B}$,$Beq$ and $\wt{Beq}$.

Such a direct construction would probably be more satisfying than the one that
we provide. However, it would require a lot of non-trivial work, and, as far as
the goal of constructing a C-system from the subsets $B$, $\wt{B}$, $Beq$, and
$\wt{Beq}$ is concerned, it will give the same result as our less direct, but simpler,
approach. Still, defining B-systems and constructing an equivalence between the
categories of C-systems and B-systems is important, and we plan to address it in
future papers. The approach that we take here, using the results of
\cite{Csubsystems} instead, gives us a rigorous construction that can be
completed today.

To\footnote{From the editor: author's instruction just before this paragraph:
  ``ignore the rest of the introduction''.  I didn't know what to make of this,
  so I left the rest of the introduction in.}
construct the regular sub-quotient of $C(\RR,\LM)$ that corresponds to the
type system generated by the given system of inference rules one uses the main
results, Propositions 4.3 and 5.4, of \cite{Csubsystems}. To use these
propositions to obtain a sub-quotient of a C-system $CC$ one should provide a
pair of subsets $B\subset Ob(CC)$, $\wt{B}\subset \wt{Ob}(CC)$ that is closed
under operations $(pt,ft,\partial,\wt{T},\wt{S},\delta)$ that are defined on
the pair of sets $(Ob(CC),\wt{Ob}(CC))$ associated with any C-system
\cite[Prop. 4.3]{Csubsystems} and a pair of equivalence relations on
$(B,\wt{B})$ that satisfy the conditions of \cite[Prop. 5.4]{Csubsystems}. The
most important conditions of \cite[Prop. 5.4]{Csubsystems} are connected to the
behavior of the equivalence relations under the restriction of the operations
$(pt,ft,\partial,\wt{T},\wt{S},\delta)$ to $(B,\wt{B})$.

We defer the detailed descriptions both of the step preceding the one described
here and of the one following it to future papers. In the remaining part of the
introduction we describe the content of the paper without further references to
type theory.

We start the paper with two sections where we introduce some constructions
applicable to general C-systems.

On the sets of objects of any C-system one can consider the partial ordering
defined by the condition that $X\le Y$ if and only if $l(X)\le l(Y)$ and
$X=ft^{l(Y)-l(X)}(Y)$. In the first section we re-introduce some of the objects
and constructions defined in \cite{Csubsystems} using the length function using
this partial ordering instead. This allows to avoid the use of natural numbers
in some of the arguments that significantly simplifies the proofs.

In the second section we construct for any C-system $CC$ and a presheaf $F$ on
the category underlying $CC$ a new C-system $CC[F]$ that we call the
{\em $F$-extension of $CC$}. The C-systems of this form are reminiscent of affine
spaces over schemes in algebraic geometry. While the geometry of affine spaces
in itself is not very interesting their sub-spaces encompass all affine
algebraic varieties of finite type . Similarly, while the C-systems $CC[F]$
look to be not very different from $CC$ their sub-systems and more generally
regular sub-quotients, even in the case of the simplest C-systems $CC=C(\RR)$
corresponding to Lawvere theories (see Section \ref{CRR}), include all of the
term C-systems of type theories.

Regular sub-quotients of any C-system $CC$ are classified by quadruples
$(B,\wt{B}, \sim,\simeq)$ of the following form.

Let $\wt{Ob}(CC)$ be the set of sections of the p-morphisms of $CC$, i.e., the
subset in $Mor(CC)$ that consists of morphisms $s$ such that
$dom(s)=ft(codom(f))$ and $s\circ p_{codom(f)}=Id_{dom(f)}$.  The sets $Ob(CC)$
and $\wt{Ob}(CC)$ are called the {\em B-sets} of a C-system, and they can also be denoted
as $B(CC)$ and $\wt{B}(CC)$.

The first two components $B$ and $\wt{B}$ of the quadruple are subsets in the
sets $Ob(CC)$ and $\wt{Ob}(CC)$ respectively. The next two components are
equivalence relations on $B$ and $\wt{B}$. To correspond to a regular
sub-quotient the pair $(B,\wt{B})$ should be closed under the eight B-system
operations on $(B(CC),\wt{B}(CC))$ and the equivalence relations of the pair
$(\sim,\simeq)$ should be compatible with the restrictions of these eight
operations to $(B,\wt{B})$ as well as to satisfy three additional simple
conditions (see \cite[Proposition 5.4]{Csubsystems}) that involve the length
function $l:B\sr\nat$ on $B$.

Therefore, in order to be able to describe regular sub-quotients of a C-system
one needs to know the B-sets of this C-system, the length function and the
action of the eight B-system operations on these sets. Such a collection of
data is called a {\em pre-B-system} (see \cite{Bsystems}). The main result of this
paper is a detailed description of the pre-B-systems of the form
$(B(CC[F]),\wt{B}(CC[F]))$ for an important class of ``coefficient''
C-systems $CC$ (see below).

In Section \ref{Jfrel} we first recall the notion of relative monad on a
functor $J:C\sr D$ that was introduced in \cite[Def.1, p.~299]{ACU} and
considered in more detail in \cite{ACU2}. Then we focus our attention on
relative monads over the functor $Jf$ that is defined as follows.

For two sets $X$ and $Y$ let $Fun(X,Y)$ be the set of functions from $X$ to
$Y$.  Let $stn(n)$ be the standard set with $n$ elements that we take to be the
subset of $\nat$ that consists of numbers $<n$. Consider the category $F$ such
that $Ob(F)=\nn$ and
%
$$Mor(F)=\cup_{m,n}Fun(stn(m),stn(n))$$
%
The functor $Jf$ is the obvious functor from $F$ to the category of sets. 

In \cite{LandJf} we constructed an equivalence between the category of
$Jf$-relative monads and the category of Lawvere theories whose component
functor from the relative monads to Lawvere theories is denoted $RML$. A key
component of this equivalence is the construction of the Kleisli category
$K(\RR)$ of a relative monad $\RR$ given in \cite{ACU2}.  Most of Section
\ref{Jfrel} is occupied by simple computations in $K(\RR)$ for $Jf$-relative
monads $\RR$.

In \cite{LandC} we constructed an isomorphism between the category of Lawvere
theories and the category of l-bijective C-systems---the C-systems $CC$ where
the length function $Ob(CC)\sr \nat$ is a bijection. In Section \ref{CRR} we
consider the C-system $C(\RR)$ corresponding to the Lawvere theory $RML(\RR)$
defined by a $Jf$-relative monad $\RR$. The underlying category of this
C-system is $K(\RR)^{op}$. The main result of this section is the description
of the B-sets of $C(RR)$ and of the actions of the B-system operations on these
sets.

In the final Section \ref{CRRLM} we apply the construction of Section
\ref{Fext} to $C(\RR)$ taking into account that the functors
$\LM:C(\RR)^{op}\sr Sets$ are the same as the functors $K(\RR)\sr Sets$ that
are the same as the relative (left) modules over $Jf$. In
(\ref{2016.01.21.eq3}) and Construction \ref{2015.08.22.constr1} we compute the
B-sets $B(C(\RR,\LM))$ and $\wt{B}(C(\RR,\LM))$ and in Theorem
\ref{2015.08.26.th2} the action of the B-system operations on these sets.

In the next paper we will connect these computations to the conditions that the
valid judgments of a type theory must satisfy in order for the term C-system
of this type theory to be defined.

\vspace{5mm}

We use neither the axiom of excluded middle nor the axiom of choice. The paper
is written in a formalization-ready style and should be easily formalizable
both in {\em UniMath} and in ZFC.

\vspace{5mm}

We use the diagrammatic order of composition, i.e., for morphisms $f:X\sr Y$
and $g:Y\sr Z$ we write their composition as $f\circ g$.

A category $\C$ is always understood as a pair of sets $Ob(\C)$, $Mor(\C)$
connected by the operations of domain, codomain, identity and composition where
composition is a partially defined operation. A functor $F:\C\sr \D$ is a pair
of functions $F_{Ob}:Ob(\C)\sr Ob(\D)$, $F_{Mor}:Mor(\C)\sr Mor(\D)$ satisfying
the well known conditions. We emphasize it here, because it is also possible to
define a category starting with a set $Ob(\C)$ and a {\em family} of sets
$Mor_{\C}(X,Y)$ parametrized by $X,Y\in Ob(\C)$, where a {family} is understood
in the sense of \cite[Remark 3.9]{fromunivwithPiI}. These two concepts are a
little different from each other. For example there exists a category with
$Ob(\C)=\{0,1\}$ and $Mor_{\C}(a,b)=\{0\}$ for all $a,b\in Ob(\C)$, in the
sense of the second definition, but not in the sense of the first. Indeed, any
category in the sense of the first definition has the property that
%
$$Mor(X,Y)\cap Mor(X',Y')=\emptyset$$
%
if $X\ne X'$ or $Y\ne Y'$. This property makes it necessary sometimes to
perform additional constructions such as ...
%@@@

Note that the expression ``for all $x$ in $A$, a $y(x)$ in $B(x)$'' is a form
of saying ``a family $y$, parametrized by $x$ in $A$, such that $y(x)$ is in
$B(x)$''. For a way to define a family of sets in ZFC without a universe
see \cite[Remark 3.9]{fromunivwithPiI}. Families of sets do not form a
set. However, families of sets with a given parameter set and such that all the
sets of the family are subsets of given set do. A formulation in terms of
iterated families can be used for ``for all'' expressions where there are
several parameters, such as in Definition \ref{2015.12.22.def1}(3). Similarly, a
``collection of data'', is understood as an $n$-tuple, which is understood as
an iterated pair $(\dots(-,-),-)\dots,-)$.

We fix a universe $U$ without making precise what conditions on the set $U$ we
require. It is clear that it is sufficient for all constructions of this paper
to require $U$ to be a Grothendieck universe. However, it is likely that a much
weaker set of conditions on $U$ is sufficient for our purposes. In all that
follows we write $Sets$ instead of $Sets(U)$.

\subsection{Acknowledgements}

This is one the papers extending the material which I started to work on in
\cite{NTS}. I would like to thank the Institute Henri Poincare in Paris and the
organizers of the ``Proofs'' trimester for their hospitality during the
preparation of the first version of this paper. The work on this paper was
facilitated by discussions with Benedikt Ahrens, Richard Garner, and Egbert
Rijke.

Work on this paper was supported by NSF grant 1100938.

This material is based on research sponsored by The United States Air
  Force Research Laboratory under agreement number FA9550-15-1-0053. The US
  Government is authorized to reproduce and distribute reprints for
  Governmental purposes notwithstanding any copyright notation thereon.
The views and conclusions contained herein are those of the author and should
not be interpreted as necessarily representing the official policies or
endorsements, either expressed or implied, of the United States Air Force
Research Laboratory, the U.S. Government or Carnegie Mellon University.

\subsection{A note from the editor}

After the death of Vladimir Voevodsky in
September, 2017, Daniel Grayson was appointed as the {\em academic executor},
in order to help arrange for the publication of his works.  This paper had been
submitted for publication, comments had been received twice from the referee,
and the paper had been extensively revised and expanded in response to the
referee's remarks.  Grayson has edited the paper, which was found
to be in a rough state.  Much of the work was cosmetic, aimed at improving the
use of the English language.  Where anything substantively mathematical is
involved, a footnote from the editor has been appended.
% remove that if there are no such footnotes.
In order to make it possible and convenient for readers to review the editor's
changes, all existing versions of the paper were entered into a {\em github}
repository, and editing was done in an incremental fashion, with {\em commit
  messages} describing the work done at each step.  The repository is visible
at
\hfill\break\centerline{\tiny{\tt \href{https://github.com/DanGrayson/VV-C-system-from-a-monad}{https://github.com/DanGrayson/VV-C-system-from-a-monad}%
  } .}
The paper is visible as an entry in the archival record of Voevodsky's work at
\hfill\break\centerline{\tiny{\tt \href{http://www.math.ias.edu/Voevodsky/voevodsky-publications\_abstracts.html\#1602.00352}{http://www.math.ias.edu/Voevodsky/voevodsky-publications\_abstracts.html\#1602.00352}%
  } ,}
and a link there will allow the reader to view all existing drafts of the paper.
If those links are ever broken, perhaps a search for the randomly chosen string
\hfill\break\centerline{\tiny{\tt 808d59c861bd87b38873e2d2e288511453262b1e}}
will allow the files to be located.

%###??? Make a note that we do not use dependent types in the paper which is why we can not simply write Hom(\wh{n},\wh{m})=R(stn(n))^{stn(m)}

\section{Relative monads and left modules over relative monads}

\subsection{Monads and relative monads} 

Let us start by recalling the definition of ``monad'' in the form that became
standard after MacLane's textbook \cite[p.~133]{MacLane}, which we will call
the {\em monoidal} form. For a category $\C$ we often write $X\in\C$ instead of
$X\in Ob(C)$. For a functor $F=(F_{Ob},F_{Mor})$ from $\C$ to $\D$ we often
write $F(X)$ instead of $F_{Ob}(X)$ for $X\in Ob(\C)$ and $F(f)$ instead of
$F_{Mor}(f)$ for $f\in Mor(\C)$.  We emphasize these standard conventions here,
because below we will sometimes work with the object and morphism components of
a functor separately, in which case the subscripts $Ob$ and $Mor$ will need to
be used.
%
\begin{definition}
  \llabel{2017.04.01.def1}
  A monad in monoidal form on a category $\C$ is a triple $\R=(R,\eta,\mu)$,
  where $R:\C\sr \C$ is a functor, and where $\eta:Id_{\C}\sr R$ and $\mu:R\circ R\sr R$
  are natural transformations, such that for any $X\in\C$ one has
  %
  \begin{enumerate}
  \item \llabel{2017.04.19.eq7} $R(\mu_X)\circ \mu_{X}=\mu_{R(X)}\circ \mu_X$ (``associativity''),
  \item \llabel{2017.04.19.eq8} $\eta_{R(X)}\circ \mu_X=Id_{R(X)}$ and $R(\eta_X)\circ \mu_X=Id_{R(X)}$ (two ``unity axioms'').
  \end{enumerate}
\end{definition}
%
We will omit the qualification ``in monoidal form'' when it is clear from the context. 

The following definition specifies objects that we will call ``monads in
Kleisli form''. To the best of my knowledge it explicitly appeared first
in the groundbreaking paper by Eugenio Moggi \cite{Moggi}.
%
\begin{definition}
\llabel{2017.04.13.def1}
A monad in Kleisli form on a category $\C$ is a triple $\RR=(RR_{Ob},\eta,rr)$, where 
%
\begin{enumerate}
\item \llabel{2017.04.19.eq1} $RR_{Ob}:Ob(\C)\sr Ob(\C)$ is a function,
\item \llabel{2017.04.19.eq2} $\eta$ is a family, parametrized by $X\in Ob(\C)$, of morphisms $\eta_X:X\sr RR_{Ob}(X)$,
\item \llabel{2017.04.19.eq3} $rr$ is a family, parametrized by pairs $X,Y\in Ob(\C)$, of functions 
%
$$rr_{X,Y}:Mor_{\C}(X,RR_{Ob}(Y))\sr Mor_{\C}(RR_{Ob}(X),RR_{Ob}(Y))$$
%
\end{enumerate}
%
such that
%
\begin{enumerate}[resume]
\item \llabel{2017.04.19.eq4} for all $X\in\C$, $rr_{X,X}(\eta_X)=Id_{RR_{Ob}(X)}$,
\item \llabel{2017.04.19.eq5} for all $X,Y$, $f:X\sr RR_{Ob}(Y)$, $\eta_X\circ rr_{X,Y}(f)=f$,
\item \llabel{2017.04.19.eq6} for all $X,Y,Z$, $f:X\sr RR_{Ob}(Y)$, $g:Y\sr RR_{Ob}(Z)$, 
%
$$rr_{X,Y}(f)\circ rr_{Y,Z}(g)=rr_{X,Z}(f\circ rr_{Y,Z}(g))$$
%
\end{enumerate}
\end{definition}
%
We will omit the qualification ``in Kleisli form'' when it is clear from the context. 
Definition \ref{2017.04.01.def1} is equivalent to Definition \ref{2017.04.13.def1} in the precise sense that is specified by Problem \ref{2017.01.04.prob1} and Construction \ref{2017.01.04.constr1} immediately following. 
%
\begin{problem}
\llabel{2017.01.04.prob1}
Given a function $RR_{Ob}:Ob(\C)\sr Ob(\C)$ and a family $\eta$, parametrized
by $X\in Ob(\C)$, of morphisms $\eta_X:X\sr RR_{Ob}(X)$, to construct a
bijection between the following two sets:
%
\begin{enumerate}
\item the set of pairs of the form
%
\begin{enumerate}
\item a function $RR_{Mor}:Mor(\C)\sr Mor(\C)$,
\item a family, parametrized by $X\in Ob(\C)$, of morphisms 
%
$$\mu_X:RR_{Ob}(RR_{Ob}(X))\sr RR_{Ob}(X)$$
%
\end{enumerate}
%
such that $((RR_{Ob},RR_{Mor}),\eta,\mu)$ is a monad on $\C$ in monoidal form, that is, 
%
\begin{enumerate}[resume]
\item $RR=(RR_{Ob},RR_{Mor})$ is a functor,
\item $(RR_{Ob},\mu)$ satisfies condition \ref{2017.04.19.eq7} of Definition \ref{2017.04.01.def1},
\item $(RR_{Ob},\eta,\mu)$ satisfies condition \ref{2017.04.19.eq8} of Definition \ref{2017.04.01.def1},
\item $\eta$ is a natural transformation $Id_{\C}\sr RR$,
\item $\mu$ is a natural transformation $RR\circ RR\sr RR$,
\end{enumerate}
%
\item the set of families, parametrized by $X,Y\in Ob(\C)$, of functions
%
$$rr_{X,Y}:Mor_{\C}(X,RR_{Ob}(Y))\sr Mor_{\C}(RR_{Ob}(X),RR_{Ob}(Y))$$
%
such that $(RR_{Ob},\eta,rr)$ is a monad on $\C$ in Kleisli form, that is, 
%
\begin{enumerate}
\item $(RR_{Ob},\eta,rr)$ satisfies condition \ref{2017.04.19.eq4} of Definition \ref{2017.04.13.def1},
\item $(RR_{Ob},\eta,rr)$ satisfies condition \ref{2017.04.19.eq5} of Definition \ref{2017.04.13.def1},
\item $(RR_{Ob},rr)$ satisfies condition \ref{2017.04.19.eq6} of Definition \ref{2017.04.13.def1}.
\end{enumerate}
\end{enumerate}
\end{problem}
%
We have intentionally expanded the definitions of {\em monad in monoidal form}
and {\em monad in Kleisli form} to show that that the expanded definition of the
latter is much shorter than that of the former. Monads are used extensively in
computer science, but almost always in Kleisli form, and the fact that
Kleisli form is much more concise than the monoidal form may be one of the
reasons.

On the other hand, it is likely that the reason monads in Kleisli form are not
widely known among mathematicians is that they are defined not as functors with
a structure, but as functions between sets of objects with a structure. In
particular, it is not obvious from their definition that monads in Kleisli
form can be transported along equivalences of categories.

We devote so much attention to these two definitions, because they provide one
of the clearest examples of how the same objects can have different and often
mutually incomprehensible definitions in the parallel realities of mathematics
and that part of theoretical computer science which is known as Theoretical
Computer Science B.

We now outline the construction for Problem \ref{2017.01.04.prob1}
%
\begin{construction}\rm
\llabel{2017.01.04.constr1}
To go from the monoidal form to the Kleisli form, one defines, for $X,Y\in Ob(\C)$ and $f:X\sr RR_{Ob}(Y)$
%
\begin{equation}
\llabel{2017.04.17.eq1}
rr_{X,Y}(f)=RR_{Mor}(f)\circ \mu_Y
\end{equation}%
%
To go from the Kleisli form to the monoidal form one defines
%
\begin{enumerate}
\item for $f:X\sr Y$ in $Mor(\C)$
%
\begin{equation}
\llabel{2017.04.17.eq2a}
RR_{Mor}(f)=rr_{X,Y}(f\circ \eta_Y)
\end{equation}%
%
\item for $X\in Ob(\C)$
%
\begin{equation}
\llabel{2017.04.17.eq2b}
\mu_X=rr_{RR_{Ob}(X),X}(Id_{RR_{Ob}(X)})
\end{equation}%
%
\end{enumerate}
%
We leave the verification of the conditions and the proof that these functions
are mutually inverse to the formally verified version of the paper. 
\ec
%#### details, to M.
For a monad $\RR$ in Kleisli form we let $\RR^M$ denote the corresponding
monad in monoidal form, and for a monad $\R$ in monoidal form we let $\R^K$
denote the corresponding monad in Kleisli form.

The notion of relative monad arises naturally from the notion of monads in Kleisli
form. It was introduced in \cite[Def.~1, p.~299]{ACU} and considered in more
detail in \cite{ACU2}. Let us recall it here.
%
\begin{definition}
\llabel{2015.12.22.def1}
Let $J:\C\sr \D$ be a functor. A relative monad $\RR$ on $J$ (or a $J$-relative monad, or a $J$-monad) is a triple $(RR_{Ob},\eta,rr)$, where
%
\begin{enumerate}
\item $RR_{Ob}:Ob(\C)\sr Ob(\D)$ is a function,
\item for all $X$ in $\C$, $\eta_{X}:J(X)\sr RR_{Ob}(X)$ is a morphism in $\D$,
\item and for all $X,Y$ in $\C$ and $f:J(X)\sr RR_{Ob}(Y)$ in $\D$,
%
$$rr_{X,Y}(f):RR_{Ob}(X)\sr RR_{Ob}(Y)$$
%
is a morphism in $\D$,
\end{enumerate}
%
such that the following conditions hold:
%
\begin{enumerate}[resume]
\item for all $X\in \C$, $rr_{X,X}(\eta_{X})=Id_{RR_{Ob}(X)}$,
\item for all $X,Y\in \C$ and $f:J(X)\sr RR_{Ob}(Y)$, $\eta_{X}\circ rr_{X,Y}(f)=f$,
\item for all $X,Y,Z\in \C$, $f:J(X)\sr RR_{Ob}(Y)$ and $g:J(Y)\sr RR_{Ob}(Z)$, 
%
$$rr_{X,Y}(f)\circ rr_{Y,Z}(g)=rr_{X,Z}(f\circ rr_{Y,Z}(g))$$
%
\end{enumerate}
\end{definition}
%
Sometimes one writes $f^*$ instead of $rr_{X,Y}(f)$. It makes long computations
look nicer, but one should remember that the notation $f^*$ is under-specified,
because $f^*$ depends not only on $f$ but also on $X$ and $Y$, and it is
possible that, for example, $RR_{Ob}(Y_1)=RR_{Ob}(Y_2)$ while $Y_1\ne Y_2$.
%###To Matthew or Joj - construct an example where rr_{X,Y}(f)\ne rr_{X',Y'}(f)
%
\begin{problem}\llabel{2016.01.15.prob1}
Given a $J$-relative monad $\RR=(RR_{Ob},\eta,rr)$ to construct a function
$RR_{Mor}:Mor(\C)\sr Mor(\D)$ such that $\RR^f=(RR_{Ob},RR_{Mor})$ is a
functor.
\end{problem}
%
\begin{construction}\rm\llabel{2016.01.15.constr1}\rm
For $f:X\sr Y$ in $\C$ set
%
\begin{equation}\llabel{2017.04.05.eq3}
RR_{Mor}(f)=rr_{X,Y}(J(f)\circ \eta_{Y})
\end{equation}%
%
The proofs of the composition and the identity axioms of a functor are omitted. 
\ec
%### details, to M. or J.?
%
An $Id_{\C}$-relative monad will be called an {\em endo-monad}. An endo-monad is
precisely a monad on the corresponding category given in Kleisli form. This
permits us to call, sometimes, endo-monads simply monads.  The explicit
form of functions $(-)^K$ and $(-)^M$ defined in Construction
\ref{2017.01.04.constr1} shows that for $\R=(R,\eta,\mu)$ we have
$\R^K=(R_{Ob},\eta,rr)$ and for $\RR=(RR_{Ob},\eta,rr)$ we have
$\RR^M=(\RR^f,\eta,\mu)$. In particular, since $(\R^K)^M=\R$, we have
%
\begin{equation}\llabel{2017.04.05.eq2}
(\R^K)^f=R
\end{equation}%
%

The construction of the Kleisli category of a monad\footnote{Actually Kleisli,
  in \cite{Kleisli}, introduced the corresponding category for what we would
  today call a comonad.} was extended to the case of relative monads in
\cite[p.~8]{ACU2} (see also \cite[Constr. 2.9]{LandJf}). Since it plays an
important role in what follows let us recall the definition of the
corresponding category data here without proving that it actually defines a
category.
%
\begin{problem}
  \llabel{2017.03.12.prob3}
  Given a functor $J:\C\sr\D$ and a $J$-monad $\RR=(RR,\eta,rr)$ to construct a
  category $K(\RR)$ that will be called the {\em Kleisli category} of $\RR$.
\end{problem}
%
\begin{construction}\rm
\llabel{2017.03.12.constr3}
We set $Ob(K(\RR))=Ob(\C)$ and 
%
$$Mor(K(\RR))=\amalg_{X,Y\in K(\RR)}Mor(J(X),RR(Y))$$
%
For $X,Y\in K(\RR)$, we will identify the set of morphisms in $K(\RR)$ from $X$
to $Y$ with the set $Mor(J(X),RR(Y))$ by means of the obvious bijections.

For $X\in Ob(\C)$ we set $Id_{X,K(\RR)}=\eta_{X}$.

For $f\in Mor_{\D}(J(X),RR(Y))$ and $g\in Mor_{\D}(J(Y),RR(Z))$ we set 
%
\begin{equation}\llabel{2017.04.05.eq1}
f\circ_{K(\RR)}g:=f\circ_{\D} rr_{Y,Z}(g)
\end{equation}%
%
\ec
%
\begin{problem}
\llabel{2017.04.05.prob2}
In the context of Problem \ref{2017.03.12.prob3}, to construct a functor 
%
$$Et_{\RR}:\C\sr K(\RR)$$
%
\end{problem}
%
\begin{construction}\rm\llabel{2017.04.05.constr2}
We omit the subscript $\RR$ on $Et$. We set $Et_{Ob}:=Id$. For a morphism $f:X\sr Y$ in $\C$ we set 
%
\begin{equation}
\llabel{2017.04.09.eq2}
Et_{Mor}(f):=J(f)\circ \eta_Y
\end{equation}%
%
For $f=Id_X$ we have 
%
$$Et(Id_X)=J(Id_X)\circ \eta_X=Id_{J(X)}\circ \eta_X=\eta_X=Id_{X,K(\RR)}$$
%
This proves the identity axiom. For $f:X\sr Y$, $g:Y\sr Z$ we have
%
$$Et(f\circ g)=J(f\circ g)\circ \eta_Z=J(f)\circ J(g)\circ \eta_Z$$
%
and
%
\begin{equation*}
  \begin{split}
    Et(f)\circ Et(g)&=(J(f)\circ \eta_Y)\circ_{K(\RR)}(J(g)\circ \eta_Z)
    \\
    &=J(f)\circ \eta_Y\circ rr_{Y,Z}(J(g)\circ \eta_Z)
    \\
    &=J(f)\circ J(g)\circ \eta_Z,
  \end{split}
\end{equation*}
%
where the second equality follows from (\ref{2017.04.05.eq1}), and the third follows from
condition (2) of Definition \ref{2015.12.22.def1}. This proves the composition
axiom. 
\ec
%
\begin{problem}\llabel{2017.04.11.prob1}
Let $J:\C\sr\D$ be a functor and $\RR=(RR_{Ob},\eta,rr)$ a $J$-relative
monad. To construct a functor $\RR^{lm}:K(\RR)\sr \D$.
\end{problem}
%
\begin{construction}\rm\llabel{2017.04.09.constr1}
%We will write $RR$ instead of $RR_{Ob}$. 
We set $\RR^{lm}_{Ob}=RR_{Ob}$. For 
%
$$f\in Mor_{K(\RR)}(X,Y)=Mor_{\D}(J(X),RR_{Ob}(Y)),$$
%
where the equality is actually the bijection mentioned in the definition of
$K(\RR)$, we set $\RR^{lm}_{Mor}(f)=rr_{X,Y}(f)$.

The verification of the composition and identity axioms for
$(\RR^{lm}_{Ob},\RR^{lm}_{Mor})$ is straightforward and is left for the
formalized version of the paper. 
\ec
%
%### details to M.?

So far our only examples of relative monads have been provided by the ``usual''
monads in Kleisli form, in particular, they have all been endo-monads.  The
following construction allows one to obtain a large class of relative monads
that are not endo-monads.
%
\begin{problem}\llabel{2017.02.24.prob1}
Given functors $F:\C_0\sr \C_1$, $J:\C_1\sr\D$ and a $J$-relative monad $\RR$
to construct a $(F\circ J)$-relative monad $F^{\circ}(\RR)$.
\end{problem}
%
\begin{construction}\llabel{2017.02.24.constr1}\rm
We omit the subscripts $Ob$ and $Mor$ on $F$ and $J$. Let $\RR=(RR_{Ob},\eta,rr)$. We set
%
\begin{equation}
\llabel{2017.04.11.eq3}
F^{\circ}(\RR):=(F^{\circ}(RR_{Ob}), F^{\circ}(\eta), F^{\circ}(rr))
\end{equation}%
%
where, for for $X\in \C_0$
%
\begin{equation}
  \llabel{2017.04.11.eq1}
  \begin{split}
    F^{\circ}(RR_{Ob})(X)&:=RR_{Ob}(F(X))\\
    F^{\circ}(\eta)_X&:=\eta_{F(X)}
  \end{split}
\end{equation}%
%
and for $X,Y\in\C_0$ and $f:J(F(X))\sr RR_{Ob}(F(Y))$,
%
\begin{equation}
\llabel{2017.04.11.eq2}
F^{\circ}(rr)_{X,Y}(f):=rr_{F(X),F(Y)}(f)
\end{equation}%
%
Let us verify conditions (1)-(3) of Definition \ref{2015.12.22.def1}. We write
$RR$ instead of $RR_{Ob}$ :
%
\begin{enumerate}
\item Let $X\in\C_0$. Then 
%
$$F^{\circ}(rr)_{X,X}(F^{\circ}(\eta)_X)=rr_{F(X),F(X)}(\eta_{F(X)})=
Id_{RR(F(X))}=Id_{F^{\circ}(RR)(X)}$$
%
\item Let $X,Y\in \C_0$ and $f:J(F(X))\sr RR(F(Y))$. Then
%
$$F^{\circ}(\eta)_X\circ F^{\circ}(rr)_{X,Y}(f)=\eta_{F(X)}\circ rr_{F(X),F(Y)}(f)=f$$
%
\item Let $X,Y,Z\in \C_0$ and 
%
$$f:J(F(X))\sr RR(F(Y))\spc\spc g:J(F(Y))\sr RR(F(Z))$$
%
are morphisms in $\D$. Then
%
$$F^{\circ}(rr)_{X,Y}(f)\circ F^{\circ}(rr)_{Y,Z}(g)=rr_{F(X),F(Y)}(f)\circ rr_{F(Y),F(Z)}(g)=$$
$$rr_{F(X),F(Z)}(f\circ rr_{F(Y),F(Z)}(g))=F^{\circ}(rr)_{X,Z}(f\circ F^{\circ}(rr)_{Y,Z}(g))$$
\end{enumerate}
%
This completes Construction \ref{2017.02.24.constr1}.
\ec
%
\begin{lemma}
\llabel{2017.04.09.l1}
In the context of Problem \ref{2017.02.24.prob1} one has
%
\begin{equation}
\llabel{2017.04.17.eq6}
(F^{\circ}(\RR))^f=F\circ RR^f
\end{equation}%
%
\end{lemma}
%
\begin{proof}
In what follows we omit the subscripts $Ob$ and $Mor$ on $F$ and $J$. The
left and right hand sides of (\ref{2017.04.17.eq6}) are functors
$\C_0\sr\D$. Let $\RR=(RR_{Ob},\eta,rr)$. Then both of these functors on
objects are given, by construction, by $F\circ RR_{Ob}$. It remains to show
that for $f:\sr Y$ in $\C_0$ we have
%
\begin{equation}
\llabel{2017.04.09.eq5}
F^{\circ}(\RR)_{Mor}(f)=(F_{Mor}\circ RR_{Mor})(f)
\end{equation}%
%
We have
%
$$F^{\circ}(\RR)_{Mor}(f)=F^{\circ}(rr)((F\circ J)(f)\circ F^{\circ}(\eta)_Y)=rr_{F(X),F(Y)}(J(F(f))\circ \eta_{F(Y)}),$$
%
where the first equality is by (\ref{2017.04.05.eq3}) and
(\ref{2017.04.11.eq3}) and the second by (\ref{2017.04.11.eq1}) and
(\ref{2017.04.11.eq2}). On the other hand
%
$$(F_{Mor}\circ RR_{Mor})(f)=RR_{Mor}(F(f))=rr_{F(X),F(Y)}(J(F(f))\circ \eta_{F(Y)}),$$
%
where the second equality is by (\ref{2017.04.05.eq3}). This completes the proof of the lemma.
\end{proof}
%
\begin{remark}\rm\llabel{2017.04.09.rem1}
Note that the construction of $F^{\circ}(\RR)$ depends on
$F_{Ob}$ but not on $F_{Mor}$.  On the other hand, we have
(\ref{2017.04.09.eq5}). The explanation for this seeming contradiction is that
$F^{\circ}(\RR)$ is a $(F\circ J)$-relative monad, and $(F\circ J)_{Mor}$, and
therefore $F_{Mor}$, participate in the definition of $F^{\circ}(\RR)_{Mor}$.
\end{remark}
%
\begin{problem}
\llabel{2017.03.12.prob1} Given functors $F:\C_0\sr \C_1$ and $J:\C_1\sr \D$,
and a $J$-monad $\RR$ to construct a functor $F_{\RR}:K(F^{\circ}(\RR))\sr
K(\RR)$.
\end{problem}
%
\begin{construction}\rm
\llabel{2017.03.12.constr2} We set $F_{\RR,Ob}=F_{Ob}$. For $X,Y\in\C_0$ and a
morphism $f:J(F(X))\sr RR(F(Y))$ in $K(F^{\circ}(\RR))$ from $X$ to $Y$, we set
%
\begin{equation}
\llabel{2017.03.12.eq2}
F_{\RR,X,Y}(f)=f
\end{equation}%
%
that is, $F_{\RR,Mor}$ is given by the function
%
$$\amalg_{X_0,Y_0\in\C_0}Mor_{\D}(J(F(X_0)),RR(F(Y_0)))\sr \amalg_{X_1,Y_1\in\C_1}Mor_{\D}(J(X_1),RR(Y_1))$$
%
of the form $((X_0,Y_0),f)\mapsto ((F(X_0),F(Y_0)),f)$. 

Let us show that $(F_{\RR,Ob},F_{\RR,Mor})$ is a functor. 

Note first that for $X\in\C_0$ one has
%
\begin{equation}
\llabel{2017.03.12.eq1}
Id_{K(F^{\circ}(\RR)),X}=F^{\circ}(\eta)_{X}=\eta_{F(X)},
\end{equation}%
%
where the first equality is by Construction \ref{2017.03.12.constr3} and the
second by Construction \ref{2017.02.24.constr1}. The data
$(F_{\RR,Ob},F_{\RR,Mor})$ satisfies the identity axiom, because of the
equalities
%
$$F_{\RR,X,X}(Id_{K(F^{\circ}(\RR)),X})=F_{\RR,X,X}(\eta_{F(X)})=\eta_{F(X)}=Id_{K(\RR),F(X)},$$
%
where the first equality is by (\ref{2017.03.12.eq1}), the second by (\ref{2017.03.12.eq2}) and the third by Construction \ref{2017.03.12.constr3}. 

Next, for $X,Y,Z\in \C_0$ and $f:J(F(X))\sr RR(F(Y))$, $g:J(F(Y))\sr RR(F(Z))$ one has
%
\begin{equation}
\llabel{2017.03.12.eq3}
f\circ_{KK(F^{\circ}(\RR))} g= f\circ_{\D} F^{\circ}(rr)_{Y,Z}(g)=f\circ_{\D} rr_{F(Y),F(Z)}(g)
\end{equation}%
%
where, again, the first equality is by Construction \ref{2017.03.12.constr3}
and the second by Construction \ref{2017.02.24.constr1}. The data
$(F_{\RR,Ob},F_{\RR,Mor})$ satisfies the composition axiom, because of the
equalities
%
\begin{equation*}
  \begin{split}
    F_{\RR,X,Z}(f\circ_{K(F^{\circ}(\RR))} g)&=F_{\RR,X,Z}(f\circ_{\D} rr_{F(Y),F(Z)}(g)) \\
    &=f\circ_{\D} rr_{F(Y),F(Z)}(g)=f\circ_{K(\RR)}g \\
    &=F_{\RR,X,Y}(f)\circ_{K(RR)}F_{\RR,Y,Z}(g),
  \end{split}
\end{equation*}
%
where the first equality is by (\ref{2017.03.12.eq3}), the second by (\ref{2017.03.12.eq2}), the third by Construction \ref{2017.03.12.constr3} and the fourth also by (\ref{2017.03.12.eq2}). 

This completes Construction \ref{2017.03.12.constr2}.
\ec
%

The following construction together with Construction \ref{} are used to
extract pairs $(\RR,\LM)$ consisting of a relative monad and a left module over it from
two-sorted relative monads, such as the ones that arise from two-sorted
second-order signatures, see \cite{AMM2017}.

For two functors $F:\C\sr\D$, $F':\C'\sr\D'$ we let $F\boxtimes F'$ denote the
corresponding functor from $\C\times\C'$ to $\D\times\D'$. If $\C=\C'$ we let
$F\times F'$ denote the composition of $F\boxtimes F'$ with the diagonal $\C\sr
\C\times\C$, that is, the functor given on objects by $X\mapsto
(F(X),F'(X))$. For a functor $FF:\C\sr \D\times\D'$ we let $FF_{\D}$ and
$FF_{\D'}$ denote the compositions of $FF$ with the projections from
$\D\times\D'$ to $\D$ and $\D'$ respectively. We will also use the notation
$FF_{\D}$ when $FF$ is (just) a function on objects.
%
\begin{definition}
  \llabel{2017.04.21.def1}
  An object constancy structure on a functor $F:\C\sr\D$
  is a family, parametrized by $X,Y\in\C$, of morphisms $\nu_{X,Y}:F(X)\sr F(Y)$
  such that:
%
\begin{enumerate}
\item \llabel{2017.04.21.eq3} for all $X$, $\nu_{X,X}=Id_{F(X)}$,
\item \llabel{2017.04.21.eq4} for all $X,Y,Z$, $\nu_{X,Z}=\nu_{X,Y}\circ\nu_{Y,Z}$.
\end{enumerate}
\end{definition}
%
Note that for an object constancy structure we have, for all $X,Y\in \C$, 
%
$$
\begin{CD}
\nu_{X,Y}\circ \nu_{Y,X}=\nu_{X,X}=Id_{F(X)}\\
\nu_{Y,X}\circ \nu_{X,Y}=\nu_{Y,Y}=Id_{F(Y)}
\end{CD}
$$
%
that is, $\nu_{X,Y}$ and $\nu_{Y,X}$ are mutually inverse and, in particular, $\nu_{X,Y}$ is an isomorphism. 

For any object $A$ of $\D$ the functor $\uu{A}_{\C}:\C\sr \D$ given on objects
by $\uu{A}_{\C}(X)=A$ and on morphisms by $\uu{A}_{\C}(f)=Id_A$ has an obvious
object constancy structure with $\nu_{X,Y}=Id_A$ for all $X,Y$. We will call it
the {\em identity object constancy structure corresponding to $A$}.

Since the object constancy structure does not impose any condition on $\nu$
with respect to morphisms of $\C$ or $\D$, there are many other
examples. Indeed, for $A$ as above, the identity object constancy structure is
defined for any functor $F$, however non-trivial on morphisms, but such that
$F(X)=A$ for all $X\in\C$.
%
\begin{problem}
\llabel{2017.04.21.prob1}
Let $\C,\D,\D'$ be categories, $J:\C\sr \D\times\D'$ a functor and
$\RR=(RR,\eta,rr)$ a $J$-relative monad. Assume in addition that we are given
an object constancy structure $\nu$ on $J_{\D'}:\C\sr\D'$.

To construct a structure of a $J_{\D}$-monad on $RR_{\D}$. This $J_{\D}$-monad will be denoted $\RR_{\D}$.
\end{problem}
%
\begin{construction}\rm
\llabel{2017.04.21.constr1}
We need to construct:
%
\begin{enumerate}
\item a family $\eta^{\D}$, parametrized by $X\in\C$, of morphisms $\eta^{\D}_X:J_{\D}(X)\sr RR_{\D}(X)$,
\item a family parametrized by $X,Y\in\C$ and $f:J_{\D}(X)\sr RR_{\D}(Y)$, of morphisms $rr^{\D}_{X,Y}(f):RR_{\D}(X)\sr RR_{\D}(Y)$,
\end{enumerate}
%
and to prove that $\RR_{\D}$, defined as $(RR_{\D},\eta^{\D},rr^{\D})$,
satisfies conditions \ref{2017.04.19.eq4}, \ref{2017.04.19.eq5} and
\ref{2017.04.19.eq6} of Definition \ref{2017.04.13.def1}.

Let $X\in\C$. Then $\eta_X$ is a morphism from $J(X)$ to $RR(X)$. We set 
%
\begin{equation}
\llabel{2017.04.21.eq1}
\eta^{\D}_X=pr_{\D}(\eta_X):J_{\D}(X)\sr RR_{\D}(X)
\end{equation}%
%
We will also consider $pr_{\D'}(\eta_X)$ that we will denote by $\eta^{\D'}_X$. 

Let $X,Y\in\C$ and $f:J_{\D}(X)\sr RR_{\D}(Y)$. We need to construct a morphism
$RR_{\D}(X)\sr RR_{\D}(Y)$. We have $\nu_{X,Y}:J_{\D'}(X)\sr J_{\D'}(Y)$ and
therefore we may consider the morphism
%
$$(f,\nu_{X,Y}\circ \eta^{\D'}_Y):(J_{\D}(X),J_{\D'}(X))=J(X)\sr RR(Y)=(RR_{\D}(Y),RR_{\D'}(Y))$$
%
and applying to it $rr_{X,Y}$ we obtain 
%
$$rr_{X,Y}((f,\nu_{X,Y}\circ \eta^{\D'}_Y)):RR(X)\sr RR(Y)$$
%
We set
%
\begin{equation}
\llabel{2017.04.21.eq2}
rr^{\D}_{X,Y}(f)=pr_{\D}(rr_{X,Y}((f,\nu_{X,Y}\circ \eta^{\D'}_Y)))
\end{equation}%
%

Let $X\in\C$. Then
%
\begin{equation}
\llabel{2017.04.23.eq1}
rr_{X,X}((\eta^{\D}_X,\nu_{X,X}\circ \eta^{\D'}_X))=
rr_{X,X}((\eta^{\D}_X,\eta^{\D'}_X))=
rr_{X,X}(\eta_X)=
Id_{RR(X)},
\end{equation}%
%
where the first equality holds by Definition
\ref{2017.04.21.def1}\ref{2017.04.21.eq3}, the second by definition of
$\eta^{\D}$ and $\eta^{\D'}$, and the fourth by the property
\ref{2017.04.13.def1}\ref{2017.04.19.eq4} of $\RR$.

Therefore,
%
$$rr^{\D}_{X,X}(\eta^{\D}_X)=
pr_{\D}(rr_{X,X}((\eta^{\D}_X,\nu_{X,X}\circ \eta^{\D'}_X)))=
pr_{\D}(Id_{RR(X)})=Id_{RR_{\D}(X)},$$
%
where the first equality holds by (\ref{2017.04.21.eq2}), the second by
(\ref{2017.04.23.eq1}) and the third by the definition of $pr_{\D}$. This
proves the property \ref{2017.04.13.def1}\ref{2017.04.19.eq4} for $\RR_{\D}$.

Let $X,Y\in\C$ and $f:J_{\D}(X)\sr RR_{\D}(Y)$. Then
%
\begin{equation}
  \llabel{2017.04.23.eq2}
  \begin{split}
    \eta^{\D}_X\circ rr^{\D}_{X,Y}(f)
    &=pr_{\D}(\eta_X)\circ pr_{\D}(rr_{X,Y}((f,\nu_{X,Y}\circ \eta^{\D'}_Y)))
    \\
    &=pr_{\D}(\eta_X\circ rr_{X,Y}((f,\nu_{X,Y}\circ \eta^{\D'}_Y)))
    \\
    &=pr_{\D}((f,\nu_{X,Y}\circ \eta^{\D'}_Y))=f,
  \end{split}
\end{equation}%
%
where the first equality holds by (\ref{2017.04.21.eq1}) and
(\ref{2017.04.21.eq2}), the second since $pr_{\D}$ commutes with compositions,
the third by the property \ref{2017.04.13.def1}\ref{2017.04.19.eq5} of $\RR$,
and the fourth by definition of $pr_{\D}$. This proves the property
\ref{2017.04.13.def1}\ref{2017.04.19.eq5} for $\RR_{\D}$.

Let $X,Y,Z\in\C$, $f:J_{\D}(X)\sr RR_{\D}(Y)$, and $g:J_{\D}(Y)\sr RR_{\D}(Z)$.  Then
\begin{equation}
  \llabel{2017.04.21.eq5}
  \begin{split}
      &rr_{X,Y}((f,\nu_{X,Y}\circ \eta^{\D'}_Y))\circ rr_{Y,Z}((g,\nu_{Y,Z}\circ \eta^{\D'}_Z))=
    \\&rr_{X,Z}((f,\nu_{X,Y}\circ \eta^{\D'}_Y)\circ rr_{Y,Z}((g,\nu_{Y,Z}\circ \eta^{\D'}_Z)))=
    \\&rr_{X,Z}((f\circ pr_{\D}(rr_{Y,Z}((g,\nu_{Y,Z}\circ \eta^{\D'}_Z))),\nu_{X,Y}\circ\eta^{\D'}_Y\circ pr_{\D'}(rr_{Y,Z}((g,\nu_{Y,Z}\circ\eta^{\D'}_Z))) )))=
    \\&rr_{X,Z}((f\circ pr_{\D}(rr_{Y,Z}((g,\nu_{Y,Z}\circ \eta^{\D'}_Z))),\nu_{X,Y}\circ pr_{\D'}(\eta_Y\circ rr_{Y,Z}((g,\nu_{Y,Z}\circ\eta^{\D'}_Z))) ))=
    \\&rr_{X,Z}((f\circ pr_{\D}(rr_{Y,Z}((g,\nu_{Y,Z}\circ \eta^{\D'}_Z))),\nu_{X,Y}\circ pr_{\D'}((g,\nu_{Y,Z}\circ\eta^{\D'}_Z)) ))=
    \\&rr_{X,Z}((f\circ pr_{\D}(rr_{Y,Z}((g,\nu_{Y,Z}\circ \eta^{\D'}_Z))),\nu_{X,Y}\circ\nu_{Y,Z}\circ\eta^{\D'}_Z) )=
    \\&rr_{X,Z}((f\circ pr_{\D}(rr_{Y,Z}((g,\nu_{Y,Z}\circ \eta^{\D'}_Z))),\nu_{X,Z}\circ\eta^{\D'}_Z) ))=
    \\&rr_{X,Z}((f\circ rr^{\D}_{Y,Z}(g),\nu_{X,Z}\circ\eta^{\D'}_Z)),
  \end{split}
\end{equation}%
%
where the first equality holds by the property
\ref{2017.04.13.def1}\ref{2017.04.19.eq6} of $\RR$, the second by the
definition of composition in $\D\times\D'$, the third since $pr_{\D'}$ commutes
with compositions, the fourth by the property
\ref{2017.04.13.def1}\ref{2017.04.19.eq5} of $\RR$, the fifth by the definition
of $pr_{\D'}$, the sixth by Definition
\ref{2017.04.21.def1}\ref{2017.04.21.eq4}, and the seventh by
(\ref{2017.04.21.eq2}).

Therefore,
%
\begin{equation*}
  \begin{split}
    rr^{\D}_{X,Y}(f)\circ rr^{\D}_{Y,Z}(g)&=
    pr_{\D}(rr_{X,Y}((f,\nu_{X,Y}\circ \eta^{\D'}_Y)))\circ 
    pr_{\D}(rr_{Y,Z}((g,\nu_{Y,Z}\circ \eta^{\D'}_Z)))
    \\
    &=pr_{\D}(rr_{X,Y}((f,\nu_{X,Y}\circ \eta^{\D'}_Y))\circ rr_{Y,Z}((g,\nu_{Y,Z}\circ \eta^{\D'}_Z)))
    \\
    &=pr_{\D}(rr_{X,Z}((f\circ rr^{\D}_{Y,Z}(g),\nu_{X,Z}\circ\eta^{\D'}_Z)))
    \\
    &=rr^{\D}_{X,Z}(f\circ rr^{\D}_{Y,Z}(g)),
  \end{split}
\end{equation*}
%
where the first equality holds by (\ref{2017.04.21.eq2}), the second since
$pr_{\D}$ commutes with compositions, the third by (\ref{2017.04.21.eq5}), and
the fourth again by (\ref{2017.04.21.eq2}). This proves the property
\ref{2017.04.13.def1}\ref{2017.04.19.eq6} for $\RR_{\D}$ and completes
Construction \ref{2017.04.21.constr1}. 
\ec
%
We want to emphasize the following case of Construction \ref{2017.04.21.constr1}.
%
\begin{problem}
\llabel{2017.04.23.prob1}
Let $\C$,$\D$ be categories. Let $\RR$ be an endo-monad on $\C\times\D$. Let $A\in Ob(D)$. To construct an endo-monad $\RR_{1,A}$ on $\C$.
\end{problem}
%
\begin{construction}
\llabel{2017.04.23.constr1}\rm 
Let $J:\C\sr\C\times\D$ be the functor given by
$X\mapsto (X,A)$ on objects and $f\mapsto (f,Id_A)$ on morphisms. Consider the
$J$-monad $J^{\circ}(\RR)$. It satisfies the conditions of Problem
\ref{2017.04.21.prob1} with respect to the identity object constancy structure
corresponding to $A$. Therefore, Constructions \ref{2017.04.21.constr1} applies
and we obtain a $J\circ pr_{\C}$-monad $(J^{\circ}(\RR))^{\D}$. Since $J\circ
pr_{\C}=Id_{\C}$ it is an endo-monad on $\C$ that we denote by
$\RR_{1,A}$. Explicitly, for $\RR=(RR,\eta,rr)$, we have
$\RR_{1,A}=(RR_{1,A},\eta^{1,A},rr^{1,A})$ where:
%
\begin{enumerate}
\item for $X\in \C$, $RR_{1,A}(X)=pr_{\C}(RR((X,A)))$,
\item for $X\in \C$, $\eta^{1,A}_X=pr_{\C}(\eta_{(X,A)})$,
\item for $X,Y\in \C$, $f:X\sr Y$, $rr^{1,A}_{X,Y}(f)=pr_{\C}(rr_{(X,A),(Y,A)}(f,pr_{\D}(\eta_{(Y,A}))))$.
\end{enumerate}
\ec
%
\begin{remark}\rm
The notation $\RR_{1,A}$ emphasizes that the monad is on the first projection
of the product $\C\times\D$. We can also construct, for $A\in Ob(C)$, an
endo-monad $\RR_{2,A}$ on $\D$.
\end{remark}
%

\subsection{Left modules over monads and relative monads}

%
A left module in monoidal form over a monad in monoidal form is defined as follows (cf.{} \cite[p.~222]{HM2007}). 
%
\begin{definition}
\llabel{2017.04.01.def2} 
Let $\C$,$\E$ be categories, $\R=(R,\eta,\mu)$ be a
monad on $\C$, and $L:\C\sr \E$ a functor. A (left) $\R$-module structure on
$L$ is a natural transformation $\rho:R\circ L\sr L$ such that for all $X\in\C$
one has:
%
\begin{enumerate}
\item $L(\mu_X)\circ \rho_X=\rho_{R(X)}\circ \rho_X$,
\item $L(\eta_X)\circ \rho_X=Id_{L(X)}$.
\end{enumerate}
%
A left $\R$-module in monoidal form with values in $\E$ is a pair ${\bf
  L}=(L,\rho)$, where $L:\C\sr \E$ is a functor and $\rho$ an $\R$-module
structure on $L$.
\end{definition}
%
\begin{example}\llabel{2017.04.15.ex1}\rm
For a monad $\R=(R,\eta,\rho)$ the pair $\R^{lm}=(R,\rho)$ is a left module over $\R$.
\end{example}
%

Left modules can also be defined in Kleisli form. 
%
\begin{definition}
\llabel{2017.04.15.def1} 
Let $\C$,$\E$ be categories and
$\RR=(RR_{Ob},\eta,rr)$ a monad on $\C$. A (left) $\RR$-module with values in
$\E$ in Kleisli form is a pair $(LM_{Ob},lm)$, where $LM_{Ob}:Ob(\C)\sr
Ob(\E)$ is a function and $lm$ is a family, parametrized by $X,Y\in Ob(\C)$ of
functions
%
$$lm_{X,Y}:Mor_{\C}(X,RR_{Ob}(Y))\sr Mor_{\E}(LM_{Ob}(X),LM_{Ob}(Y))$$
%
such that
%
\begin{enumerate}
\item for all $X\in\C$, $lm_{X,X}(\eta_X)=Id_{LM_{Ob}(X)}$,
\item for all $X,Y,Z\in\C$, $f:X\sr RR_{Ob}(Y)$, $g:Y\sr RR_{Ob}(Z)$, 
%
$$lm_{X,Y}(f)\circ lm_{Y,Z}(g)=lm_{X,Z}(f\circ rr_{Y,Z}(g))$$
\end{enumerate}
\end{definition}
%
As in the case of monads the monoidal and Kleisli forms of left modules are
equivalent in the following sense.
%
\begin{problem}
\llabel{2017.04.03.prob1} 
Given categories $\C$, $\E$, a monad
$\RR=(RR_{Ob},\eta,rr)$ on $\C$, and a function $LM_{Ob}:Ob(\C)\sr Ob(\E)$ to
construct a bijection between the following two sets:
%
\begin{enumerate}
\item the set of pairs $(LM_{Mor},\rho)$, where $LM_{Mor}:Mor(\C)\sr Mor(\E)$ is
  a function such that $LM=(LM_{Ob},LM_{Mor})$ is a functor and $(LM,\rho)$ is
  a left $\RR^M$-module in monoidal form,
\item the set of families $lm$, parametrized by $X,Y\in Ob(\C)$, of functions
%
$$lm_{X,Y}:Mor_{\C}(X,RR_{Ob}(Y))\sr Mor_{\C}(LM_{Ob}(X),LM_{Ob}(Y))$$
%
such that $(LM_{Ob},lm)$ is a left $\RR$-module in Kleisli form. 
\end{enumerate}
\end{problem}
%
\begin{construction}\rm\llabel{2017.04.03.constr1}
In one direction, given $LM_{Mor}$, a family $\rho_X:LM(RR_{Ob}(X))\sr LM(X)$
parametrized by $X\in Ob(\C)$, and $f:X\sr R(Y)$, one defines
%
\begin{equation}\llabel{2017.04.09.eq4}
lm_{X,Y}(f)=LM(f)\circ \rho_Y
\end{equation}%
%
In the other direction, given $LM_{Ob}$ and $lm$, one defines, for $f:X\sr Y$, 
%
\begin{equation}\llabel{2017.04.09.eq3}
LM_{Mor}(f)=lm_{X,Y}(f\circ \eta_Y)
\end{equation}%
%
and for $X$, 
%
$$\rho_X=lm_{RR_{Ob}(X),X}(Id_{RR_{Ob}(X)})$$

We leave the verification of the conditions and the proof that these functions
are mutually inverse to the formally verified version of the paper. 
\ec
%#### details to M.?
%
Left $\RR$-modules in Kleisli form with values in $\E$ are precisely the
(covariant) functors from the Kleisli category of $\RR$ to $\E$, see below.

Left modules over relative monads were introduced in \cite[Definition
  9]{Ahrens2016}. One can observe by direct comparison of unfolded definitions
that there is a bijection between the set of modules over a relative monad
$\RR$ with values in a category $\E$ and the set of functors from the Kleisli
category $K(\RR)$ of $\RR$ to $\E$. Whether this bijection is the identity
bijection or not depends on how the expressions, such as ``collection of data''
or ``family of functions'', are translated into the formal constructions of set
theory. We assume that in this case they have been translated in a
such a way that this bijection is the identity and left modules over $\RR$ with
values in $\E$ are actually and precisely the same as (covariant) functors from
$K(\RR)$ to $\E$.
%
\begin{definition}
\llabel{2017.03.16.def1} 
Let $J:\C\sr\D$ be a functor and
$\RR=(RR_{Ob},\eta,rr)$ a $J$-monad. A left module over $\RR$ with values in a
category $\E$ is a functor $\LM:K(\RR)\sr \E$, that is, a pair $(LM_{Ob},lm)$,
where $LM_{Ob}:Ob(\C)\sr Ob(\E)$ is a function and $lm$ is a family,
parametrized by $X,Y\in Ob(\C)$, of functions
%
$$lm_{X,Y}:Mor_{\D}(J(X),RR_{Ob}(Y))\sr Mor_{\E}(LM_{Ob}(X),LM_{Ob}(Y))$$
%
such that
%
\begin{enumerate}
\item for all $X\in\C$, $lm_{X,X}(\eta_X)=Id_{LM_{Ob}(X)}$,
\item for all $X,Y,Z\in\C$, $f:X\sr RR_{Ob}(Y)$, $g:Y\sr RR_{Ob}(Z)$, 
%
$$lm_{X,Y}(f)\circ lm_{Y,Z}(g)=lm_{X,Z}(f\circ rr_{Y,Z}(g))$$
\end{enumerate}
%
We will say that $\LM$ is an $\RR$-module if it is a left $\RR$-module. We will
say that $\LM$ is a module over $\RR$ without specifying $\E$ if $\E=\D$.
\end{definition}
%
From the unfolded definition we see that the left modules over an $Id$-relative
monad are exactly the same as the left modules in Kleisli form over the
corresponding monad. Following the notation $\R^K$ for the monad in Kleisli
form corresponding to a monad $\R$ in monoidal form, we let ${\bf L}^K$
denote the module over $\R^K$ in Kleisli form corresponding to a module
${\bf L}$ over $\R$ in monoidal form.
%
\begin{definition}
\llabel{2017.04.05.def1} 
Let $J:\C\sr\D$ be a functor, $\RR$ a $J$-monad and
$\LM$ a left module over $\RR$ with values in a category $\E$. We define the
functor $\LM^f:\C\sr \E$ corresponding to $\LM$ as the composition
$Et_{\RR}\circ \LM$.
\end{definition}
%
Explicitly, for $\LM=(LM_{Ob},lm)$, we have
%
$$\LM^f_{Ob}=LM_{Ob}$$
%
which follows from $Et_{\RR,Ob}=Id_{Ob(\C)}$, and for $f:X\sr Y$ 
%
\begin{equation}\llabel{2017.04.11.eq5}
\LM^f_{Mor}(f)=lm(J(f)\circ \eta_{Y})
\end{equation}%
%
which follows from (\ref{2017.04.09.eq2}). 

As in the case of $\RR^f$ we will use the notation $\LM^f_{Ob}$ and
$\LM^f_{Mor}$, with or without the subscripts $Ob$ and $Mor$ as our
preferential notation for the corresponding objects.

If $\R$ and ${\bf L}=(L,\rho)$ are a monad on $\C$ and a left module over it
with values in $\E$ given in monoidal form then we have
%
\begin{equation}
\llabel{2017.04.17.eq4}
({\bf L}^K)^f=L
\end{equation}%
%
On objects we have $({\bf L}^K)^f_{Ob}=L_{Ob}$ by construction. It remains to
show that
%
\begin{equation}\llabel{2017.04.09.eq1}
({\bf L}^K)^f_{Mor}=L_{Mor}
\end{equation}%
%
Indeed, for $f:X\sr Y$ in $Mor(\C)$ we have
%
\begin{equation*}
  \begin{split}
    ({\bf L}^K)^f_{Mor}(f) &= {\bf L}^K_{Mor}(Et_{\R^K,Mor}(f))
    \\
    &= {\bf L}^K_{Mor}(f\circ \eta_Y)=L_{Mor}(f\circ \eta_Y)\circ \rho_Y=L_{Mor}(f)\circ (L_{Mor}(\eta_Y)\circ \rho_Y)
    \\
    &= L_{Mor}(f)\circ Id_{L(Y)}=L_{Mor}(f),
  \end{split}
\end{equation*}
%
where the first equality is by Definition \ref{2017.04.05.def1}, the second by
(\ref{2017.04.09.eq2}), the third by (\ref{2017.04.09.eq4}), the fourth by the
composition axiom for $L$ and associativity of composition of $\E$, the fifth
by Definition \ref{2017.04.01.def2}(1) and the sixth by the right unity axiom
of $\E$.
%
\begin{example}\rm
\llabel{2017.04.15.ex2}
Construction \ref{2017.04.09.constr1} gives us, for any $J:\C\sr \D$ and any
$J$-monad $\RR$ a left module $\RR^{lm}$ over $\RR$ with values in $\D$.  If
$\RR=(RR_{Ob},\eta,rr)$, then $\RR^{lm}=(RR_{Ob},rr)$. This is the same
relationship as in the case of monads in monoidal form where for
$\R=(R,\eta,\mu)$ we have $\R^{lm}=(R,\mu)$.

We have 
%
$$(\RR^{lm})^f=\RR^f$$
%
Indeed, for $\RR=(RR_{Ob},\eta,\mu)$ both functors are given by $RR_{Ob}$ on
objects and on morphisms they also coincide by construction, because
(\ref{2017.04.11.eq5}) becomes (\ref{2017.04.05.eq3}) when $lm=rr$.

When $J=Id_{\C}$ we also have
%
$$(\R^K)^{lm}=(\R^{lm})^K$$
%
Indeed, for $\R=(R,\eta,\mu)$ we have
%
$$(\R^K)^{lm}=(R_{Ob},\eta,rr(R_{Mor},\mu))^{lm}=(R_{Ob},rr(R_{Mor},\mu))$$
%
and
%
$$(\R^{lm})^K=(R,\mu)^K=(R_{Ob},lm(R_{Mor},\mu))$$
%
and $rr(R_{Mor},\mu)$ and $lm(R_{Mor},\mu)$ coincide by construction, because formulas (\ref{2017.04.17.eq1}) and (\ref{2017.04.09.eq4}) become the same when $RR_{Mor}=LM_{Mor}$ and $\mu=\rho$.
\end{example}
%
\begin{problem}
\llabel{2017.03.12.prob2}
Given functors $F:\C_0\sr \C_1$ and $J:\C_1\sr \D$, a $J$-monad $\RR$ and an
$\RR$-module $\LM$ with values in $\E$ to construct an $F^{\circ}(\RR)$-module
$F^{\circ}(\LM)$ with values in $\E$.
\end{problem}
%
\begin{construction}\rm
\llabel{2017.03.12.constr1}
We need to construct a functor $K(F^{\circ}(\RR))\sr\E$. We define this functor
as the composition $F_{\RR}\circ \LM$, where $F_{\RR}$ is defined in
Construction \ref{2017.03.12.constr2}. Explicitly, for $\RR=(RR_{Ob},\eta,rr)$
and $\LM=(LM_{Ob},lm)$, we let $F\crc(\LM)=(F\crc(LM_{Ob}),F\crc(lm))$. In this
notation we have
%
\begin{equation}
\llabel{2017.04.17.eq7}
F\crc(LM_{Ob})=F\circ LM_{Ob}
\end{equation}%
%
and 
%
\begin{equation}
\llabel{2017.04.17.eq8}
F\crc(lm)_{X,Y}=lm_{F(X),F(Y)}
\end{equation}%
\ec
%
\begin{lemma}
\llabel{2017.04.17.l1}
In the context of Problem \ref{2017.03.12.prob2} we have 
%
\begin{equation}
\llabel{2017.04.13.eq2}
(F\crc(\LM))^f=F\circ \LM^f
\end{equation}%
%
\end{lemma}
%
\begin{proof}
The equality 
%
$$(F\crc(\LM))^f_{Ob}=(F\circ \LM^f)_{Ob}$$
%
is by construction and to prove the equality
%
\begin{equation}
\llabel{2017.04.13.eq1}
(F\crc(\LM))^f_{Mor}=(F\circ \LM^f)_{Mor}
\end{equation}%
%
we have, for $f:X\sr Y$ in $\C_0$,
%
\begin{equation*}
  \begin{split}
    (F\crc(\LM))^f_{Mor}(f)
    &= F\crc(lm)_{X,Y}((F\circ J)(f)\circ F\crc(\eta)_Y)
    \\
    &= F\crc(lm)_{X,Y}(J(F(f))\circ \eta_{F(Y)})=
    lm_{F(X),F(Y)}(J(F(f))\circ \eta_{F(Y)})
    \\
    &= \LM^f_{Mor}(F(f))=
    (F\circ \LM^f_{Mor})(f),
  \end{split}
\end{equation*}
%
where the first equality is by (\ref{2017.04.11.eq5}), the second by definition
of $F\circ J$ and (\ref{2017.04.11.eq1}), the third by (\ref{2017.04.17.eq8}),
the fourth by (\ref{2017.04.11.eq5}) and the fifth by the definition of $F\circ
\LM^f_{Mor}$. This completes the proof of Lemma \ref{2017.04.17.l1}.
\end{proof}
%
Combining the previous results we obtain a solution to the following problem
that we find convenient to formulate for the future reference.
%
\begin{problem}\llabel{2017.04.05.prob1}
Let $\C_0,\C_1,\E$ be categories. Let $\R=(R,\eta,\mu)$ be a monad on $\C_1$
and $ {\bf L}=(L,\rho)$ a left $\R$-module with values in $\E$. Let further
$J:\C_0\sr \C_1$ be a functor. To construct a pair of a $J$-relative monad
module with values in $\E$ over it.
\end{problem}
%
\begin{construction}\rm\llabel{2017.04.05.constr1}
We take $(J^{\circ}(\R^K),J^{\circ}({\bf L}^K))$.
\ec
%
Note that in the notation of Problem \ref{2017.04.05.prob1}, we have
%
\begin{equation}
\llabel{2017.04.17.eq9}
J\crc(\R^K)^f=J\circ (\R^K)^f=J\circ R,
\end{equation}%
%
where the first equality is by (\ref{2017.04.17.eq6}) and the second by (\ref{2017.04.05.eq2}). Similarly,
%
\begin{equation}
\llabel{2017.04.17.eq10}
J\crc(L^K)^f=J\circ ({\bf L}^K)^f=J\circ L,
\end{equation}%
%
where the second equality is by (\ref{2017.04.13.eq2}) and the third by (\ref{2017.04.17.eq4}).

Constructions \ref{2017.02.24.constr1} and \ref{2017.03.12.prob2} show that
both relative monads and left modules over them can be ``precomposed'' with any
functor. The left modules can also be ``post-composed'' with any functor. It is
done by literal post-composition. Since a left module is a functor
$\LM:K(\RR)\sr \E$ we can post-compose it with any functor $F:\E\sr \E'$ and
obtain a new module that we will denote $\LM\circ F$. Explicitly, for
$\LM=(LM_{Ob},lm)$ one has
%
$$\LM\circ F=(LM_{Ob}\circ F, F(lm))$$
%
where, for $X,Y\in \C$ and $f:J(X)\sr RR_{Ob}(Y)$, one has
%
$$F(lm)_{X,Y}(f)=F(lm_{X,Y}(f))$$
%

There is an analog of Construction \ref{2017.04.21.constr1} for modules.
%
\begin{problem}
\llabel{2017.04.23.prob2}
Let $\C,\D,\D'$ be categories, $J:\C\sr \D\times\D'$ a functor and $\RR=(RR,\eta,rr)$ a $J$-relative monad. Assume in addition that we are given an object constancy structure $\nu$ on $J_{\D'}:\C\sr\D'$. Let $\RR_{\D}$ be the $J_{\D}$-monad specified in Construction \ref{2017.04.21.constr1}.  

To construct a structure of a $\RR_{\D}$-module with values in $\D\times\D'$ on $RR$. 
\end{problem}
%
\begin{construction}\rm
\llabel{2017.04.23.constr2}
We need to construct a family $lm^{\D}$, parametrized by $X,Y\in\C$ and
$f:J_{\D}(X)\sr RR_{\D}(Y)$, of morphisms $lm^{\D}_{X,Y}(f):RR(X)\sr RR(Y)$,
and to prove that $\LM_{\D}$, defined as $(RR,lm^{\D})$, satisfies conditions
(1) and (2) of Definition \ref{2017.04.15.def1}.

We set:
%
$$lm^{\D}_{X,Y}(f)=rr_{X,Y}((f,\nu_{X,Y}\circ \eta^{\D'}_Y))$$
%
The proof of condition (1) of Definition \ref{2017.04.15.def1} is given by
(\ref{2017.04.23.eq1}). The proof of condition (2) is given by
(\ref{2017.04.21.eq5}).  This completes Construction \ref{2017.04.23.constr2}.
\ec
%
We also have an analog of the special case described in Construction
\ref{2017.04.23.constr1}. Let $\C$,$\D$ be categories and $A\in Ob(\D)$. Let
$J_{1,A}:\C\sr\C\times\D$ be the functor given by $X\mapsto (X,A)$ on objects
and $f\mapsto (f,Id_A)$ on morphisms. In Construction \ref{2017.04.23.constr1}
we wrote $J$ instead of $J_{1,A}$.
%
\begin{problem}
\llabel{2017.04.23.prob3} 
Let $\C$,$\D$ be categories. Let $\RR=(RR,\eta,rr)$
be an endo-monad on $\C\times\D$. Let $A\in Ob(D)$. To construct an
$\RR_{1,A}$-module structure on $J_{1,A}\circ RR$.
\end{problem}
%
\begin{construction}
\llabel{2017.04.23.constr3}\rm
Consider the $J_{1,A}$-monad $J_{1,A}^{\circ}(\RR)$. It satisfies the
conditions of Problem \ref{2017.04.23.prob2} with respect to the identity
object constancy structure corresponding to $A$. Therefore, Constructions
\ref{2017.04.23.constr2} applies and we obtain a
$(J_{1,A}^{\circ}(\RR))_{\C}$-module structure on $J_{1,A}\circ RR$. Since, by
Construction \ref{2017.04.23.constr1}, we have
$\RR_{1,A}=(J_{1,A}^{\circ}(\RR))_{\C}$, this provides a construction for
Problem \ref{2017.04.23.prob3}. Explicitly, if we let $(J_{1,A}\circ RR,
lm^{1,A})$ denote this module, we have, for $X,Y\in \C$ and $f:X\sr Y$
%
$$lm^{1,A}_{X,Y}(f)=rr_{(X,A),(Y,A)}(f,pr_{\D}(\eta_{(Y,A})))$$
%
\ec

\section{C-systems}

\subsection{Generalities}
\llabel{onCsystems}
%
The definition of a C-system is given in \cite[Def. 2.1,
  2.3]{Csubsystems}. Homomorphisms of C-systems are defined in \cite[Def. 3.1,
  p 1188]{Cfromauniverse}. In \cite[Lemma 3.4, p.~1190]{Cfromauniverse} it is
shown that for two C-systems $CC_1, CC_2$ a homomorphism between the underlying
C0-systems is always a homomorphism of C-systems.

Further study of C-systems can be found in \cite[Sec. 2, pp. 1048-1064]{fromunivwithPiI}. 

For $\Gamma',\Gamma$ in a C-system let us write $\Gamma'\ge \Gamma'$ and say
that $\Gamma'$ is over $\Gamma$ if $l(\Gamma')\ge l(\Gamma)$ and
$ft^{l(\Gamma')-l(\Gamma)}(\Gamma')=\Gamma$. We write $\Gamma'>\Gamma$ if
$\Gamma'\ge \Gamma$ and $l(\Gamma')>l(\Gamma)$.

If $\Gamma'$ is over $\Gamma$ we will denote by $p_{\Gamma',\Gamma}$ the
obvious composition of the $p$-morphisms starting with $\Gamma'$ and ending in
$\Gamma$.

If $\Gamma'',\Gamma'$ are over $\Gamma$, then we say that a morphism
$f:\Gamma''\sr \Gamma'$ is over $\Gamma$ if
%
$$f\circ p_{\Gamma',\Gamma}=p_{\Gamma'',\Gamma}$$
%
If $\Delta'$ is an object over $\Delta$ and $f:\Gamma\sr \Delta$ is a morphism
then we denote simply by $f^*(\Delta')$ the object $f^*(\Gamma',n)$, where
$n=l(\Gamma')-l(\Delta)$. Note that $n$ can always be inferred from $f$ and
$\Gamma'$.

Similarly we will write simply $q(f,\Gamma')$ for $q(f,\Gamma',n)$ since $n$ can be inferred as $l(\Gamma')-l(codom(f))$. 
%
\begin{lemma}
\llabel{2015.08.23.l1a} 
Let $\Gamma',\Gamma''$ be objects over $\Delta$,
$a:\Gamma'\sr \Gamma''$ a morphism over $\Delta$ and $f:\Gamma\sr\Delta$ a
morphism. Then there is a unique morphism $f^*(a):f^*(\Gamma')\sr
f^*(\Gamma'')$ over $\Gamma$ such that the square
%
$$
\begin{CD}
f^*(\Gamma') @>q(f,\Gamma')>> \Gamma'\\
@Vf^*(a)VV @VVaV\\
f^*(\Gamma'') @>q(f,\Gamma'')>> \Gamma''
\end{CD}
$$
%
commutes.
\end{lemma}
%
\begin{proof}
See \cite[Lemma 2.13]{fromunivwithPiI}.
\end{proof}
%
\begin{lemma}
\llabel{2015.08.29.l2} 
Let $a:\Gamma'\sr\Gamma''$ be a morphism over
$\Gamma'''$ and $\Gamma'''$ an object over $\Delta$. Then $a$ is a morphism
over $\Delta$ and for any $f:\Gamma\sr \Delta$ one has
%
\begin{equation}\llabel{2015.08.29.eq2}
f^*(a)=q(f,\Gamma''')^*(a)
\end{equation}%
%
\end{lemma}
%
\begin{proof}
See \cite[Lemma 2.15]{fromunivwithPiI}.
\end{proof}
%
We will also need the following facts about homomorphisms of C-systems. For the
last item of the lemma recall that for $\Gamma$ such that $l(\Gamma)>0$, one
defines $\delta(\Gamma)\in Mor(CC)$ as $s_{Id_{\Gamma}}$
%
\begin{lemma}
\llabel{2015.09.03.l2}
Let $F:CC\sr CC'$ be a homomorphism of C-systems. Then one has:
%
\begin{enumerate}
\item for $\Gamma',\Gamma\in CC$, $\Gamma\ge \Gamma'$ implies $F(\Gamma)\ge F(\Gamma')$ and similarly for $>$,
\item for $\Gamma'\ge \Gamma$ in $CC$ one has $F(p_{\Gamma',\Gamma})=p_{F(\Gamma'),F(\Gamma)}$,
\item for $\Gamma'\ge \Delta$ and $f:\Gamma\sr \Delta$ one has
%
$$F(f^*(\Gamma'))=(F(f))^*(F(\Gamma'))$$
$$F(q(f,\Gamma'))=q(F(f),F(\Gamma'))$$
%
\item for $a:\Gamma'\sr \Gamma''$ over $\Gamma$ and $f:\Delta\sr \Gamma$, $F(a)$ is a morphism over $F(\Gamma)$ and one has
%
$$F(f^*(a))=(F(f))^*(F(a))$$
%
\item for $\Gamma$ such that $l(\Gamma)>0$ one has
%
$$F(\delta(\Gamma))=\delta(F(\Gamma))$$
%
\end{enumerate}
\end{lemma}
%
\begin{proof}
For (1),(2),(3) see \cite[Lemma 2.5]{fromunivwithPiI}. For (4) see \cite[Lemma
  2.14]{fromunivwithPiI}. For (5) recall that we have
$\delta(\Gamma)=s_{Id_{\Gamma}}$ by the definition of $\delta$ in
\cite[p.~131]{Csubsystems}. Next, we have $F(s_f)=s_{F(f)}$ by \cite[Lemma
  3.4]{Cfromauniverse}. Therefore
%
$$F(\delta(\Gamma))=F(s_{Id_{\Gamma}})=s_{F(Id_{\Gamma})}=s(Id_{F(\Gamma)})=\delta(F(\Gamma))$$
%
This completes the proof of Lemma \ref{2015.09.03.l2}.  
\end{proof}
%
\subsection{The presheaf extension of a C-system}
\llabel{Fext}
%
Let $CC$ be a C-system and $F:CC^{op}\sr Sets$ a presheaf on the category
underlying $CC$. In this section we construct a new C-system $CC[F]$ which we
call the {\em $F$-extension of $CC$}, we describe a unital pre-B-system $B(CC,F)$, and we introduce
an isomorphism $B(CC[F])\sr B(CC,F)$.

We will first construct a C0-system $CC[F]$ and then show that it is a
C-system. For the definition of a C0-system see \cite[Definition
  2.1]{Csubsystems}.
%
\begin{problem}\llabel{2016.01.19.prob1}
Given a C-system $CC$ and a presheaf $F:CC^{op}\sr Sets$ to construct a
C0-system that will be denoted $CC[F]$ and called the {\em $F$-extension of $CC$}.
\end{problem}
%
\begin{construction}\rm\llabel{2016.01.19.constr1}
We set 
%
\begin{equation}\llabel{2016.01.19.eq1}
Ob(CC[F])=\amalg_{X\in CC} F(ft^{l(X)}(X))\times\dots\times F(ft^2(X))\times
F(ft(X)),
\end{equation}%
%
where the product of the empty sequence of factors is a 1-point set. We will
write elements of $Ob(CC[F])$ as $(X,\Gamma)$, where $X\in CC$ and
$\Gamma=(T_0,\dots,T_{l(X)-1})$. Note that $ft^{l(X)}(X)=pt$ for any $X$ and
therefore all the products in (\ref{2016.01.19.eq1}) start with $F(pt)$.

We set
%
$$Mor(CC[F])=\amalg_{(X,\Gamma),(Y,\Gamma')}Mor_{CC}(X,Y)$$
%
We will write elements of $Mor(CC[F])$ as $((X,\Gamma),(Y,\Gamma'),f)$. When
the domain and the codomain of a morphism are clear from the context we may
write $f$ instead of $((X,\Gamma),(Y,\Gamma'),f)$.

We define the composition function by the rule
%
$$((X,\Gamma),(Y,\Gamma'),f))\circ ((Y,\Gamma'),(Z,\Gamma''),g)=((X,\Gamma),(Z,\Gamma''),f\circ g)$$

We define the identity morphisms by the rule
%
$$Id_{CC[F],(X,\Gamma)}=((X,\Gamma),(X,\Gamma),Id_{CC,X})$$
%

The associativity and the identity conditions of a category follow easily from
the corresponding properties of $CC$. This completes the construction of a
category $CC[F]$.

We define the length function as
%
$$l((X,\Gamma))=l(X)$$

If $l((X,\Gamma))=0$, then $X=pt$ and $\Gamma=()$, where $()$ is the unique
element of the one point set that is the product of the empty sequence. We will
often write $(pt,())$ as $pt$.

We define the ft-function on $(X,\Gamma)$ such that $l(X)>0$ as 
%
$$ft((X,(T_0,\dots,T_{l(X)-1}))=(ft(X),(T_0,\dots,T_{l(X)-2})),$$
%
which is well defined because $l(ft(X))=l(X)-1$, and we set
$ft((pt,()))=(pt,())$. We will write $ft(\Gamma)$ for $(T_0,\dots,T_{l(X)-2})$
so that $ft((X,\Gamma))=(ft(X),ft(\Gamma))$.

We define the p-morphisms as 
%
$$p_{(X,\Gamma)}=((X,\Gamma),ft(X,\Gamma), p_X)$$

For $(Y,\Gamma')$ such that $l((Y,\Gamma'))>0$ and $f:(X,\Gamma)\sr ft(Y,\Gamma')$, where $\Gamma=(T_0,\dots,T_{l(X)-1})$ and $\Gamma'=(T_0',\dots,T_{l(Y)-1}')$ we set
%
\begin{equation}\llabel{2016.01.31.eq1}
f^*((Y,\Gamma'))=(f^*(Y),(T_0,\dots,T_{l(X)-1},F(f)(T'_{l(Y)-1}))).
\end{equation}%
%

In the same context as above we define the q-morphism as
%
$$q(f,(Y,\Gamma'))=(f^*((Y,\Gamma')),(Y,\Gamma'),q(f,Y))$$

This completes the construction of the elements of the structure of a C0-system. Let us verify that these elements satisfy the axioms of a C0-system. 

The uniqueness of an object of length $0$ is obvious.

The condition that $l(ft(X,\Gamma))=l((X,\Gamma))-1$ if $l((X,\Gamma))>0$ is obvious.

The condition that $ft((pt,()))=(pt,())$ is obvious. 

The fact that $pt$ is a final object in $CC[F]$ follows from the fact that $pt$ is a final object of $CC$.

The fact that for $(Y,\Gamma')$ such that $l((Y,\Gamma'))>0$ and
$f:(X,\Gamma)\sr ft(Y,\Gamma')$ one has $q(f,(Y,\Gamma'))\circ
p_{(Y,\Gamma')}=p_{f^*((Y,\Gamma'))}\circ f$ follows from the corresponding
fact in $CC$.

The fact that for $(Y,\Gamma')$ such that $l((Y,\Gamma'))>0$ one has
$Id_{ft(Y,\Gamma)}^*((Y,\Gamma'))=(Y,\Gamma')$ follows from the corresponding
fact for $CC$ and the identity axiom of the functor $F$.

The fact that for $(Y,\Gamma')$ such that $l((Y,\Gamma'))>0$ one has
$q(Id_{(Y,\Gamma)},(Y,\Gamma))=Id_{(Y,\Gamma)}$ follows from the previous
assertion and the corresponding fact in $CC$.

The fact that $(Y,\Gamma')$ such that $l((Y,\Gamma'))>0$, $f:(X,\Gamma)\sr
ft(Y,\Gamma')$ and $g:(W,\Delta)\sr (X,\Gamma)$ one has
$g^*(f^*((Y,\Gamma')))=(g\circ f)^*((Y,\Gamma'))$ follows from the composition
axiom for the functor $F$ and the corresponding fact for $CC$.

The fact that in the same context as in the previous assertion one has
%
$$q(g,f^*((Y,\Gamma')))\circ q(f,(Y,\Gamma'))=q((g\circ f),(Y,\Gamma'))$$
%
follows from the previous assertion and the corresponding fact for $CC$. 

This completes Construction \ref{2016.01.19.constr1}
\ec
%
\begin{lemma}
\llabel{2016.01.19.l2}
The functions $Ob(CC[F])\sr Ob(F)$ and $Mor(CC(F))\sr Mor(CC)$ given by 
%
$$(X,\Gamma)\mapsto X$$
%
and
%
$$((X,\Gamma),(Y,\Gamma'),f)\mapsto f$$
%
form a functor $tr_F:CC[F]\sr CC$ and this functor is fully faithful.
\end{lemma}
%
\begin{proof}
Straightforward from the construction.
\end{proof}
%
\begin{lemma}\llabel{2016.01.19.l1}
The C0-system of Construction \ref{2016.01.19.constr1} is a C-system.
\end{lemma}
%
\begin{proof}
By \cite[Proposition 2.4]{Csubsystems} it is sufficient to prove that the
canonical squares of $CC[F]$, i.e., the squares formed by morphisms
$q(f,(Y,\Gamma')),p_{(Y,\Gamma')}$ and $p_{f^*((Y,\Gamma'))}, f$ are pull-back
squares. The functor of Lemma \ref{2016.01.19.l2} map these square to canonical
squares of the C-system $CC$ that are pull-back squares. Since this functor is
fully faithful we conclude that the canonical squares in $CC[F]$ are pull-back
squares. The lemma is proved.
\end{proof}

This completes the construction of the presheaf extension of a C-system. 
%
\begin{remark}\rm
\llabel{2015.09.01.rem1}
For any two objects of $C[F]$ of the form $(X,\Gamma),(X,\Gamma')$ the formula
%
$$can_{X,\Gamma,\Gamma'}=((X,\Gamma),(X,\Gamma'),Id_X)$$
%
defines a morphism which is clearly an isomorphism with
$can_{X,\Gamma',\Gamma}$ being a canonical inverse. Therefore, all objects of
$CC[F]$ with the same image in $CC$ are ``canonically isomorphic''.
\end{remark}
%
\begin{remark}\rm
\llabel{2015.09.01.rem2}
If $F(pt)=\emptyset$, then $CC[F]=\{pt\}$. On the other hand, the choice of an
element $y$ in $F(pt)$ defines distinguished elements $y_X=F(\pi_X)(y)$ in all
sets $F(X)$ and therefore distinguished objects
$(X,\Gamma_{X,y})=(X,(y,\dots,y_{ft^2(X)},y_{ft(X)}))$ in the fibers of the
object component of $tr_{F}$ over all $X$.

Mapping $X$ to $(X,\Gamma_{X,y})$ and $f:X\sr Y$ to
$((X,\Gamma_{X,y}),(Y,\Gamma_{Y,y}),f)$ defines, as one can immediately prove
from the definitions, a functor $tr_{F,y}^!:CC\sr CC[F]$.

This functor clearly satisfies the conditions $tr^!_{F,y}\circ tr_F=Id_{CC}$.

One verifies easily that the morphisms 
%
$$can_{X,\Gamma,\Gamma_{(X,y)}}:(X,\Gamma)\sr tr^!_{F,y}(X,\Gamma)$$
%
form a natural transformation. We conclude that $tr_F$ and $tr^!_{F,y}$ is a
pair of mutually inverse equivalences of categories.

However these equivalences are not isomorphisms unless $F(X)\cong unit$ for all
$X$ and as a C-system $CC[F]$ is often very different from $CC$, for example,
in that that it may have many more C-subsystems.
\end{remark}
%
We provide the following lemma without a proof, because the proof is immediate
from the definitions and \cite[Lemma 3.4]{Cfromauniverse} that asserts that a
functor that satisfies all conditions of the definition of a homomorphism
except possibly the s-morphisms condition is a homomorphism.
%
\begin{lemma}
\llabel{2015.08.22.l4}
The functor $tr:CC[F]\sr CC$ is a homomorphism of C-systems.
\end{lemma}
%
\begin{remark}\rm
\llabel{2015.08.22.rem1} 
Let $y\in F(pt)$. Then for $f:X\sr Y$ one has $F(f)(y_{Y})=y_X$ and therefore for $f:X\sr ft(Y)$ one has
%
$$(tr^!_{y}(f))^*(Y)=(f^*(Y),\Gamma_{f^*(Y),y})=f^*((Y,\Gamma_Y))=tr^!_y(f)^*(tr_y(Y))$$
%
The rest of the conditions that one needs to prove in order to show that $tr_y$
is a homomorphism of C-systems is immediate from definitions and we obtain that
%
$$tr^!_y:CC\sr CC[F]$$
%
is a homomorphism of C-systems.  
\end{remark}
%

Recall that by definition $(X,\Gamma)\le (Y,\Gamma')$ if and only if $l(X,\Gamma)\le l(Y,\Gamma')$ and 
%
$$(X,\Gamma)=ft^{l(Y,\Gamma')-l(X,\Gamma)}(Y,\Gamma').$$
%
From construction we conclude that $(X,\Gamma)\le (Y,\Gamma')$ if and only if $X\le Y$ in $CC$ and 
%
$$(X,\Gamma)=ft^{l(Y)-l(X)}((Y,\Gamma')).$$ 
%
\begin{lemma}
\llabel{2016.01.31.l1} 
Let $i\ge 0$, $(Y,\Gamma')$ be such that $l(Y)\ge
i$. Let $f:(X,\Gamma)\sr ft^i(Y,\Gamma')$. Let $lx=l(X)$, $ly=l(Y)$ and
%
$$\Gamma=(T_0,\dots,T_{lx-1})$$
$$\Gamma'=(T'_0,\dots,T'_{ly-1})$$
%
Then
%
\begin{equation*}
  \begin{split}
    f^*((Y,\Gamma'),i)=(f^*(Y,i),(T_0,&\dots,T_{lx-1},
    \\&
    F(q(f,ft^i(Y),0))(T'_{ly-i}),\dots,
    \\&
    F(q(f,ft(Y),i-1))(T'_{ly-1}))
  \end{split}
\end{equation*}
%
\end{lemma}
%
\begin{proof}
By induction on $i$.

For $i=0$ we have 
%
$$f^*((Y,\Gamma'),0)=(X,\Gamma)=(f^*(Y,0),(T_0,\dots,T_{lx-1}))$$
%
For the successor of $i$ we need to show that
%
\begin{equation}\llabel{2016.01.31.eq3}
  \begin{split}
    f^*((Y,\Gamma'),i+1)=(f^*(Y,i+1),(T_0,&\dots,T_{lx-1},
    \\
    &
    F(q(f,ft^{i+1}(Y),0))(T'_{ly-i-1}),\dots,
    \\
    &
    F(q(f,ft(Y),i))(T'_{ly-1})))
  \end{split}
\end{equation}%
EDITOR: check parentheses in the equation above.
%
We have by (\ref{2016.01.31.eq2}),  
%
$$f^*((Y,\Gamma'),i+1)=q(f,ft((Y,\Gamma')),i)^*((Y,\Gamma'))$$
%
By the inductive assumption, $q(f,ft((Y,\Gamma')),i)$ is a morphism with the domain
%
\begin{equation*}
  \begin{split}
    f^*&(ft(Y,\Gamma'),i)
    \\&=
    (f^*(ft(Y),i),
    \\&
       \spc\spc\spc\spc (T_0,\dots,T_{lx-1},
    \\&
          \spc\spc\spc\spc\spc\spc F(q(f,ft^{i}(ft(Y)),0))(T'_{ly-1-i}),\dots,
    \\&
          \spc\spc\spc\spc\spc\spc F(q(f,ft(ft(Y))),i-1)(T'_{ly-2})
          ))
  \end{split}
\end{equation*}
%
By (\ref{2016.01.31.eq1}) we get
%
\begin{equation*}
  \begin{split}
    q(f,&ft((Y,\Gamma')),i)^*((Y,\Gamma'))
    \\&=
    (q(f,ft(Y),i)^*(Y),
    \\&
    \spc\spc\spc (T_0,\dots,T_{lx-1},
    \\&
    \spc\spc\spc\spc\spc\spc F(q(f,ft^{i}(ft(Y)),0))(T'_{ly-1-i}),\dots,
    \\&
    \spc\spc\spc\spc\spc\spc F(q(f,ft(ft(Y))),i-1)(T'_{ly-2}),
    \\&
    \spc\spc\spc\spc\spc\spc F(q(f,ft(Y),i))(T'_{ly-1})))
  \end{split}
\end{equation*}
%
which coincides with our goal (\ref{2016.01.31.eq3}). 
\end{proof}
%
%##

\comment{
\begin{lemma}
\llabel{2015.08.26.l7} 
Let $(Y,\Gamma')\ge (W,\Delta)$, where
$\Gamma'=(T'_0,\dots,T'_{l(Y)-1})$ and let $f:(X,\Gamma)\sr (W,\Delta)$ be a
morphism where $\Gamma=(T_0,\dots,T_{l(X)-1})$. Then one has
%
$$f^*((Y,\Gamma'))=(f^*(Y),(T_0,\dots,T_{l(X)-1},F(q(f,ft^{n'-n}(Y)))(T'_n),\dots,F(q(f,Y))(T'_{n'-1})))$$
%
\end{lemma}
%
\begin{proof}
Let $n=l(W)$ and let $i=n'-n$. Then $(W,\Delta)=ft^i((Y,\Gamma'))$, i.e.,
$W=ft^i(Y)$, $\Delta=(T'_0,\dots,T'_{n-1})$ and
$\Gamma'=(T'_0,\dots,T'_{n-1+i})$. By definition
$f^*((Y,\Gamma'))=f^*((Y,\Gamma'),i)$.

The proof is by induction on $i$ after replacing $n'$ with $n+i$. 

For $i=0$ we have $f^*((Y,\Gamma'),0)=(X,\Gamma)$.

For the successor $i+1$ we have, by (\ref{2016.01.31.eq2}),  
%
$$f^*((Y,\Gamma'),i+1)=q(f,ft((Y,\Gamma')),i)^*((Y,\Gamma'))$$
%
where, by the inductive assumption, $q(f,ft((Y,\Gamma')),i)$ is a morphism with the domain
%
$$f^*(ft(Y,\Gamma'),i)=(f^*(ft(Y)),(T_0,\dots,T_{m-1},F(q(f,ft^{i+1}(Y)))(T'_n),\dots,F(q(f,ft(Y)))(T'_{n-1+i})))$$
%
and by (\ref{2016.01.31.eq1}) we have
%
\begin{equation*}
  \begin{split}
    q(f,ft((Y,\Gamma')),i)^*((Y,\Gamma'))
    \\&=
    (q(f,ft(Y),i)^*(Y),(T_0,\dots,T_{m-1},F(q(f,ft^{i+1}(Y)))(T'_n),\dots,F(q(f,ft(Y)))(T'_{n-2+i}), F(q(q(f,ft((Y)),i),Y))(T'_{n+i}))
    \\&=
    (q(f,ft(Y),i)^*(Y),(T_0,\dots,T_{m-1},F(q(f,ft^{i+1}(Y)))(T'_n),\dots,F(q(f,ft(Y)))(T'_{n-2+i}), F(q(f,Y,i),i))(T'_{n+i}))
  \end{split}
\end{equation*}
%
\end{proof}
}

\section{???}

\subsection{Some computations with $Jf$-relative monads}
%
\llabel{Jfrel}
%

For two sets $X$ and $Y$ we let $Fun(X,Y)$ to denote the set of functions from
$X$ to $Y$.

Next, following \cite{FPT} we let $\FF$ denote the category with the set of
objects $\nat$ and the set of morphisms from $m$ to $n$ being
$Fun(stn(m),stn(n))$, where $stn(m)=\{i\in\nat\,|\,i<m\}$ is our choice for the
standard set with $m$ elements (cf.{} \cite{LandC}) and where for two sets $X$
and $Y$, $Fun(X,Y)$ is the set of functions from $X$ to $Y$ defined as in
\cite[p.~81]{Bourbaki.Sets} such that each function has a well defined domain
and codomain.

For any set $U$ there is a category $Sets(U)$ of the following form. The set of
objects of $Sets(U)$ is $U$. The set of morphisms is
%
$$Mor(Sets(U))=\cup_{X,Y\in U}Fun(X,Y)$$
%
Since a function from $X$ to $Y$ is defined as a triple $(X,Y,G)$, where $G$ is
the graph subset of this function the domain and codomain functions are well
defined on $Mor(Sets(U))$ such that
%
$$Mor_{Sets(U)}(X,Y)=Fun(X,Y)$$
%
and a composition function can be defined that restricts to the composition of
functions function on each $Mor_{Sets(U)}(X,Y)$. Finally the identity function
$U\sr Mor(Sets(U))$ is obvious and the collection of data that one obtains
satisfies the axioms of a category.  This category is called the {\em category of
sets in $U$} and is denoted by $Sets(U)$.

We will consider only the case when $U$ is a universe. As was mentioned in the
introduction we fix $U$ and omit it from our notations below.

Following \cite{ACU} we let $Jf:F\sr Sets$ denote the functor that takes $n$ to
$stn(n)$ and that is the identity on morphisms between two objects (on the
total sets of morphisms the morphism component of this functor is the inclusion
of a subset).

As the following construction shows any monad on sets defines a $Jf$-relative
monad. Combined with our construction of $C(\RR)$ this gives a construction of
a C-system for any monad on sets.

\begin{problem}\llabel{2016.01.13.prob1}
Given a monad ${\bf R}=(R,\eta,\mu)$ (cf.{} \cite{MacLane}[p.~133]) on the
category of sets to construct a $Jf$-relative monad $\RR$.
\end{problem}
%
\begin{construction}\rm\llabel{2016.01.13.constr1}
We set 
%
\begin{enumerate}
\item $R(n)=R(stn(n))$,
\item $\eta_n=\eta_{stn(n)}$,
\item for $f:stn(m)\sr R(n)$ we set $\mbind{f}=R(f)\circ \mu_{stn(n)}$.
\end{enumerate}
%
The verification of the relative monad axioms is easy.
\ec
%
\begin{remark}\rm\llabel{2016.01.03.rem1}
It seems to be possible to provide a construction of a monad from a
$Jf$-relative monad without the use of the axioms of choice and excluded
middle. This construction will be considered in a separate note.
\end{remark}
%
\begin{remark}\rm\llabel{2016.01.17.rem1}
The set of $Jf$-relative monads is in an easy to construct bijection with the
set of abstract clones as defined in \cite[Section 3]{FPT}.
\end{remark}

In \cite{LandJf} we constructed for any $Jf$-relative monad
$\RR=(RR,\eta,\mbind{-})$ a Lawvere theory $(T,L)=RML(\RR)$. Most of this
section is occupied by simple computations in $T$ that will be used in the
later sections.

Recall that the category $T$ has as the set of objects the set of natural numbers and as the set of morphisms the set 
%
$$Mot_T=\amalg_{m,n} Fun(stn(m),RR(n))$$
%
Therefore the set of morphisms in $T$ from $m$ to $n$ is the set of iterated
pairs $((m,n),f)$, where $f\in Fun(stn(m),RR(n))$. We fix the obvious bijection
between this set and $Fun(stn(m),RR(n))$ and use the corresponding functions in
both directions as coercions. A coercion, in the terminology of the proof
assistant {\em Coq}, is a function $f:X\sr Y$ such that when an expression denoting
an element $x$ of the set $X$ occurs in a position where an element of $Y$
should be it is assumed that $x$ is replaced by $f(x)$.

Let us introduce the following notation:
%
$$F(m,n)=Fun(stn(m),stn(n))$$
%
and, for a $Jf$-relative monad $\RR$,
%
$$RR(m,n)=Fun(stn(m),RR(n))$$
%
Then for $f\in RR(l,m)$ and $g\in RR(m,n)$ the composition $f\hc g$ in $T$ is
defined as $\mbind{f}\circ g$ and for $m\in\nat$ the identity morphism $Id_m$
in $T$ is defined as $\eta_{m}$.

The functor $L:F\sr T$ is defined as the identity on objects and as the
function on morphisms corresponding to the functions $f\mapsto f\circ \eta_{n}$
from $F(m,n)$ to $RR(m,n)$.

We also obtain the extension of $RR$ to a functor $F\sr Sets$ according to
Construction \ref{2016.01.15.constr1}. For a morphism $f\in F(m,n)$ we have
$RR(f)=\mbind{(f\circ \eta_{n})}=\mbind{L(f)}$.

We are going to use the functions $f\mapsto RR(f)$ as coercions so that when an
element $f$ of $F(m,n)$ occurs in a position where an element of
$Fun(RR(m),RR(n))$ is expected it has to be replaced by $RR(f)$.

\comment{Similarly, we will use the functions $\mbind{m}$ as a coercions so
  that when an element $g$ of $RR(m,n)$ occurs in a position where a function
  from $RR(m)$ to $RR(n)$ is expected it has to be replaced by $\mbind{g}$. }
%
\begin{remark}\rm
\llabel{2015.11.20.rem4} 
We can not replace $\amalg$ by $\cup$ in our
definition of the set of morphisms of $T$, because for a general $\RR$ the sets
$RR(m,n)$ are not disjoint.  For example, if $RR(m)=pt$, where $pt$ is a fixed
one element set, then $RR$ has a (unique) structure of a $Jf$-relative monad and
$RR(m,n)=RR(m,n')$ for all $m,n,n'$. Therefore no function to $\nat$ from the
union of these sets can distinguish the codomain of a morphism. In particular,
in this case there is no category with the sets of morphisms from $m$ to $n$
being equal to $RR(m,n)$.
\end{remark}
%
Since we will have to deal with elements of the sets of functions
$Fun(stn(m),RR(n))$ and of similar sets, such as the sets $Ob_n(C(\RR,\LM))$
introduced later, we need to choose some way to represent them. For the purpose
of the present paper we will write such elements as sequences, i.e., to denote
the function, which in the notation of $\lambda$-calculus is written as
$\lambda\,i:stn(n), f_i$, we will write $(f_0,\dots,f_{n-1})$. In particular,
for an element $x$ of a set $X$, the expression $(x)$ denotes the function
$stn(1)\sr X$ that takes $0$ to $x$.
%
\begin{lemma}
\llabel{2016.01.15.l4} 
Let $f=(f(0),\dots,f(l-1))$ be a morphism in $T$ from
$l$ to $m$ and $g=(g(0),\dots,g(m-1))$ a morphism from $m$ to $n$. Then one has
%
$$f\hc g=(\mbind{g}(f(0)),\dots,\mbind{g}(f(l-1)))$$
%
\end{lemma}
%
\begin{proof}
We have
%
$$(f\hc g)(i)=(f\circ\mbind{g})(i)=\mbind{g}(f(i)).$$
%
The lemma is proved. 
\end{proof}
%
\begin{lemma}
\llabel{2015.08.30.l1}
Let $f\in F(l,m)$, $g\in RR(m,n)$ and $i\in stn(l)$. Then one has
%
\begin{equation}\llabel{2015.08.26.eq4}
(L(f)\hc g)(i)=g(f(i))
\end{equation}%
% 
\end{lemma}
%
\begin{proof}
Rewriting the left hand side we get 
%
$$(L(f)\hc g)(i)=((f\circ \eta_{m})\circ \mbind{g})(i)=(f\circ (\eta_{m}\circ \mbind{g}))(i)=(f\circ g)(i)=g(f(i)).$$
%
which completes the proof. 
\end{proof}
%
For $n\in\nat$ and $i=0,\dots,n-1$ let
%
$$x_i^n=\eta_{n}(i)\in RR(n)$$
%
Observe also that for $f\in RR(m,n)$ one has
%
\begin{equation}\llabel{2015.08.24.eq5}
\mbind{f}(x_i^m)=(\eta_{m}\circ\mbind{f})(i)=f(i)
\end{equation}%
%
and for $f\in F(m,n)$ one has
%
\begin{equation}\llabel{2016.01.15.eq1}
f(x_i^m)=RR(f)(\eta_{m}(i))=(\eta_{m}\circ \mbind{(f\circ \eta_{n}))}(i)=(f\circ \eta_{n})(i)=\eta_{n}(f(i))=x_{f(i)}^n
\end{equation}%
%
Let 
%
$$\partial^{i}_{n}:stn(n)\sr stn(n+1)$$
%
for $0\le i\le n$ be the increasing inclusion that does not take the value $i$ and
%
$$\sigma^{i}_{n}:stn(n+2)\sr stn(n+1)$$
%
for $0\le i\le n$ be the non-decreasing surjection that takes the value $i$
twice. Taking into account that, in the notation of \cite{GabZis},
$[n]=stn(n+1)$ these are the standard generators of the simplicial category
$\Delta$ together with $\partial^0_0:stn(0)\sr stn(1)$.

In our sequence notation we have
%
\begin{equation}\llabel{2015.08.24.eq7}
L(\partial^{i}_{n})=(x_0^{n+1},\dots,x_{i-1}^{n+1},x_{i+1}^{n+1},\dots,x_n^{n+1})
\end{equation}%
%
and
%
\begin{equation}\llabel{2015.08.24.eq8}
L(\sigma^{i}_{n})=(x_0^{n+1},\dots,x_{i-1}^{n+1},x_i^{n+1},x_i^{n+1},x_{i+1}^{n+1},\dots,x_n^{n+1})
\end{equation}%
%
in particular
%
\begin{equation}\llabel{2015.07.12.eq5}
L(\partial^{n}_n)=(x_0^{n+1},\dots,x_{n-1}^{n+1})
\end{equation}%
%

Let 
%
$${\iota}_n^{i}:stn(n)\sr stn(n+i)$$
%
be the function given by ${\iota}_n^i(j)=j$ for $j=0,\dots,n-1$. Then we have
%
\begin{equation}
\llabel{2015.08.22.eq7}
{\iota}_n^{1}=\partial_{n}^{n}
\end{equation}%
%
and (\ref{2016.01.15.eq1}) implies that 
%
\begin{equation}
\llabel{2015.08.22.eq8}
{\iota}_n^i(x^n_j)=x^{n+i}_j
\end{equation}%
%
\begin{lemma}
\llabel{2015.08.26.l1}
Let $f=(f(0),\dots,f(m))$ be a morphism from $m+1$ to $n$ in $T$. Then
%
\begin{equation}\llabel{2016.01.15.eq3}
L(\iota_m^1)\hc f=(f(0),\dots,f(m-1))
\end{equation}%
%
In particular, if $f\in RR(n+1,n)$, then $L(\iota_n^1)\hc f=Id_{T,n}$ if and only if $f(i)=x_n^i$ for $i=0,\dots,n-1$. 
\end{lemma}
%
\begin{proof}
Both sides of the required equality are elements of
$Fun(stn(m),RR(n))$. Therefore, the equality holds if and only if for all
$i=0,\dots,n-1$ we have $(L(\iota_m^1)\hc f)(i)=f(i)$. The assertion of the
lemma follows now from Lemma \ref{2015.08.30.l1}.

Since $Id_{T,n}=(x_0^n,\dots,x_{n-1}^n)$ the second assertion immediately follows from the first one.
\end{proof}
%
For $f\in RR(n,m)$, $f=(f(0),\dots,f(n-1))$ define an element $qq(f)\in RR(n+1,m+1)$ by the formula: 
%
\begin{equation}\llabel{2015.08.26.eq9}
qq(f)=(\iota_m^1(f(0)),\dots,\iota_m^1(f(n-1)),x_m^{m+1})
\end{equation}%
%
\begin{lemma}
\llabel{2015.08.26.l2}
For $i\in\nat$ and $f=(f(0),\dots,f(n-1))$ in $RR(n,m)$ one has
%
$$qq^i(f)=(\iota_m^i(f(0)),\dots,\iota_m^i(f(n-1)),x_m^{m+i},\dots,x_{m+i-1}^{m+i})$$
%
\end{lemma}
%
\begin{proof}
Straightforward by induction on $i$.
\end{proof}
%
\begin{lemma}
\llabel{2015.08.26.l3a}
For $n,i\in\nat$ one has
%
$$qq^i(L(\iota_n^1))=L(\partial^n_{n+i})$$
%
\end{lemma}
%
\begin{proof}
We have ${L}(\iota_n^1)=L(\partial_n^n)=(x_0^{n+1},\dots,x^{n+1}_{n-1})$. By
Lemma \ref{2015.08.26.l2} and (\ref{2015.08.22.eq8}) we get
%
$$qq^i({L}(\iota_n^1))=(\iota_{n+1}^i(x_0^{n+1}),\dots,\iota_{n+1}^i(x_{n-1}^{n+1}),x_{n+1}^{n+1+i},\dots,x_{n+i}^{n+1+i})=$$
$$=(x_0^{n+1+i},\dots,x_{n-1}^{n+1+i},x_{n+1}^{n+1+i},\dots,x_{n+i}^{n+1+i})={L}(\partial_n^{n+i}),$$
%
where the last equality is (\ref{2015.08.24.eq7}). 
\end{proof}
%
\begin{lemma}
\llabel{2015.08.28.l1}
For $i,m\in\nat$ and $r\in RR(m)$ one has
%
$$qq^i(x_0^m,\dots,x^m_{m-1},r)=(x_0^{m+i},\dots,x^{m+i}_{m-1},\iota_m^i(r),x_m^{m+i},\dots,x_{m+i-1}^{m+i})$$
%
\end{lemma}
%
\begin{proof}
One has
%
$$qq^i(x_0^m,\dots,x^m_{m-1},r)=(\iota_m^i(x_0^m),\dots,\iota_m^i(x^m_{m-1}),\iota_m^i(r),x_m^{m+i},\dots,x_{m+i-1}^{m+i})=$$
$$(x_0^{m+i},\dots,x^{m+i}_{m-1},\iota_m^i(r),x_m^{m+i},\dots,x_{m+i-1}^{m+i}),$$
%
where the first equality is by Lemma \ref{2015.08.26.l2} and the second one by
(\ref{2015.08.22.eq8}).
\end{proof}
%

\subsection{The C-system $C(\RR)$}
%
\llabel{CRR}

In \cite{LandC} we constructed for any Lawvere theory $(T,L)$ a C-system
$LC((T,L))$. For $(T,L)=RML(\RR)$ we denote the C-system $LC((T,L))$ by
$C(\RR)$. In this section we first provide a more explicit description of
$C(\RR)$ and then compute the action of the operations $T,\wt{T},S,\wt{S}$ and
$\delta$ on the B-sets $(Ob(C(\RR)),\wt{Ob}(C(\RR)))$ of this C-system
(cf.{} Definition \ref{2015.08.26.def1}).

Recall that as a category $C(\RR)$ is the opposite category to $T$.  Its set of
objects is the set of natural numbers $\nat$. To distinguish the positions in
formulas where natural numbers are used as objects of $C(\RR)$ we will write in
such places $\wh{m}$ instead of $m$, $\wh{n}$ instead of $n$ etc.

The sets of morphisms of $C(\RR)$ are given by the formula 
%
$$Mor_{C(\RR)}(\wh{m},\wh{n})=\{((n,m),f)\,|\,f\in Fun(stn(n),RR(m))\}$$
%
and we apply to them the same convention as to morphisms of $T$, that is, we
identify the sets $Mor_{C(\RR)}(\wh{m},\wh{n})$ with the sets
$Fun(stn(n),RR(m))$ by means of the obvious bijection.

We consider $L$ as a functor
%
$${L}:F^{op}\sr C(\RR)$$
%
i.e., as a contravariant functor from $F$ to $C(\RR)$, and we keep the conventions
introduced in the previous section, the most important of which is that for
$f\in F(m,n)$ and $x\in RR(m)$ we may write $f(x)$ for 
$RR(f)(x)=\mbind{(f\circ \eta_{n})}(x)$.

The $ft$ function on $C(\RR)$ is defined by the formula $ft(\wh{n+1})=\wh{n}$
and $ft(\wh{0})=\wh{0}$.

The $p$-morphisms are defined by setting $p_{\wh{0}}=Id_{\wh{0}}$ and
$p_{\wh{n+1}}:\wh{n+1}\sr \wh{n}$ to be the morphism $L(\iota_n^1)$. In the
sequence notation we have
%
\begin{equation}\llabel{2015.08.24.eq6}
p_{\wh{n+1}}=(x_0^{n+1},\dots,x_{n-1}^{n+1})
\end{equation}%
%
For a morphism $f:\wh{m}\sr \wh{n}$ in $C(\RR)$ we have $f^*(\wh{n+1})=\wh{m+1}$. 

Before giving an explicit description of $q$-morphisms we will prove the
following lemma.
%
\begin{lemma}
\llabel{2015.07.24.l1}
One has:
%
\begin{enumerate}
\item Let $f=(f(0),\dots,f(n))$ be a morphism $\wh{m+1}\sr\wh{n+1}$. Then 
%
$$f\circ_C p_{\wh{n+1}}=(f(0),\dots,f(n-1))$$
%
\item Let $f=(f(0),\dots,f(n-1))$ be a morphism $\wh{m}\sr \wh{n}$. Then 
%
$$p_{\wh{m+1}}\circ_C f=(\iota_m^1(f(0)),\dots,\iota_m^1(f(n-1)))$$
%
\end{enumerate}
\end{lemma}
%
\begin{proof}
Both sides of the first equality are elements of $Fun(stn(n), RR(m+1))$, and for $i\in stn(n)$ we have
%
$$(f\circ_C p_{\wh{n+1}})(i)=(L(\iota_{n}^1)\circ_T f)(i)=f(i),$$
%
where the second equality is by (\ref{2015.08.26.eq4}). 

Both sides of the second equality are elements of $Fun(stn(n), RR(m+1))$,
and for $i\in stn(n)$ we have the following equations.
%
$$(p_{\wh{m+1}}\circ_C f)(i)=(f\circ_T L(\iota_{m}^1))(i)=(f\circ \mbind{(L(\iota_{m}^1))})(i)=(f\circ RR(\iota_{m}^1))(i)=\iota_{m}^1(f(i))$$
%
\end{proof}
%
The $q$-morphisms were defined in \cite{LandC} in a somewhat implicit
manner. We give their explicit description in the following lemma.
%
\begin{lemma}
\llabel{2016.01.15.l3}
Let $f:\wh{m}\sr \wh{n}$ be a morphism in $C(\RR)$. Then one has
%
$$q(f,\wh{n+1})=qq(f)$$
%
\end{lemma}
%
\begin{proof}
The morphism $q(f)=q(f,\wh{n+1})$ was defined in \cite{LandC} as the unique
morphism such that
%
$$q(f)\circ_C p_{\wh{n+1}}=p_{\wh{m+1}}\circ_C f$$
%
and
%
$$q(f)\circ_C (x_n^{n+1})=(x_m^{m+1})$$
%
For the first equation we have
%
$$qq(f)\circ_C p_{\wh{n+1}}=(\iota_m^1(f(0)),\dots,\iota_m^1(f(n-1)))$$
%
by Lemma \ref{2015.07.24.l1}(1) and (\ref{2015.08.26.eq9}) and
%
$$p_{\wh{m+1}}\circ_C f = (\iota_m^1(f(0)),\dots,\iota_m^1(f(n-1)))$$
%
by Lemma \ref{2015.07.24.l1}(2).

Both sides of the second equation are elements of $Fun(stn(1),RR(m+1))$, and it
is sufficient that their values on $0$ coincide. We have
%
\begin{equation*}
  \begin{split}
    (q(f)\circ_C (x_n^{n+1}))(0)&=((x_n^{n+1})\circ_T qq(f))(0)=((x_n^{n+1})\circ \mbind{qq(f)})
    \\
    &= \mbind{qq(f)}(x_n^{n+1})=qq(f)(n)=x_m^{m+1},
  \end{split}
\end{equation*}
%
where the fourth equality is by (\ref{2015.08.24.eq5}) and the fifth by
(\ref{2015.08.26.eq9}). This completes the proof of Lemma \ref{2016.01.15.l3}.
\end{proof}

%
Let us describe the constructions introduced in Section \ref{onCsystems} in the
case of $C(\RR)$. Note that our wide-hat notation, which distinguishes the places
in formulas where natural numbers are used as objects of $C(\RR)$, allows us to
avoid the ambiguity that might have arisen otherwise. For example, $p_{m,n}$
could be understood either as the canonical morphism $m\sr n$ using the
notation $p_{\Gamma',\Gamma}$ introduced in Section \ref{onCsystems} or as the
canonical morphism $m\sr m-n$ using the notation $p_{\Gamma,i}$, which we have
used in \cite{Csubsystems}.  The use of the wide-hat diacritic allows to
distinguish between $p_{\wh{m},\wh{n}}$, a morphism $\wh{m}\sr \wh{n}$, and
$p_{\wh{m},n}$, a morphism $\wh{m}\sr \wh{m-n}$.
%
\begin{lemma}
\llabel{2015.08.22.l6}
Let $n,i\in\nat$. 
%
\begin{enumerate}
\item One has
%
\begin{enumerate}
\item $p_{\wh{n+i},i}=L(\iota^{n+i}_{n})=(x_0^{n+i},\dots,x_{n-1}^{n+i})$,
\item for $m\in\nat$ and $g=(g(0),\dots,g(n+i-1))$ from $\wh{m}$ to $\wh{n+i}$ one has 
%
$$g\circ p_{\wh{n+i},i}=(g(0),\dots,g(n-1)),$$
%
\end{enumerate}
%
\item for $f:\wh{m}\sr \wh{n}$ one has
%
$$f^*(\wh{n+i},i)=m+i$$
%
and
%
$$q(f,\wh{n+i},i)=qq^i(f)$$
%
\end{enumerate}
\end{lemma}
%
\begin{proof}
All three assertions a proved by induction on $i$. For the first assertion both
parts are proved by induction simultaneously. One has
%
\begin{enumerate}
\item in the case $i=0$ the first assertion follows from the identity axiom of
  the functor defined by $\RR$ as in Construction \ref{2016.01.15.constr1} and
  second from the identity axiom of the category $C(\RR)$,
\item for the successor of $i$ we have
%
$$p_{\wh{n+i+1},i+1}=p_{\wh{n+i+1}}\circ p_{\wh{n+i},i}=(x_0^{n+i+1},\dots,x_{n-1}^{n+i+1}),$$
%
where the second equality is by the second part of the inductive
assumption. For the inductive step in the second part we have
%
\begin{equation*}
  \begin{split}
    (g(0),\dots,g(n+i))\circ p_{\wh{n+i+1},i+1}&=(g(0),\dots,g(n+i))\circ p_{\wh{n+i+1}}\circ p_{\wh{n+i},i}
    \\&=
    (g(0),\dots,g(n+i-1))\circ p_{\wh{n+i},i}
    \\&=
    (g(0),\dots,g(n-1))
  \end{split}
\end{equation*}
%
\end{enumerate}
%
The proof of the first part of the second assertion is obvious. For the second
part we have:
%
\begin{enumerate}
\item for $i=0$ the assertion is obvious,
\item for the successor of $i$ we have 
%
$$q(f,\wh{n+i+1},i+1)=qq(q(f,\wh{n+i},i))=qq(qq^i(f))=qq^{i+1}(f)$$
%
\end{enumerate}
%
\end{proof}
%
\begin{lemma}
\llabel{2015.08.22.l7}
Let $f=(f(0),\dots,f(n))$ be a morphism from $\wh{n}$ to $\wh{n+1}$. Then
$f\circ p_{\wh{n+1}}=Id_{\wh{n}}$ if and only if $f(i)=x_i^{n}$ for
$i=0,\dots,n-1$.
\end{lemma}
%
\begin{proof}
It follows immediately from Lemma \ref{2015.08.26.l1}.
\end{proof}
%
\begin{lemma}
\llabel{2015.09.09.l1}
Let $f=(f(0),\dots,f(n-1))$ be a morphism from $\wh{m}$ to $\wh{n}$, where $n>0$. Then one has
%
$$s_f=(x_0^{m},\dots,x_{m-1}^{m},f(n-1))$$
%
\end{lemma}
%
\begin{proof}
By \cite[Definition 2.3(2)]{Csubsystems} we have that 
%
$$s_f\circ p_{\wh{m+1}}=Id_{\wh{m}}$$
%
Therefore, by Lemma \ref{2015.08.22.l7}, $s_f$ is of the form
$(x_0^m,\dots,x_{m-1}^m,sf)$ for some $sf\in RR(m)$. By \cite[Definition
  2.3(3)]{Csubsystems} we have $f=s_f\circ q(ft(f),\wh{n})$, where $ft(f)=f\circ
p_{\wh{n}}$. By Lemma \ref{2015.07.24.l1}(1) we have
$ft(f)=(f(0),\dots,f(n-2))$ and by Lemma \ref{2016.01.15.l3} and
(\ref{2015.08.26.eq9}) we have
%
$$q(ft(f),\wh{n})=qq(ft(f))=(\iota_m^1(f(0)),\dots,\iota_m^1(f(n-2)),x_{m}^{m+1})$$
%
Therefore we should have
%
$$(f(0),\dots,f(n-1))=(\iota_m^1(f(0)),\dots,\iota_m^1(f(n-2)),x_{m}^{m+1})\hc (x_0^m,\dots,x_{m-1}^m,sf)$$
%
which is equivalent to, by Lemma \ref{2016.01.15.l4}, 
%
\begin{equation}\llabel{2016.01.15.eq6}
f(i)=\mbind{(x_0^m,\dots,x_{m-1}^m,sf)}(\iota_m^1(f(i)))
\end{equation}%
%
for $i=0,\dots,n-2$ and 
%
\begin{equation}\llabel{2016.01.15.eq7}
f(n-1)=\mbind{(x_0^m,\dots,x_{m-1}^m,sf)}(x_{m}^{m+1})
\end{equation}%
%
For the first series of equalities we get, by inserting the coercion $RR$ and
rewriting of the right hand side, the following
%
\begin{equation*}
  \begin{split}
    \mbind{(x_0^m,\dots,x_{m-1}^m,sf)}(\iota_m^1(f(i)))
    &=
    (\mbind{(L(\iota_m^1))}\circ \mbind{(x_0^m,\dots,x_{m-1}^m,sf)})(f(i))
    \\&=
    \mbind{(L(\iota_m^1)\circ \mbind{(x_0^m,\dots,x_{m-1}^m,sf)})}(f(i))
    \\&=
    \mbind{(L(\iota_m^1)\hc (x_0^m,\dots,x_{m-1}^m,sf))}(f(i))
    \\&=
    \mbind{(x_0^m,\dots,x_{m-1}^m)}(f(i))=\mbind{\eta_{m}}(f(i))
    \\&=
    Id_{RR(m)}(f(i))=f(i),
  \end{split}
\end{equation*}
%
where the fourth equality is by (\ref{2016.01.15.eq3}). 

Equality (\ref{2016.01.15.eq7}) gives us, by (\ref{2015.08.24.eq5}) that $sf=f(n-1)$.
\end{proof}
%
%

Recall from \cite{Csubsystems} that for a C-system $CC$ one defines
$\wt{Ob}(CC)$ as the subset of $Mor(CC)$ that consists of morphisms $s$ of the
form $ft(X)\sr X$ such that $l(X)>0$ and $s\circ p_X=Id_{ft(X)}$.
%
\begin{lemma}
\llabel{2015.08.24.l1}
Let $f:\wh{m}\sr\wh{n}$ and let $s:\wh{n}\sr\wh{n+1}$ be an element of $\wt{Ob}$. Then one has
%
$$f^*(s)=(x_0^m,\dots,x_{m-1}^m,\mbind{f}(s(n)))$$
%
\end{lemma}
%
\begin{proof}
The fact that the first $m$ terms of the sequence representation of $fs=f^*(s)$
have the required form follows from Lemma \ref{2015.08.22.l7}. It remains to
prove that
%
$$fs(m)=\mbind{f}(s(n))=(s\hc f)(n)$$
%
The morphism $f^*(s)$, as a morphism over $\wh{m}$ is defined by the equation
%
$$f^*(s)\circ_C q(f,\wh{n+1})=f\circ_C s,$$
%
which is equivalent, by Lemma \ref{2016.01.15.l3},  to $qq(f)\hc fs=s\hc f$. Therefore 
%
\begin{equation*}
  \begin{split}
    (s\hc f)(n)&=(qq(f)\hc fs)(n)=\mbind{(fs)}(qq(f)(n))=\mbind{(fs)}(x_m^{m+1})
    \\&
    = \mbind{(fs)}(\eta_{m+1}(m))
    = (\eta_{m+1}\circ\mbind{(fs)})(m)=fs(m).
  \end{split}
\end{equation*}
%
The lemma is proved.
\end{proof}
%
\begin{lemma}
\llabel{2015.08.29.l1}
Let $f:\wh{m}\sr\wh{n}$ and let $s:\wh{n+i}\sr\wh{n+i+1}$ be an element of $\wt{Ob}$. Then one has
%
\begin{equation}\llabel{2015.08.29.eq1}
f^*(s)=(x_0^{m+i},\dots,x_{m+i-1}^{m+i},\mbind{qq^i(f)}(s(n+i)))
\end{equation}%
%
\end{lemma}
%
\begin{proof}
The morphisms involved in the proof can be seen on the following diagram
%
$$
\begin{CD}
\wh{m+i} @>qq^i(f)>> \wh{n+i}\\
@Vf^*(s)VV @VVsV\\
\wh{m+i+1} @>qq^{i+1}(f)>> \wh{n+i+1}\\
@Vp_{m+i+1,i+1}VV @VVp_{n+i+1,i+1}V\\
\wh{m} @>f>> \wh{n}
\end{CD}
$$
%
The morphism $s$ is a morphism from $Id_{\wh{n+i}}$ to $p_{\wh{n+i+1}}$ over
$\wh{n+i}$. Therefore, we may apply Lemma \ref{2015.08.29.l2}, obtaining the following
equality.
%
$$f^*(s)=(qq^i(f))^*(s)$$
%
On the other hand, by Lemma \ref{2015.08.24.l1} we have
%
$$qq^i(f)^*(s)=(x_0^{m+i},\dots,x_{m+i-1}^{m+i},\mbind{qq^i(f)}(s(n+i))).$$
%
The lemma is proved. 
\end{proof}
%
Another operation that we would like to have an explicit form of is the operation
$\delta$. For a C-system $CC$ and an object $\Gamma$ in $CC$ such that
$l(\Gamma)>0$ one defines $\delta_{\Gamma}$ as $s_{Id(\Gamma)}$
(cf.{} \cite[Section 3]{Csubsystems}).
%
\begin{lemma}\llabel{2015.08.24.l5}
In $C(\RR)$ one has: 
%
$$\delta_{\wh{n}}=(x_0^{n},\dots,x_{n-1}^{n},x_{n-1}^n)$$
%
\end{lemma}
%
\begin{proof}
It follows from Lemma \ref{2015.09.09.l1} since $Id_{\wh{n}}=(x_0^{n},\dots,x_{n-1}^{n})$. 
\end{proof}
%
%
\begin{problem}
To construct a bijection
%
\begin{equation}\llabel{2015.08.24.eq9}
mb_{\RR}:\wt{Ob}(C(\RR))\sr \amalg_{n\in\nat} RR(n)
\end{equation}%
%
\end{problem}
%
\begin{construction}\rm
\llabel{2015.08.22.constr3}
For $s:\wh{n}\sr \wh{n+1}$ define
%
$$mb_{\RR}(s)=(n,s(n))$$
%
To show that this is a bijection let us construct the inverse bijection. For $n\in\nn$ and $o\in RR(n)$ set
%
$$mb_{\RR}^!(n,o)=(x_0^n,\dots,x_{n-1}^n,o)$$
%
The fact that these functions are mutually inverse follows easily from Lemma \ref{2015.08.22.l7}.
\ec
%

Our next goal is to describe operations $T'$, $\wt{T}'$, $S'$, $\wt{S}'$ and
$\delta'$ obtained from operations $T$, $\wt{T}$, $S$, $\wt{S}$ and $\delta$
that were introduced at the end of Section 3 in \cite{Csubsystems} through
transport by means of the bijection (\ref{2015.08.24.eq9}).

Let us first recall the definition of operations $T$, $\wt{T}$, $S$, $\wt{S}$
and $\delta$ associated with a general C-system $CC$.
%
\begin{definition}
\llabel{2015.08.26.def1}
Let $CC$ be a C-system. We will write $Ob$ for $Ob(CC)$ and $\wt{Ob}$ for $\wt{Ob}(CC)$. 
%
%
\begin{enumerate}
\item The operation $T$ is defined on the set
%
$$T_{dom}=\{\Gamma,\Gamma'\in Ob\,|\,l(\Gamma)>0\,\,and\,\, \Gamma'>ft(\Gamma)\}$$
%
and takes values in $Ob$. For $(\Gamma,\Gamma')\in T_{dom}$ one defines
%
$$T(\Gamma,\Gamma')=p_{\Gamma}^*(\Gamma')$$
%
\item The operation $\wt{T}$ is defined on the set
%
$$\wt{T}_{dom}=\{\Gamma\in Ob, s\in \wt{Ob}\,|\,l(\Gamma)>0\,\,and\,\, \partial(s)>ft(\Gamma)\}$$
%
and takes values in $\wt{Ob}$. For $(\Gamma,s)\in \wt{T}_{dom}$ one defines
%
$$\wt{T}(\Gamma,s)=p_{\Gamma}^*(s)$$
%
\item The operation $S$ is defined on the set
%
$$S_{dom}=\{r\in \wt{Ob}, \Gamma\in Ob\,|\,\Gamma>\partial(r)\}$$
%
and takes values in $Ob$. For $(r,\Gamma)\in S_{dom}$ one defines
%
$$S(r,\Gamma)=r^*(\Gamma)$$
%
\item The operation $\wt{S}$ is defined on the set 
%
$$\wt{S}_{dom}=\{r,s\in \wt{Ob}\,|\,\partial(s)>\partial(r)\}$$
%
and takes values in $\wt{Ob}$. For $(r,s)\in \wt{S}_{dom}$ one defines
%
$$S(r,s)=r^*(s)$$
%
\item The operation $\delta$ is defined on the set 
%
$$\delta_{dom}=\{\Gamma\in Ob\,|\,l(\Gamma)>0\}$$
%
and takes values in $\wt{Ob}$. For $\Gamma\in \delta_{dom}$ one defines $\delta(\Gamma)$ as $s_{Id_{\Gamma}}$. 
\end{enumerate}
\end{definition}
%

Define, for any $Jf$-relative monad $\RR$, operations
$\theta_{m,n}=\theta^{\RR}_{m,n}$ such that for $m,n\in\nat$, $n>m$ and $r\in
RR(m)$, $s\in RR(n)$ one has
%
\begin{equation}
  \llabel{2015.09.07.eq1}
  \begin{split}
    \theta_{m,n}(r,s)&=\mbind{(qq^{n-m-1}(x_0^m,\dots,x_{m-1}^m,r))}(s) \\
    &=\mbind{(x_0^{n-1},\dots,x_{m-1}^{n-1},\iota_{m}^{n-m-1}(r),x_m^{n-1},\dots,x_{n-2}^{n-1})}(s)
  \end{split}
\end{equation}%
%
\begin{theorem}
\llabel{2015.08.26.th1}
Let $Ob=Ob(C(\RR))$ and let $\wt{Ob}'$ be the right hand side of (\ref{2015.08.24.eq9}). One has:
%
\begin{enumerate}
\item The operation $T'$ is defined on the set
%
$$T'_{dom}=\{\wh{m},\wh{n}\in Ob\,|\,m>0\,\,and\,\,n>m-1\}$$
%
and is given by 
%
$$T'(\wh{m},\wh{n})=\wh{n+1}$$
%
\item The operation $\wt{T}'$ is defined on the set 
%
$$\wt{T}'_{dom}=\{\wh{m}\in Ob, (n,s)\in \wt{Ob}'\,|\,m>0\,\,and\,\,n+1>m-1\}$$
%
and is given by
%
$$\wt{T}'(\wh{m},(n,s))=(n+1,\partial_n^{m-1}(s))$$
%
\item The operation $S'$ is defined on the set
%
$$S'_{dom}=\{(m,r)\in \wt{Ob}',\wh{n}\in Ob\,|\,n>m+1\}$$
%
and is given by
%
$$S'((m,r),\wh{n})=\wh{n-1}$$
%
\item The operation $\wt{S}'$ is defined on the set 
%
$$\wt{S}'_{dom}=\{(m,r)\in\wt{Ob}',(n,s)\in \wt{Ob}'\,|\,n>m\}$$
%
and is given by
%
$$\wt{S}'((m,r),(n,s))=\theta_{m,n}(r,s)$$
%
\item The operation $\delta'$ is defined on the subset
%
$$\delta'_{dom}=\{\wh{n}\in Ob\,|\,n>0\}$$
%
and is given by
%
$$\delta'(\wh{n})=(n,x_{n-1}^n)$$
%
\end{enumerate}
\end{theorem}
%
\begin{proof}
We have:
%
\begin{enumerate}
%
\item The operation $T'$ is the same as operation $T$ for $C(\RR)$ since $\wt{Ob}$
  is not involved in it. The form of $T'_{dom}$ is obtained by unfolding
  definitions and the formula for the operation itself follows from Lemma
  \ref{2015.08.22.l6}(2).
%
\item The operation $\wt{T}'$ is defined on the set of pairs $(\wh{m}\in Ob,
  (n,s)\in \wt{Ob}')$ such that $m>0$ and
  $\partial(mb_{\RR}^!(n,s))>m-1$. Since $\partial(mb_{\RR}^!(n,s))=n+1$ we
  obtain the required domain of definition. The formula by the operation itself
  is obtained immediately by combining Lemma \ref{2015.08.29.l1} and Lemma
  \ref{2015.08.26.l3a}.
%
\item The operation $S'$ is defined on the set of pairs $((m,r)\in
  \wt{Ob}',\wh{n}\in Ob)$, where $n>\partial(mb_{\RR}^!(m,r))$. Since
  $\partial(mb_{\RR}^!(m,r))=m+1$ we obtain the required domain of
  definition. The operation itself is given by
%
$$S'((m,r),n)=(mb_{\RR}^!(m,r))^*(\wh{n})=(x_0^m,\dots,x_{m-1}^m,r)^*(\wh{n})=\wh{n+m-(m+1)}=\wh{n-1}$$
%
\item The operation $\wt{S}'$ is defined on the set of pairs $(m,r),(n,s)\in
  \wt{Ob}'$ such that $\partial(mb_{\RR}^!(n,s))>\partial(mb_{\RR}^!(m,r))$
  which is equivalent to $n>m$. The formula for the operation itself is
  obtained immediately by combining Lemma \ref{2015.08.29.l1} with $i=n-m-1$
  and Lemma \ref{2015.08.28.l1}.
%
\item The operation $\delta'$ is defined on the subset $\wh{n}\in Ob$ such that
  $n>0$ and is given by
%
$$\delta'(\wh{n})=mb_{\RR}(\delta(\wh{n}))=mb_{\RR}((x_0^n,\dots,x_{n-1}^n,x_{n-1}^n))=(n,x_{n-1}^n)$$
%
\end{enumerate}
%
The theorem is proved. 
\end{proof}
%
The length function on $Ob=\nat$ is the identity. Of the remaining three
operations that define the pre-B-system structure on the pair of sets
$(Ob,\wt{Ob}')$, namely $pt$, $ft$ and $\partial'$, the first two are described above,
and $\partial'$ is given by $\partial'((m,r))=m+1$.

This completes the description of the pre-B-system structure on $(Ob,\wt{Ob}')$
that is obtained by the transport of structure from the standard pre-B-system
structure on $(Ob,\wt{Ob})$ by means of the pair of isomorphisms $Id$ and
$mb_{\RR}$.
%
\begin{remark}\rm
\llabel{2015.08.29.rem2} 
Conjecturally, a C-system can be reconstructed (up to
an isomorphism) from the sets $Ob$ and $\wt{Ob}$ equipped with the length
function $l:Ob\sr\nn$, the distinguished object $pt\in Ob$ and operations $ft,
\partial, T,\wt{T},S,\wt{S}$ and $\delta$. Combining this conjecture with
Theorem \ref{2015.08.26.th1} we conclude that the C-system $C(\RR)$ and,
therefore, the relative monad $\RR$, can be reconstructed from the sets $RR(n)$
with distinguished elements $x^n_i$ and equipped with operations $\partial_n^i$
and $\theta_{m,n}:RR(m)\times RR(n)\sr RR(n-1)$ for $n>m$.

Using Remark \ref{2016.01.17.rem1} this can be compared with the assertion of
\cite[Theorem 3.3]{FPT} that the category of abstract clones is equivalent to
the category of substitution systems of \cite[Definition 3.1]{FPT}. In such a
comparison the operation $\zeta$ of substitution systems of the form
$RR(n+1)\times RR(n)\sr RR(n)$ is the same as the operation $(s,r)\mapsto
\theta_{n,n+1}(r,s)$.
\end{remark}
%
\begin{remark}\rm
\llabel{2015.08.29.rem1}
Let $lRR$ be the disjoint union of $RR(n)$ for all $n$. Then we can sum up all of the operations that we need to consider as follows: 
%
\begin{enumerate}
\item a function $l:lRR\sr\nat$,
\item a function $\eta:\nat\sr lRR$ that takes $n$ to $x^n_0=\eta_{n}(0)$,
\item a function $\partial:\{r\in lRR, i\in\nat\,|\, l(r)\ge i\}\sr lRR$,
\item a function $\theta:\{r,s\in lRR,\,|\,l(r)>l(s)\}\sr lRR$,
\end{enumerate}
%
such that
%
\begin{enumerate}
\item for all $n\in\nat$, $l(\eta_{n})=n+1$,
\item for all $r\in lRR$, $i\in\nat $ such that $l(r)\ge i$, $l(\partial(r,i))=l(r)+1$,
\item for all $r,s\in lRR$ such that $l(s)>l(r)$ one has $l(\sigma(r,s))=l(s)-1$.
\end{enumerate}
%
It should be possible to describe, by a collection of further axioms on these
operations, a full subcategory in the category whose objects are sets $lRR$
with operations of the form $l,\eta,\partial$ and $\theta$ that is equivalent
to the category of $Jf$-relative monads or, equivalently, the category of
Lawvere theories or Fiore-Plotkin-Turi substitution algebras.
\end{remark}
%
\begin{remark}\rm
\llabel{2015.08.29.rem1b} It seems at first unclear why it should be possible
to realize the action of the symmetric group on $RR(n)$ using operations of
Remark \ref{2015.08.29.rem2} since they all seem to respect, in some sense, the
linear ordering of the sets $stn(n)$.

In the substitution notation of Remark \ref{2015.08.18.rem1}, given $r$ in
$RR(m)$ and $E$ in $RR(n)$,
%
$$\theta_{m,n}(r,E)=E[r/x_m,x_m/x_{m+1},\dots,x_{n-2}/x_{n-1}],$$
%
i.e., the operation $\theta_{m,n}$ corresponds to the substitution of an
expression in variables $x_0,\dots,x_{m-1}$ for the variable $x_m$ in an
expression in variables $x_0,\dots,x_n$ followed by a downshift of the subscripts
of the variables with the higher index.

The operation $\partial_n^i$ and the constants $x_n:=x^{n+1}_{n}$ are similarly
defined in terms of linear orderings.

To see how it is, nevertheless, possible to realize, for example, the
permutation of $x_0$ and $x_1$ consider the following. First let, for all
$i,n\in\nat$,
%
$$\iota_n^i=\partial_{n+i-1}^{n+i-1}\circ \dots\circ \partial_n^n:RR(n)\sr RR(n+i)$$
%
Then define for all $i,n\in\nat$, $n\ge i+1$ an element $x^n_i\in RR(n)$ by the formula
%
$$x^n_i=\iota_{i+1}^{n-i-1}(x_i)$$
%
such that, in particular, $x^{n+1}_{n}=x_n$.

Define now a function $\psi:RR(2)\sr RR(2)$ by the formula
%
$$\psi=\partial^0_2\circ \partial^0_3\circ \theta_{3,4}(x_0^3,-)\circ \theta_{2,3}(x_1^2,-)$$
%
One can verify that for any $Jf$-relative monad $RR$, $\psi=\sigma$, where
$\sigma$ is the permutation of $0$ and $1$ in $stn(2)$.

In the substitution notation this can be seen as follows:
%
$$\psi(E(x^2_0,x_1^2))=\theta_{2,3}(x_1^2,\theta_{3,4}(x_0^3,\partial^0_3(\partial^0_2(E(x^2_0,x_1^2)))))=\theta_{2,3}(x_1^2,\theta_{3,4}(x_0^3,\partial^0_3(E(x^3_1,x^3_2))))=$$
$$\theta_{2,3}(x_1^2,\theta_{3,4}(x_0^3,E(x^4_2,x^4_3)))=\theta_{2,3}(x_1^2,E(x^3_2,x^3_0))=E(x^2_1,x^2_0)$$
%
\end{remark}
%

\subsection{The C-system $C(\RR,\LM)$.}
%
\llabel{CRRLM}

In this paper we are interested in the $Jf$-relative monads $\RR$. The
corresponding Kleisli categories are the categories opposite to the categories
$C(\RR)$ underlying the C-systems considered above. Therefore, left modules
over a $Jf$-monad $\RR$ with values in $Sets$ are the presheaves on $C(RR)$,
i.e., the contravariant functors from $C(RR)$ to $Sets$.

Let $\LM=(LM,LM_{Mor})$ be such a presheaf.
%
%### bad notation that makes us to write $RR(n)$ and $LM(\wh{n})$.
%
The morphism component $LM_{Mor}$ of $\LM$ is a function that sends a morphism
$f$ from $\wh{m}$ to $\wh{n}$ in $C(\RR)$ to a function $LM_{Mor}(f)\in
Fun(LM(\wh{n}),LM(\wh{m}))$, i.e., we have for each $m,n\in\nat$ a function
%
$$RR(n,m)\sr Fun(LM(\wh{n}),LM(\wh{m}))$$
%
%### there are uses of R( instead of RR(
%
We will use this function as a coercion so that, for $f\in RR(n,m)$ and $E\in
LM(\wh{n})$ the expression $f(E)$ is assumed to be expanded into
$LM_{Mor}(f)(E)$ when needed.
%
\begin{remark}\rm
\llabel{2015.08.18.rem1} 
If we think of $E\in LM(\wh{n})$ as of an expression
in variables $0,\dots,n-1$, then the action of $RR(n,m)$ on $LM(\wh{n})$ can be
thought of as the substitution. This analogy can be used to introduce the
notation when for $f=(f(0),\dots,f(n-1))\in RR(n,m)$ and $E\in LM(\wh{n})$ one
writes $f(E)$ as
%
$$f(E)=E[f(0)/0,\dots,f(n-1)/n-1]$$
%
For example, in this notation we have 
%
$$\partial^i_n(E)=E[0/0,\dots,i-1/i-1,i+1/i,\dots,n/n-1]$$
%
Similarly, for $E\in LM(\wh{n+2})$ one has
%
$$\sigma^i_n(E)=E[0/0,\dots,i/i,i/i+1,\dots,n/n+1]$$
%
and $\iota_n^i(E)$ is ``the same expression'' but considered as an expression of $n+i$ variables.
\end{remark}
%
\begin{example}\rm
\llabel{2015.09.07.rem3} 
An important example of $\LM$ is given by the functor
defined on objects by $\wh{n}\mapsto RR(n)$ and on morphisms by
%
$$f\mapsto (s\mapsto\mbind{f}(s))$$
%
for $f:\wh{m}\sr \wh{n}$ and $s\in RR(n)$. We will denote this functor by the
same symbol $\RR$ as the underlying $Jf$-relative monad.

This functor is isomorphic to the (contravariant) functor represented by the
object $\wh{1}$ but it is not equal to this functor since the set of elements
of the form $((\wh{n},\wh{1}),r')$, where $r'\in RR(1,n)$ is isomorphic but not
equal to the set $RR(n)$.
\end{example}

Let $C(\RR,\LM)=C(\RR)[\LM]$ be the $\LM$-extension of the C-system
$C(\RR)$. The role of these C-systems in the theory of type theories is that
the term C-systems of the raw syntax of dependent type theories are of this
form and therefore the term C-systems of dependent type theories are regular
sub-quotients of such C-systems and can be studied using the description of the
regular sub-quotients given in \cite{Csubsystems}.

By construction,
%
\begin{equation}\llabel{2016.01.21.eq3}
Ob(C(\RR,\LM))=\amalg_{n\in\nat}Ob_n(\RR,\LM),
\end{equation}%
%
where 
%
$$Ob_n(\RR,\LM)=\LM(\wh{0})\times\dots\times\LM(\wh{n-1})$$
%
and therefore objects of $C(\RR,\LM)$ are pairs of the form $(n,\Gamma)$, where
$\Gamma$ is a sequence $(T_0,\dots,T_{n-1})$, where $T_i\in LM(\wh{i})$. While
the number $n$ in a pair $(n,\Gamma)$ is an object of $C(\RR)$ we will not add
the ${\,\,\wh{}\,\,}$ diacritic to it since no confusion of the kind possible
with objects of $C(RR)$ and objects of $F$ can arise. We may sometimes omit $n$
from our notation altogether since it can be recovered from
$\Gamma$. Similarly, while the morphisms of $C(\RR,\LM)$ are given by iterated
pairs of the form $(((m,\Gamma),(n,\Gamma')),((\wh{m},\wh{n}),f))$, where $f\in
\RR(n,m)$ we will sometimes write them as $f:(m,\Gamma)\sr (n,\Gamma')$ or
$f:\Gamma\sr \Gamma'$ or even just as $f$.

Let us also recall that for two objects $X=(m,(T_0,\dots,T_{m-1})))$ and
$Y=(n+1,(T'_0,\dots,T'_{n}))$ and a morphism $f:X\sr ft(Y)$ the object $f^*(Y)$
is given by the formula
%
\begin{equation}\llabel{2015.09.09.eq3old}
f^*(Y)=(m+1,(T_0,\dots,T_{m-1},f(T'_{n})))
\end{equation}%
%
and the morphism $q(f,Y):f^*(Y)\sr Y$ by the formula $q(f,Y)=qq(f)$. 
% 
\begin{lemma}
\llabel{2015.08.26.l8}
Let $X=(m,(T_0,\dots,T_{m-1}))$ and $Y=(n,(T_0,\dots,T_{n-2},T))$, where $m>n-1$. Then one has
%
$$p_{Y}^*(X)=(m+1,(T_0,\dots,T_{n-2},T,\partial_{n-1}^{n-1}(T_{n-1}),\dots,\partial_{m-1}^{n-1}(T_{m-1})))$$
%
\end{lemma}
%
\begin{proof}
We want to apply Lemma \ref{2016.01.31.l1}. We have $lx=n$, $ly=m$. The morphism $p_Y$ is of the form
%
$$p_Y=p_{\wh{n}}:(n,(T_0,\dots,T_{n-2},T))\sr (n-1,(T_0,\dots,T_{n-2}))$$
%
and 
%
$$(n-1,(T_0,\dots,T_{n-2}))=ft^i((m,(T_0,\dots,T_{m-1})))$$
%
where $i=m-n+1$. Therefore, 
%
\begin{equation*}
  \begin{split}
    p_Y^*(X)&=p_Y^*(X,i)
    \\&=
    (p_{\wh{n}}^*(\wh{m},i), (T_0,\dots,T_{n-2},T,
    \\& \spc\spc\spc\spc\spc
           q(p_{\wh{n}},ft^i(\wh{m}),0)(T_{m-i}),\dots,q(p_{\wh{n}},ft(\wh{m}),i-1)(T_{m-1}))
    \\&=
    (m+1,(T_0,\dots,T_{n-2},T,\iota_{n-1}^1(T_{n-1}),\dots,qq^{i-1}(L(\iota_{n-1}^1))(T_{m-1})))
    \\&=
    (m+1,(T_0,\dots,T_{n-2},T,\partial_{n-1}^{n-1}(T_{n-1}),\dots,\partial_{m-1}^{n-1}(T_{m-1}))),
  \end{split}
\end{equation*}
%
where the third equality is by Lemma \ref{2015.08.22.l6}(2) and the fourth one by Lemma \ref{2015.08.26.l3a}. 
\end{proof}
%

\comment{
\begin{remark}\rm
\llabel{2015.08.22.rem2.from.old}
%??? should E be from LM(\wh{n}) or LM(x_1,\dots,x_n)? Probably it does not matter as it leads to isomorphic C-systems
%
There is another construction of a pre-category from $(\RR,\LM)$ which takes as
an additional parameter a countable set $Var$ (with decidable equality), which
is called the {\em set of variables}. Let $F_n(Var)$ be the set of sequences of
length $n$ of pair-wise distinct elements of $Var$. Define the pre-category
$C(\RR,\LM,Var)$ as follows. The set of objects of $C(\RR,\LM,Var)$ is
%
$$Ob(C(\RR,\LM,Var))= \amalg_{n\in\nat} \amalg_{(x_0,\dots,x_{n-1})\in F_n(Var)} LM(\wh{0})\times\dots\times LM(\wh{n})$$
%
For compatibility with the traditional type theory we will write the elements
of $Ob(C(\RR,\LM,X))$ as sequences of the form
$x_0:E_1,\dots,x_{n-1}:E_{n-1}$. The set of morphisms is given by
%
$$Mor(C(\RR,\LM,Var))=\amalg_{\Gamma,\Gamma'\in Ob}R(l_f(\Gamma'),l_f(\Gamma))$$
%
The composition is defined in such a way that the projection 
%
$$(x_0:E_0,\dots,x_{n-1}:E_{n-1})\mapsto (E_0,E_1,\dots,E_{n-1})$$
%
is a functor from $C(\RR,\LM,Var)$ to $C(\RR,\LM)$. 

This functor is clearly an equivalence but not an isomorphism of categories. 

There are an obvious object $pt$, function $ft$ and $p$-morphisms. 

What is unclear is how to define operation $f^*$ on objects so as to satisfy
the first parts of the sixth and seventh conditions in the definition
\cite[Definition 2.1]{Csubsystems} of a C0-system. For
$\Gamma'=(x'_0:T'_0,\dots, x'_{m-1}:T'_{m-1})$,
$\Gamma=(y_0:T_0,\dots,y_n:T_n)$ and $f:\Gamma'\sr ft(\Gamma)$ the object
$f^*(\Gamma)$ must be of the form $(x'_0:T_0',\dots,x'_{m-1}:T'_{m-1}, z:T'_m)$
in order to satisfy the equation $ft(f^*(\Gamma))=\Gamma'$ and we should have
$z\ne x_0',\dots,x'_{m-1}$.

Consider the case when $LM(\wh{i})=unit$ for all $i$. Then the problem is to
construct functions
%
$$z_{n,m}:F_m(Var)\times F_{n+1}(Var)\times R(n,m)\sr Var$$
%
such that $z_{n,m}(x',y,f)$ does not occur in $x'$ and such that
%
\begin{equation}
\llabel{2015.08.22.eq1b}
z_{n,m}((x_0,\dots,x_{n-1}),(x_0,\dots,x_{n-1},x_n),\eta_n)=x_n
\end{equation}%
%
and for all $x'\in F_{m}$, $x''\in F_{k}$, $y\in F_{n+1}$, $f\in R(n,m)$ and $g\in R(m,k)$ one has
%
\begin{equation}
\llabel{2015.08.22.eq2b}
z_{n,k}(x'',y,g\hc f)=z_{m,k}(x'',(x'_0,\dots,x'_{m-1},z_{m,n}(x',y,f)),g)
\end{equation}%
%
I do not know whether it is possible to construct a function $z$ satisfying
these two equations for a general $R$.
\end{remark}
%
}

%
\begin{lemma}
\llabel{2015.08.22.l5} A morphism $f:X\sr Y$, where $l(Y)=n+1$ and $f\in
R(n+1,n)$, belongs to $\wt{Ob}(C(\RR,\LM))$ if and only if $X=ft(Y)$ and
$f(i)=x^n_i$ for $i=0,\dots,n-1$.
\end{lemma}
%
\begin{proof}
It follows immediately from Lemma \ref{2015.08.26.l1}.
\end{proof}
%
The following analog of Lemma \ref{2015.09.09.l1} for the C-system $C(\RR,\LM)$
provides us with the explicit form of the operation $f\mapsto s_f$.
%
\begin{lemma}
\llabel{2015.09.09.l2}
Let $f:X\sr Y$, $f=(f(0),\dots,f(n-1))$, where $n>0$. Then $s_f:X\sr (ft(f))^*(Y)$,
%
\begin{equation}\llabel{2015.09.09.eq1}
s_f=(x_0^{m},\dots,x_{m-1}^{m},f(n-1)),
\end{equation}%
%
where $ft(f)=f\circ p_Y$ and $m=l(X)$. 
\end{lemma}
%
\begin{proof}
By definition $s_f$ is a morphism from $X$ to $(ft(f))^*(Y)$. Therefore it is
sufficient to show that the left hand side of (\ref{2015.09.09.eq1}) agrees
with the right hand side after application of the homomorphism $tr_{\LM}$ and
our goal follows from Lemma \ref{2015.09.09.l1}.
\end{proof}
%
\begin{lemma}
\llabel{2015.09.03.l1}
For $i>0$, $f:X\sr ft^i(Y)$ and $s:ft(Y)\sr Y$ in $\wt{Ob}(C(\RR,\LM))$ one has $s:f^*(ft(Y))\sr f^*(Y)$,
%
$$f^*(s)=(x_0^{m+i-1},\dots,x_{m+i-2}^{m+i-1},\mbind{qq^{i-1}(f)}(s(n+i-1))),$$
%
where $m=l(\Gamma')$ and $n=l(\Gamma)$.
\end{lemma}
%
\begin{proof}
Since $tr_{\LM}$ is fully faithful, it is sufficient, in order to verify the
equality of two morphisms to verify that their domain and codomain are equal
and that their images under $tr_{\LM}$ are equal. For the domain and codomain
it follows from the definition of $f^*$ on morphisms. For the images under
$tr_{\LM}$ it follows from the fact that $tr_{\LM}$ is a homomorphism of
C-systems, Lemma \ref{2015.09.03.l2}(4) and Lemma \ref{2015.08.29.l1}.
\end{proof}
%
\begin{problem}
\llabel{2015.08.22.prob1}
To construct a bijection
%
\begin{equation}
\llabel{2009.10.15.eq2}
mb_{\RR,\LM}:\wt{Ob}(C(\RR,\LM))\sr \coprod_{n\in\nat} Ob_{n+1}(\RR,\LM)\times R(n)
\end{equation}%
%
\end{problem}
%
\begin{construction}\rm
\llabel{2015.08.22.constr1}
\llabel{2014.06.30.l2}
Let $s\in \wt{Ob}(C(\RR,\LM))$. Then $s:ft(X)\sr X$, $s\in R(n,n+1)$ and $X=(n+1,\Gamma)$. We set:
%
$$mb_{\RR,\LM}(s)=(n,(\Gamma, s(n)))$$
%
To show that this is a bijection let us construct an inverse. For $n\in\nat$, $\Gamma\in Ob_{n+1}(\RR,\LM)$ and $o\in R(n)$ let
%
$$mb_{\RR,\LM}^!(n,(\Gamma,o))=((ft((n+1,\Gamma)),(n+1,\Gamma)),(x^{n}_0,\dots,x^{n}_{n-1},o))$$
%
This is a morphism from $ft(X)$ to $X$, where $X=(n+1,\Gamma)$. The equation
$mb_{\RR,\LM}^!(n,(\Gamma,o))\circ p_X=Id_{ft(X)}$ follows from Lemma
\ref{2015.08.22.l5}.

Let us show now that $mb_{\RR,\LM}$ and $mb_{\RR,\LM}^!$ are mutually inverse bijections. Let $s\in \wt{Ob}$ be as above, then:
%
$$mb_{\RR,\LM}^!(mb_{\RR,\LM}(s))=mb_{\RR,\LM}^!(n,(\Gamma,s(n)))=((ft(X),X),(x^{n}_0,\dots,x^{n}_{n-1},s(n)))=s,$$
%
where the last equality follows from the assumption that $s\in \wt{Ob}$ and Lemma \ref{2015.08.22.l5}.

On the other hand, for $\Gamma\in Ob_{n+1}(\RR,\LM)$ and $o\in R(n)$ we have
%
$$mb_{\RR,\LM}(mb_{\RR,\LM}^!(n,(\Gamma,o)))=mb_{\RR,\LM}(ft((n+1,\Gamma)),((n+1,\Gamma),(x^{n}_0,\dots,x^{n}_{n-1},o)))=$$
$$(n,(\Gamma,o))$$
%
This completes Construction \ref{2015.08.22.constr1}.
\ec
%
\begin{lemma}
\llabel{2015.09.09.l3}
Let $f:X\sr Y$, $f=(f(0),\dots,f(n-1))$, where $X=(m,(T_0,\dots,T_{m-1}))$, $Y=(n,(T_0',\dots,T_{n-1}'))$. Then one has
%
$$mb_{\RR,\LM}(s_f)=(m,((T_0,\dots,T_{m-1},(f(0),\dots,f(n-2))(T_{n-1}')), f(n-1)))$$
%
\end{lemma}
%
\begin{proof}
It follows immediately from Lemma \ref{2015.09.09.l2} and the formula for $mb_{\RR,\LM}$.
\end{proof}
%
Consider operations $T'$, $\wt{T}'$, $S'$, $\wt{S}'$ and $\delta'$ obtained by
transport by means of the bijection of Construction \ref{2015.08.22.constr1}
from the operations $T$, $\wt{T}$, $S$ and $\wt{S}$ and $\delta$ corresponding
to the C-system $C(\RR,\LM)$ (cf.{} Definition \ref{2015.08.26.def1}).  Let us
give an explicit description of these operations.

Recall that we have defined, for any $Jf$-relative monad $\RR$, operations 
%
$$\theta^{\RR}_{m,n}:RR(m)\times RR(n)\sr RR(n-1).$$
% 
For $\LM$ as above and $n>m$ define operations $\theta^{\LM}_{m,n}$ of the form
%
$$\theta^{\LM}_{m,n}:RR(m)\times LM(n)\sr LM(n-1)$$
%
by the formula
%
\begin{equation}\llabel{2015.09.07.eq2}
  \begin{split}
    \theta^{\LM}_{m,n}(r,E)&=(qq^{n-m-1}(x_0^m,\dots,x_{m-1}^m,r))(E)\\
                          &=(x_0^{n-1},\dots,x_{m-1}^{n-1},\iota_m^{n-m-1}(r),x_m^{n-1},\dots, x_{n-2}^{n-1})(E),
  \end{split}
\end{equation}%
%
where the second equality is the equality of Lemma \ref{2015.08.28.l1}. As in
the case of $\theta^{\RR}_{m,n}$ we will often write $\theta_{m,n}$ instead of
$\theta^{\LM}_{m,n}$ since the whether we consider $\theta^{\RR}$ or
$\theta^{\LM}$ can be inferred from the type of the arguments.

  
%
\begin{theorem}\llabel{2015.08.26.th2}
Let $Ob=Ob(C(\RR,\LM))$ and let $\wt{Ob}'=\wt{Ob}'(\RR,\LM)$ be the right hand side of (\ref{2009.10.15.eq2}). One has:
%
\begin{enumerate}
\item The operation $T'$ is defined on the set $T'_{dom}$ of pairs
  $(m,\Gamma),(n,\Gamma')\in Ob$, where $\Gamma=(T_0,\dots,T_{m-1})$,
  $\Gamma'=(T_0',\dots,T_{n-1}')$ such that $m>0$, $n>m-1$ and $T_i=T_i'$ for
  $i=0,\dots,m-2$. It takes values in $Ob$ and is given by
%
\begin{equation*}
  \begin{split}
    T((m,\Gamma),&(n,\Gamma'))
    \\:= &(n+1,(T'_0,\dots,T'_{m-2},T_{m-1},\partial_{m-1}^{m-1}(T'_{m-1}),\dots,\partial_{n-1}^{m-1}(T'_{n-1})))
  \end{split}
\end{equation*}
%
\item The operation $\wt{T}'$ is defined on the set $\wt{T}'_{dom}$ of pairs
  $(m,\Gamma)\in Ob$, $(n,(\Gamma',s))\in\wt{Ob}'$, where
  $\Gamma=(T_0,\dots,T_{m-1})$, $\Gamma'=(T_0',\dots,T_{n-1}')$ such that
  $m>0$, $n+1>m-1$ and $T_i=T_i'$ for $i=0,\dots,m-2$. It takes values in
  $\wt{Ob'}$ and is given by
%
$$\wt{T}'((m,\Gamma),(n,(\Gamma',s))):=(n+1,(T((m,\Gamma),(n,\Gamma')),\partial_{n}^{m-1}(s)))$$
%
\item The operation $S'$ is defined on the set of pairs $(m,(\Gamma,r))\in
  \wt{Ob}'$, $(n,\Gamma')\in Ob$, where $\Gamma=(T_0,\dots,T_{m})$,
  $\Gamma'=(T_0',\dots,T_{n-1}')$ such that $n>m+1$ and $T_i=T_i'$ for
  $i=0,\dots,m$. It takes values in the set $Ob$ and is given by
%
\begin{equation*}
  \begin{split}
    S'((m,(\Gamma,r)),&(n,\Gamma'))
    \\ :=& (n-1,(T_0',\dots,T_{m-1}',\theta_{m,m+1}(r,T_{m+1}'),\theta_{m,m+2}(r,T_{m+2}'),\dots,
    \\  & \spc\spc\spc\spc\spc
    \theta_{m,n-1}(r,T_{n-1}')))
  \end{split}
\end{equation*}
%
\item The operation $\wt{S}'$ is defined on the set of pairs $(m,(\Gamma,r))\in
  \wt{Ob}'$, $(n,(\Gamma',s))\in \wt{Ob}'$, where $\Gamma=(T_0,\dots,T_{m})$,
  $\Gamma'=(T_0',\dots,T_{n}')$ such that $n>m$ and $T_i=T_i'$ for
  $i=0,\dots,m$. It takes values in $\wt{Ob}'$ and is given by
%
$$\wt{S}'((m,(\Gamma,r)),(n,(\Gamma',s))):=(n-1,(S'((m,(\Gamma,r)),(n+1,\Gamma'))),\theta_{m,n}(r,s))$$
%
\item The operation $\delta'$ is defined on the subset of $(m,\Gamma)$ in $Ob$ such
  that $m>0$. It takes values in $\wt{Ob}'$ and is given by
%
$$\delta'((m,\Gamma)):=(m,(T((m,\Gamma),(m,\Gamma)),x_{m-1}^m))$$
%
\end{enumerate}
\end{theorem}
%
\begin{proof}
In the proof we will write $mb$ and $mb^!$ instead of $mb_{\RR,\LM}$ and
$mb^!_{\RR,\LM}$. We have:
%
\begin{enumerate}
%
\item The operation $T'$ is the same as operation $T$ for $C(\RR,\LM)$ since
  $\wt{Ob}$ is not involved in it. The form of $T'_{dom}$ is obtained by
  unfolding definitions.

The operation itself is given by 
%
$$T'((m,\Gamma),(n,\Gamma'))=p_{(m,\Gamma)}^*((n,\Gamma'))=$$
$$(m,(T_0,\dots,T_{m-1},\partial_{m-1}^{m-1}(T'_{m-1}),\dots, \partial_{n-1}^{m-1}(T_{n-1}'))),$$
%
where the first equality is by Definition \ref{2015.08.26.def1}(1) and the second by Lemma \ref{2015.08.26.l8}. 
%
\item The operation $\wt{T}'$ is defined on the set of pairs $(m,\Gamma)\in Ob$,
  $(n,(\Gamma',s))\in \wt{Ob}'$ such that $m>0$ and
  $\partial(mb^!(n,(\Gamma',s)))>ft(m,\Gamma)$ and takes values in
  $\wt{Ob}'$. Since $\partial(mb^!(n,(\Gamma',s))=(n+1,\Gamma')$ we obtain the
  required domain by unfolding definitions.

To verify the formula for the operation itself consider the equalities:
%
$$\wt{T}'((m,\Gamma),(n,(\Gamma',s)))=mb(p_{(m,\Gamma)}^*(mb^!(n,(\Gamma',s))))=$$
$$mb(p_{(m,\Gamma)}^*((ft((n+1,\Gamma')),((n+1,\Gamma'),(x^{n}_0,\dots,x^{n}_{n-1},s))))),$$
%
where the first equality is by Definition \ref{2015.08.26.def1}(2). By Lemma
\ref{2015.09.03.l1} we can extend these equalities as follows:
%
$$mb(p_{(m,\Gamma)}^*((ft((n+1,\Gamma')),((n+1,\Gamma'),(x^{n}_0,\dots,x^{n}_{n-1},s)))))=$$
$$mb(p_{X}^*(ft(Y)),(p_{X}^*(Y),(x^{n+1}_0,\dots,x^{n+1}_{n},(qq^{n-m+1}(\iota^1_{m-1}))(s))))=$$
$$(n+1,(p_{X}^*(Y),\partial_{n}^{m-1}(s)))=(n+1,(T((m,\Gamma),(n+1,\Gamma')),\partial_n^{m-1}(s))),$$
%
where $X=(m,\Gamma)$, $Y=(n+1,\Gamma')$, the first equality is by Lemma
\ref{2015.09.03.l1}, the second by Lemma \ref{2015.08.26.l3a} and the third by
Definition \ref{2015.08.26.def1}(1).
%
\item The operation $S'$ is defined on the set of pairs $((m,(\Gamma,r))\in
  \wt{Ob}',(n,\Gamma')\in Ob)$ such that
  $(n,\Gamma')>\partial(mb^!(m,(\Gamma,r)))$ and takes values in $Ob$. Since
  $\partial(mb^!(m,(\Gamma,r)))=(m+1,\Gamma)$ we obtained the required domain
  of definition. The operation itself is given by
%
\begin{equation}\llabel{2016.01.21.eq2}
S'((m,(\Gamma,r)),(n,\Gamma'))=(mb^!((m,(\Gamma,r))))^*((n,\Gamma'))
\end{equation}%
%
Next we have 
%
\begin{equation*}
  \begin{split}
    (mb^!((m,(&\Gamma,r))))^*((n,\Gamma'))
    \\&=
    ((ft(A),A),(x^{m}_0,\dots,x^{m}_{m-1},r))^*(B)
    \\&=
    ((ft(A),A),(x^{m}_0,\dots,x^{m}_{m-1},r))^*(B,i),
  \end{split}
\end{equation*}
%##
where $A=(m+1,\Gamma)$, $B=(n,\Gamma')$ and $i=n-m-1$. To apply Lemma
\ref{2016.01.31.l1} we should take $X=\wh{m}$, $lx=m$ and $Y=\wh{n}$, $ly=n$
and $f=((ft(A),A),(x^{m}_0,\dots,x^{m}_{m-1},r))$. Let further
$rr=(x^{m}_0,\dots,x^{m}_{m-1},r)$. Then we can extend these equalities as
follows
%
\begin{equation*}
  \begin{split}
    f^*&((n,\Gamma'),i)
    \\&=
    (rr^*(\wh{n},i),(T_0,\dots,T_{m-1},
    \\& \spc\spc\spc\spc
    q(rr,ft^i(\wh{n}),0)(T'_{m+1}),\dots,q(rr,ft(\wh{n}),i-1)(T'_{n-1})))
    \\&=
    (n-1,(T_0,\dots,T_{m-1},
    \\& \spc\spc\spc\spc
    rr(T'_{m+1}),\dots,qq^{n-m-2}(rr)(T'_{n-1})))
    \\&=
    (n-1,(T_0',\dots,T_{m-1}',
    \\& \spc\spc\spc\spc
    rr(T_{m+1}'),qq(rr)(T_{m+2}'),\dots,qq^{n-m-2}(rr)(T_{n-1}'))),
  \end{split}
\end{equation*}
FOOBAR
%
where the last equality holds by the assumption that $T_i=T_i'$ for $i=0,\dots,m$. 
The required formula follows from the equality 
%
$$qq^j(rr)(T_{m+j+1}')=\theta_{m,m+j+1}(r,T_{m+j+1}').$$
%
\item The operation $\wt{S}'$ is defined on the set of pairs $(m,(\Gamma,r))\in \wt{Ob}'$, $(n,(\Gamma',s))\in \wt{Ob}'$ such that 
%
\begin{equation}\llabel{2016.01.21.eq1}
\partial(mb^!((n,(\Gamma',s))))>\partial(mb^!(m,(\Gamma,r)))
\end{equation}%
%
and takes values in $\wt{Ob}'$. The inequality (\ref{2016.01.21.eq1}) is equivalent to 
%
$$(n+1,\Gamma')>(m+1,\Gamma)$$
%
which is, in turn, equivalent to the conditions in the theorem. In the computation  below let us sometimes abbreviate $((X,Y),f)$ to $f$. Let
%
$$rr=(x_0^m,\dots,x_{m-1}^m,r)$$
$$ss=(x_0^n,\dots,x_{n-1}^n,s)$$
%
Then the operation itself is given by:
%
$$\wt{S}'((m,(\Gamma,r)),(n,(\Gamma',s)))=mb((mb^!(m,(\Gamma,r)))^*(mb^!((n,(\Gamma',s)))))=mb(rr^*ss)=$$
$$mb((x_0^{n-1},\dots,x^{n-1}_{n-2},(qq^{n-m-1}(rr))(s)))=(n-1,(rr^*((n+1,\Gamma')),(qq^{n-m-1}(rr))(s)))=$$
$$(n-1,(S'((m,(\Gamma,r)),(n+1,\Gamma'))),\theta_{m,n}(r,s)),$$
%
where the third equality is by Lemma \ref{2015.09.03.l1} and the fifth by
(\ref{2016.01.21.eq2}) and the definition of $\theta_{m,n}(r,s)$.
%
\item The operation $\delta'$ is defined on the subset $(m,\Gamma)\in Ob$ such that $m>0$ and is given by
%
$$\delta'((m,\Gamma))=mb(\delta((m,\Gamma)))$$
%
Therefore it is sufficient to show that
%
$$\delta((m,\Gamma))=(((m,\Gamma),p_{(m,\Gamma)}^*((m,\Gamma))),(x_0^m,\dots,x_{m-1}^m,x_{m-1}^m))$$
%
By Definition \ref{2015.08.26.def1}(5), $\delta((m,\Gamma))$ is a morphism from
$(m,\Gamma)$ to $p_{(m,\Gamma)}^*((m,\Gamma))$. Therefore, since $tr_{\LM}$ is
a fully faithful functor it is sufficient to show that
%
$$tr_{\LM}(\delta((m,\Gamma)))=((\wh{m},\wh{m+1}),(x_0^m,\dots,x_{m-1}^m,x_{m-1}^m))$$
%
which follows from Lemma \ref{2015.09.03.l2}(5) and Lemma \ref{2015.08.24.l5}.
%
\end{enumerate}
%
This completes the proof of the theorem. 
\end{proof}
%
The length function on $Ob$ is described above. Of the remaining three
operations that define the pre-B-system structure on the pair of sets
$(Ob,\wt{Ob}')$, namely $pt$, $ft$ and $\partial'$, the first two are described above,
as well and $\partial'$ is given by $\partial'((m,(\Gamma,r)))=(m+1,\Gamma)$.

This completes the description of the pre-B-system structure on $(Ob,\wt{Ob}')$
that is obtained by the transport of structure from the standard pre-B-system
structure on $(Ob,\wt{Ob})$ by means of the pair of isomorphisms $Id$ and
$mb_{\RR,\LM}$.

EDITOR: The paragraphs above have occurred previously.

\begin{remark}\rm
\llabel{2015.09.13.rem1} 
Given an $Jf$-relative monad $\RR$ in the form
$l\RR=(lR,l,\eta,\partial,\theta)$ of Remark \ref{2015.08.29.rem1} we can
define a left l-module $l\LM$ over $\RR$ as a quadruple:
%
\begin{enumerate}
\item a set $lLM$,
\item a function $l:lLM\sr \nn$,
\item a function $\partial:\{E\in lLM, i\in\nat\,|\, l_{\LM}(E)\ge i\}\sr lLM$,
\item a function $\theta^{\LM}:\{r\in lR,E\in lLM\,|\,l_{\LM}(E)>l_{\RR}(r)\}\sr lLM$,
%
\end{enumerate}
%
where operations $l,\partial$ and $\theta^{\LM}$ satisfy some conditions. 

Once these conditions are properly established the category of such pairs
$(l\RR,l\LM)$ should be equivalent to the Hirschowitz-Maggesi ``large module
category'' category (see \cite[Definition 2.9]{HM2008}) and in particular the
systems of expressions associated with binding signatures can be described as
universal objects carrying some additional operations in this category.

These l-versions of the relative monads and their modules should be easier to
formalize in systems such as {\em HOL}.
\end{remark} 
%

\bibliography{alggeom}
\bibliographystyle{plain}

\end{document}
