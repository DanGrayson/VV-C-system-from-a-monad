\documentclass[11pt]{article}
\usepackage{graphicx}
\usepackage{eufrak}
\usepackage{amscd, amssymb}
\usepackage{enumerate}
\usepackage{hyperref}
% lscape.sty Produce landscape pages in a (mainly) portrait document.
\usepackage{lscape}
%
\textwidth = 6.5 in
\textheight = 9 in
\oddsidemargin = 0.0 in
\evensidemargin = 0.0 in
\topmargin = 0.0 in
\headheight = 0.0 in
\headsep = 0.0 in
\parindent = 0.0in

\renewcommand{\thesubsection}{\arabic{subsection}}
%
%
\newenvironment{eq}{\begin{equation}}{\end{equation}}
%
\newenvironment{proof}{{\bf Proof}:}{\vskip 5mm }
\newenvironment{rem}{{\bf Remark}:}{\vskip 5mm }
\newenvironment{remarks}{{\bf Remarks}:\begin{enumerate}}{\end{enumerate}}
\newenvironment{examples}{{\bf Examples}:\begin{enumerate}}{\end{enumerate}}  
%
\newtheorem{proposition}{Proposition}[subsection]
\newtheorem{lemma}[proposition]{Lemma}
\newtheorem{definition}[proposition]{Definition}
\newtheorem{theorem}[proposition]{Theorem}
\newtheorem{cor}[proposition]{Corollary}
\newtheorem{conjecture}{Conjecture}
\newtheorem{pretheorem}[proposition]{Pretheorem}
\newtheorem{hypothesis}[proposition]{Hypothesis}
\newtheorem{example}[proposition]{Example}
\newtheorem{remark}[proposition]{Remark}
\newtheorem{ex}[proposition]{Exercise}
\newtheorem{cond}[proposition]{Conditions}
\newtheorem{cons}[proposition]{Construction}


\newtheorem{problem}[proposition]{Problem}
\newtheorem{construction}[proposition]{Construction}
%


%
%
%\newcommand{\C}[4]{\left[\begin{array}{rcl}&#1\\#3&\dw\dw&#4\\&#2\end{array}\right]}
\newcommand{\llabel}[1]{\label{#1}[{\bf #1}]}
%\newcommand{\llabel}[1]{\label{#1}}
\newcommand{\comment}[1]{}
\newcommand{\sr}{\rightarrow}
\newcommand{\lr}{\longrightarrow}
\newcommand{\xr}{\xrightarrow}
\newcommand{\dw}{\downarrow}
\newcommand{\bdl}{\bar{\Delta}}
\newcommand{\zz}{{\bf Z\rm}}
\newcommand{\zq}{{\bf Z}_{qfh}}
\newcommand{\nn}{{\bf N\rm}}
\newcommand{\nat}{\nn}
\newcommand{\qq}{{\bf Q\rm}}
\newcommand{\rr}{{\bf R}}
\newcommand{\lm}{{\bf LM}}
\newcommand{\nq}{{\bf N}_{qfh}}
\newcommand{\oo}{\otimes}
\newcommand{\uu}{\underline}
\newcommand{\ih}{\uu{Hom}}
\newcommand{\af}{{\bf A}^1}
\newcommand{\wt}{\widetilde}
\newcommand{\gm}{{\bf G}_m}
\newcommand{\dsr}{\stackrel{\sr}{\scriptstyle\sr}}
%\newcommand{\PP}{$P_{\infty}$}
\newcommand{\tp}{\wt{D}}
\newcommand{\HH}{$H_{\infty}$}
\newcommand{\ii}{\stackrel{\scriptstyle\sim}{\sr}}
\newcommand{\BB}{_{\bullet}}
\newcommand{\D}{\Delta}
\newcommand{\colim}{{\rm co}\hspace{-1mm}\lim}
\newcommand{\cf}{{\it cf} }
\newcommand{\msf}{\mathsf }
\newcommand{\mcal}{\mathcal }
\newcommand{\ep}{\epsilon}
\newcommand{\tl}{\widetilde}
\newcommand{\ub}{\mbox{\rotatebox{90}{$\in$}}}
\newcommand{\ssp}{\,\,\,\,\,\,\,\,}
\newcommand{\red}{\twoheadrightarrow}
\newcommand{\eqg}{\stackrel{\Gamma}{\approx}}
\newcommand{\alphaeq}{\stackrel{\alpha}{\sim}}
\newcommand{\rtr}{\triangleright}
\newcommand{\wh}{\widehat}
\newcommand{\bind}{bind}
\newcommand{\mbind}{\rho}
\newcommand{\hc}{\wh{\circ}}
%
\newcommand{\piece}{\vskip 3mm\noindent\refstepcounter{proposition}{\bf
\theproposition}\hspace{2mm}}
\newcommand{\subpiece}{\vskip 3mm\noindent\refstepcounter{equation}{\bf\theequation}
\hspace{2mm}}{\vskip
3mm}

\newcommand{\spc}{{\,\,\,\,\,\,\,}}
\newcommand{\impl}{{\Rightarrow}}

\newcommand{\B}{{\bf B}}
\newcommand{\FF}{{\bf F}}
\newcommand{\TT}{{\bf T}}
\renewcommand{\SS}{{\bf S}}
\newcommand{\BD}{{\bf BD}}

\newcommand{\JJ}{{\mathcal J}}

\begin{document}
%
\parskip = 2mm
\begin{center}
{\bf\Large C-system of a module over a monad on sets\footnote{\em 2000 Mathematical Subject Classification: 
%
18D99, % category theory and homological algebra, categories with structures, none of the above, but in this section
08C99, % general algebraic systems, other classes of algebras, none of the above but in this section
03B15 % mathematical logic and foundations, general logic, higher-order logic and type theory
03F50, % metamathematics of constructive systems 
%
}}

Keywords: Contextual categories, Lawvere theories, monads, modules, HOL, Mizar, Coq, Martin-Lof, derivable judgements. 

\vspace{3mm}

{\large\bf Vladimir Voevodsky}\footnote{School of Mathematics, Institute for Advanced Study,
Princeton NJ, USA. e-mail: vladimir@ias.edu}$^,$\footnote{Work on this paper was supported by NSF grant 1100938.}
\vspace {3mm}
%add MURI
{September 2015}  
\end{center}

\begin{abstract}
This is the second paper in a series started in \cite{Csubsystems} which aims to provide mathematical descriptions of objects and constructions related to the semantical theory of dependent type systems. 

We construct for any pair $(\rr,\lm)$, where $R$ is a monad on sets and $LM$ is a left module over $R$, a C-system (``contextual category'') $CC(\rr,\lm)$ and describe, using the results of \cite{Csubsystems} a class of sub-quotients of $CC(\rr,\lm)$ in terms of objects directly constructed from $R$ and $LM$. In the special case of the monads of expressions associated with  binding signatures this construction gives, for the first time, a mathematically rigorous way of constructing a C-system from a general collection of judgements of the four Martin-L\"{o}f kinds that satisfies a well specified set of conditions. 
\end{abstract}

%(2014.09.27) Make a note about the functoriality of CC(\rr,\lm) on the "large module category" %of Hirschowitz-Maggesi. 
%Change the name of the monad from M to R. Also \mu, \eta for the monad structure and 
%\rho for the module structure.

%$$\mathfrak{S}$$

%??? Make the dependence on the choice of a universe explicit? Then need to understand what is required from a set $UU$ or a type universe $UU$ in order to be able to realize the results of this paper. Can one consider LM in Prop? Is it relevant for the formalization of predicate logic?

\tableofcontents

\subsection{Introduction}

The first few steps in all approaches to the semantics of dependent type theories remain insufficiently understood. The constructions which have been worked out in detail in the case of a few particular type systems by dedicated authors are being extended to the wide variety of type systems under consideration today by analogy. This is not acceptable in mathematics. Instead we should be able to obtain the required results for new type systems by {\em specialization} of general theorems formulated and proved for abstract objects the instances of which combine together to produce the objects associated with a given type system. 

%???!!## Explain through reference to Martin Hofmann Section 2.3 about pre-syntax. The word "associative" does not even appear in that paper. Sections 2.3, 2.4 The "construction" of term model (which is what the present paper is about) in 3.1 lacks proofs and even precise statements entirely. 

%Also a reference to Jacob where he says that proving associativity is non-trivial. 

%The Ty/Tm definition of CwF appears already in Hofmann (3.1). 

%Mention that our description of general sub-quotients allows to use our results for the study of the semantics of type systems with context-dependent computation.

An approach that follows this general philosophy was outlined in \cite{CMUtalk}. In this approach the connection between the type theories, which belong to the concrete world of logic and programming, and abstract mathematical concepts such as sets or homotopy types is constructed through the intermediary of C-systems. 

C-systems were introduced in \cite{Cartmell0} (see also \cite{Cartmell1}) under the name ``contextual categories''. A modified axiomatics of C-systems and the construction of new C-systems as sub-objects and regular quotients of the existing ones in a way convenient for use in type-theoretic applications are considered in \cite{Csubsystems}.

In the approach of \cite{CMUtalk}, in order to provide a mathematical interpretation (semantics) for a type theory one constructs two C-systems. One C-system is constructed from the formulas of the type theory using as an initial step the construction of the present paper.  The second C-system is constructed from the category of abstract mathematical objects using the results of \cite{Cfromauniverse}. Both C-systems are then equipped with additional operations corresponding to the ``inference rules'' of the type theory. 

The main component of this approach is the expected result that for a particular class of the inference rules the concrete C-systems built using the constructions of the present paper and equipped with operations corresponding to these inference rules are initial objects in the category of C-systems with the corresponding operations. This is known as the Initiality Conjecture. In the case of the pure Calculus of Constructions this conjecture was proved in 1988 by Thomas Streicher \cite{Streicher}. The problem of finding an appropriate formulation of the general version of the conjecture and of proving this general version will be the subject of future work. 

For such inference rules, then, there are unique homomorphisms from the concrete C-systems to the abstract C-systems that are compatible with the corresponding systems of operations. Since objects and morphisms of concrete C-systems are built from formulas of the type theory and objects and morphisms of abstract C-systems are built from mathematical objects such as sets or homotopy types and the corresponding functions, these homomorphisms provide a mathematical meaning to formulas of type theory. 

The existence of such homomorphisms in the particular case of the ``standard univalent models'' of  Martin-L\"{o}f type theories and of the Calculus of Inductive Constructions (CIC) provides the only known justification for the use of the proof assistants such as Coq for the formalization of mathematics in the univalent style (see \cite{UniMath}, \cite{UniMath2015}). 

It is important to distinguish the concepts of a model of a type theory and the concept of an interpretation of the same type theory. A {\em model} of type theory can be defined as a C-system that is equipped with the systems of operations corresponding to the inference rules of the type theory. A (categorical) {\em interpretation} of a type theory with values in a given category $\cal C$ is a functor from the category underlying the syntactic C-system of the type theory to $\cal C$. 

Only if we know that the initiality result holds for a given type theory can we claim that any its model defines an interpretation by taking the composition of the canonical homomorphism of the C-systems with the functor such as the functor $int$ of \cite{Cfromauniverse}. A similar problem also arises in the predicate logic but there, since one considers only one fixed system of syntax and inference rules, it can and had been solved once without the development of a general theory. 

When one speaks about the univalent model of a Martin-L\"{o}f type theory or of the CIC one often fails to distinguish between the model and the interpretation.  A construction of a {\em model} for the version of the Martin-L\"{o}f type theory that is used in the UniMath library (\cite{UniMath},\cite{UniMath2015})  was sketched in \cite{KLV1}. At the time when that paper was written it was unfortunately assumed that a proof of the initiality result can be found in the existing body of work on type theory which is reflected  in \cite[Theorem 1.2.9]{KLV1} (cf. also \cite[Example 1.2.3]{KLV1} that claims as obvious everything that is done in both the present paper and in \cite{Csubsystems}).  Since then it became clear that this is not the case and that a mathematical theory leading to the initiality theorem and providing a proof of such a theorem is lacking and needs to be developed. 

As the criteria for what constitutes an acceptable proof were becoming more clear as a result of continuing work on formalization, it also became clear that more detailed and general proofs need to be given to many of the theorems of \cite{KLV1} that are related to the model itself. For the two of the several main groups of inference rules of current type theories it is done in \cite{fromunivwithPi} and \cite{fromunivwithpaths}. Other groups of inference rules will be considered in further papers of the series. 

This paper may be considered to be an analog of \cite{Cfromauniverse} for the concrete side of the theory in the sense that it provides a very general construction the particular cases of which lead to the concrete (syntactic) C-systems of type theories. 

If $R=(R,\eta,\mu)$ is a monad on a category $\cal C$ (see Definition \ref{}) then there is defined the Kleisli category ${\cal C}_R$ of $R$ whose objects are the same as objects of $\cal C$ and morphisms from $X$ to $Y$ are defined as morphisms from $X$ to $R(Y)$ in $\cal C$. The identity morphisms in ${\cal C}_R$ are given by the $\eta$ operation of $R$ and the composition by the composition in $\cal C$ and the $\mu$ operation of $R$.

A left $R$-module $LM$  over $R$ with values in a category $\cal D$ (see Definition \ref{}) defines a functor $LM_R:{\cal C}_R\sr {\cal D}$ and this function from left $R$-modules to functors from the Kleisli category is an equivalence (see \ref{}). 

An important case is the left $R$-module corresponding to $R$ itself which we will also denote by $R$.   

Monads on the category of sets and left modules over such monads have a number of special ????


Of a particular interest is the case of ``syntactic'' pairs $(\rr,\lm)$ where for $X=\{x_1,\dots,x_n\}$, $R(X)$ and $LM(X)$ are the sets of expressions of some kind with free variables from $\{x_1,\dots,x_n\}$ modulo an equivalence relation such as $\alpha$-equivalence. The difference between $R$ and $LM$ is in this case expressed by the fact that one can substitute elements from $R(X)$ for variables both in $R(Y)$ and $LM(Y)$ but elements of $LM(X)$ can not be substituted for variables in either. 

The simplest class of syntactic pairs, where $LM=R$, arises from binding signatures (see \cite[p.228]{HM2007}). To any such signature $\Sigma$ one associates a class of expressions with bindings and $R(\{x_1,\dots,x_n\})$ is the set of such expressions with free variables from the set $\{x_1,\dots,x_n\}$ modulo $\alpha$-equivalence.  

The more general case when $LM$ is not equal to $R$ arises when one starts to distinguish ``type expressions'' from ``object expressions''. The rules of type theories require the possibility to substitute an object expression instead of a variable both in a type expression and in an object expression but do not require to substitute a type expression instead of a variable either in a type or in an object expression. In type theories of proof assistants such as Coq the user may be under the impression that the substitution of type expressions instead of variables occurs (as in substituting $unit$ for $T$ in $iscontr(T)$ in the UniMath to obtain $iscont(unit)$, cf. \cite{UniMath2015}) this is however due to a ``silent'' map from object expressions to type expressions that is used in these theories. What actually happens in these substitutions is that an object expression whose type is a universe is substituted instead of a variable in some situations and the same object expression is mapped to the set of type expressions and used as a type expression in others. In our constructions this corresponds to $LM=R$ - an object expression that is an element of $R(X)$ for some set of variables $X$ is considered as an element of the set of type expressions $LM(X)$ using the identity map defined by this equality (more generally one may observe the same illusion when $LM\subset R$). 

The question of whether to keep this map silent or to give it a name (usually $El$) is know in type theory as the difference between the type theories with ``Russell universes'' (silent map) and ``Tarski universes'' (explicit map) which is at the center of some of the current controversies about the universe management in proof assistants. It is also the subject of a discussion in the last, unfinished, chapter in \cite{Bibliopolis}. 

For the purposes of the present paper we fortunately don't need to make a choice between the two approaches since the formalism that we develop is applicable to both. It is however clear from the constructions that the separation between $R$ and $LM$ is a very natural possibility that directly generalizes the case of $LM\subset R$ and creates new examples (e.g. Example \ref{}). 

As was shown in \cite{HM2007} the monad that one associates to a binding signature can be characterized as being an initial object in the category of monads equipped with ``left-linear'' operations corresponding to the operations of the signature.  This provides an abstract mathematical characterization of the concrete objects - expressions modulo $\alpha$-equivalence or, equivalently, expressions with De Brujin indexes. 

An important remark needs to be made here. While monads provide a very convenient way of expressing syntax with bindings in terms familiar to mathematicians the approach based on monads is equivalent to an earlier one pioneered in \cite{FPT}. For two sets $X$ and $Y$ let $Fun(X,Y)$ be the set of functions from $X$ to $Y$.  In that earlier approach one considers the category $F$ such that $Ob(F)=\nn$ and
%
$$Mor(F)=\amalg_{m,n}Fun(stn(m),stn(n))$$
%
where $stn(i)=\{0,\dots,i-1\}$ is the ``standard" set with $i$ elements, and functors $Funct(F,Sets)$ from $F$ to $Sets$ (the authors call these functors ``presheaves'' considering them as presheaves on $F^{op}$) . This category of functors is equivalent\footnote{In the set-theoretic mathematics this equivalence can not be defined without axiom of choice. The problem lies in the fact that the obvious functor from $F$ to the category of finite sets, while it is  fully faithful and essentially surjective, does not have a constructive inverse. In the univalent foundations, while one still can not construct an inverse to the functor from $F$ to finite sets, one can construct an inverse to the corresponding functor from $Funct(FSets,Sets)$ to $Funct(F,Sets)$ using the fact that $Sets$ is a (univalent) category. Cf. \cite{RezkCompletion} and \cite[RezkCompletion library]{UniMath}.} to the category of finitary (co-continuous) functors from $Sets$ to $Sets$. In particular, there is a monoidal structure $(\bullet,V)$ on $Funct(F,Sets)$ corresponding to the composition of functors under this equivalence (cf. \cite[Sec. 3]{FPT}) and finitary monads can be considered as monoids in $Funct(F,Sets)$ with respect to this monoidal structure. 

Using this equivalence of concepts (detailed in \cite{}) the constructions and results of \cite{HM2007} and \cite{FPT} can be viewed together as describing different aspects of a fundamental connection between the concrete world of syntax and the abstract world of categorical mathematics. 

After this long detour let me clarify that the results and constructions of the present paper do not depend on either \cite{HM2007} or \cite{FPT}, except for the definition of a left module over a monad in \cite{HM2007} and examples. The connection to \cite{HM2007} and \cite{FPT} will become important only in future papers where we will consider the abstract concept of a system of inference rules and where binding signatures and the corresponding syntactic monads will become essential. 

In the present paper, after some general comments about monads on $Sets$ and their modules, we construct for any such monad $R$ and a left module $LM$ over $R$ a C-system (contextual category) $CC(\rr,\lm)$.  We start with a construction of a category ${C(\rr)}$ such that $Ob({C(\rr)})=\nn$ is the set of natural numbers whose elements we will denote as $\wh{m}$, $\wh{n}$ etc. and
%
$$Mor({C(\rr)})=\amalg_{\wh{m},\wh{n}}Hom_{Sets_R}(stn(n),stn(m))$$
%
and the identity and composition is defined such as to make the mapping $\wh{n}\mapsto stn(n)$ to extend to a fully faithful functor $cr_1$ from ${C(\rr)}^{op}$ to the Kleisli category $Sets_R$ of $R$.  We may sometimes  use this functor as a ``coercion'', in the terminology of proof assistant Coq, i.e., to write $\wh{n}$ instead of $stn(n)$ and $f$ instead of $\Phi(f)$. We will also use the function $LM\mapsto LM_R$ from left modules to functors on the Kleisli category as a coercion. In agreement with this convention we may write $LM$ for the presheaf of sets on ${C(\rr)}$ given by $\wh{n}\mapsto LM(n)$.  

We describe, using the results of \cite{Csubsystems}, all the C-subsystems of $CC(\rr,\lm)$ in terms of objects directly associated with $R$ and $LM$. 

We then define two additional operations $\sigma$ and $\wt{\sigma}$ on $CC(\rr,\lm)$ and describe the regular congruence relations (see \cite{Csubsystems}) on C-subsystems of $CC(\rr,\lm)$ which are compatible in a certain sense with $\sigma$ and $\wt{\sigma}$.

Such regular congruence relations correspond, in the particular cases of syntactic monads and C-subsystems of $CC(\rr,\lm)$ generated by systems of inference rules, to the relations that can be described by the two kinds of equality judgements. 

More precisely, suppose that we are given a type theory that is formulated in terms of the four kinds of judgements originally introduced by Per Martin-L\"{o}f in \cite[p.161]{MLTT79}\footnote{We are not using the notation based on $\rhd$ that became widespread in the modern literature on type theory since it conflicts with other uses of the turnstile symbol in logic.}:
%
$$(x_0:T_0,\dots,x_{n-1}:T_{n-1})\,T\,\,type$$
$$(x_0:T_0,\dots,x_{n-1}:T_{n-1})\,t:T$$
$$(x_0:T_0,\dots,x_{n-1}:T_{n-1})\,T=T'$$
$$(x_0:T_0,\dots,x_{n-1}:T_{n-1})\,t=t':T$$
%
to which one adds the judgement
%
$$(x_0:T_0,\dots,x_{n-1}:T_{n-1})\,ok$$
%
asserting that $(x_0:T_0,\dots,x_{n-1}:T_{n-1})$ is a valid context of variable declarations.

Since we are only interested in the $\alpha$-equivalence classes of judgements we may assume that the variables declared in the context are taken from the set of natural numbers such that the first declared variable is $0$, the second is $1$ etc.  Then, the set of judgements of the form 
%
$$(0:T_0,\dots,{n-1}:T_{n-1})\,T\,\,type$$
%
can be identified with the set of judgements of the form 
%
$$(0:T_0,\dots,{n-1}:T_{n-1}, n:T)\,ok$$
%
With this identification the derivable judgements of the type theory whose raw syntax for object expressions is given by a monad $R$ and raw syntax for type expressions by a left $R$-module $LM$, can be described as four subsets ${\wt{B}},{B},{Beq}$ and ${\wt{Beq}}$ where 
%
$${\wt{B}} \subset \coprod_{n\in\nat} LM(0)\times\dots\times LM(n-1)$$
$${B}\subset  \coprod_{n\in\nat} LM(0)\times\dots\times LM(n-1)\times R({stn(n)})\times LM(n)$$
$${Beq} \subset \coprod_{n\in\nat} LM(0)\times\dots\times LM(n-1)\times LM(n)^2$$
$${\wt{Beq}} \subset \coprod_{n\in\nat} LM(0)\times\dots\times LM(n-1)\times R({stn(n)})^2\times LM(n)$$ 
%

The sets on the right hand side of the first two of these inclusions are in the bijective correspondences with the sets $Ob(CC(\rr,\lm))$ and $\wt{Ob}(CC(\rr,\lm))$. It was shown in \cite[Proposition 4.3]{Csubsystems} that for any C-system $CC$, pairs $(B,\wt{B})$ where $B\subset Ob(CC)$ and $\wt{B}\subset \wt{Ob}(CC)$ that satisfy certain conditions are in a bijective correspondence with C-subsystems of $CC$. In Proposition \ref{2009.10.16.prop3} we give a direct reformulation of these conditions in the case of C-systems of the form $CC(\rr,\lm)$ in terms of subsets ${\wt{B}}$ and ${B}$ and in Remark \ref{2010.08.07.rem1} we show how these conditions look like in the notation of type theory. 

We then continue our analysis to provide a mathematical meaning to the subsets ${Beq}$ and ${\wt{Beq}}$ as well. In order to obtain a bijection of Proposition \ref{2014.07.10.prop2} between pairs of such subsets that satisfy certain properties and objects that have meaning for general C-systems we introduce operations $\sigma$ and $\wt{\sigma}$. 

Proposition \ref{2014.07.10.prop1} and subsequent lemmas culminating in Proposition \ref{2014.07.10.prop2} form what is probably the most important part of the paper. They provide, for the first time, a rigorous mathematical analysis of the conditions that the derivable definitional equality judgements of a type system have to satisfy in order to define well-behaved equivalence relation on the sets such as the sets of morphisms (context substitutions) of a type theory. 

While proving conditions of Proposition \ref{2014.07.10.prop1} in the case when ${\wt{B}}$, ${B}$, ${Beq}$ and ${\wt{Beq}}$ are the sets of derivable judgements of a particular type system is something that must be done in order to apply the results of the present paper to this type system, proving these conditions is much less difficult than giving a direct construction of a C-system starting from the syntax and the inference rules.

Providing this explicit set of conditions and proving that they are necessary and sufficient in order to associate a C-system and, therefore, any of the other semantic objects such as a category with families, to a particular type system may be considered to be the main result of this paper. 

\vspace{5mm}

The paper is written in the formalization-ready style with the intent to produce a UniMath formalization of its results in the near future. 

We also consider it to be important to formalize the results of this paper in HOL or Zermelo-Fraenkel theory. Indeed, since it forms a part of the theory on which the relative consistency of the UniMath language with respect to the set theory is based, it has to be formally verified in a theory that is weaker than UniMath or, better, that is weaker than both UniMath and the Zermelo-Fraenkel theory. However, the main choices that we had to make were made with the intent to first formalize this paper in the UniMath.

\vspace{5mm}

For morphisms $f:X\sr Y$ and $g:Y\sr Z$ we denote their composition as $f\circ g$. For functors $F:{\cal C}\sr {\cal C}'$, $G:{\cal C}'\sr {\cal C}''$ we use the standard notation $G\circ F$ for their composition. 

Following the notation of the proof assistant Coq we let $unit$ denote the distinguished one point set or type and $tt$ the only point of $unit$. 

This is one the papers extending the material which I started to work on in \cite{NTS}. I would like to thank the Institute Henri Poincare in Paris and the organizers of the ``Proofs'' trimester for their hospitality during the preparation of this paper. The work on this paper was facilitated by discussions with Richard Garner and Egbert Rijke. 

%###??? Make a note that we do not use dependent types in the paper which is why we can not simply write Hom(\wh{n},\wh{m})=R(stn(n))^{stn(m)}





\subsection{Pre-algebraic theories}
%
For two sets $X$ and $Y$ we let $Fun(X,Y)$ denote the set of functions from $X$ to $Y$. For $n\in\nat$ we let $stn(n)$ denote the ``standard'' set of $n$ elements $\{0,\dots,n-1\}$.
% 
\begin{definition}
\llabel{2015.08.17.def1}
A pre-algebraic theory is a collection of data of the following form
%
\begin{enumerate}
\item a function $R:\nn\sr Sets$,
\item for each $n$ a function $\eta_{n}\in Fun(stn(n),R(n))$,
\item for each $f\in Fun(stn(m),R(n))$ a function $\bind(f)\in Fun(R(m),R(n))$,
\end{enumerate}
%
such that the following conditions hold:
%
\begin{enumerate}
\item for all $n$, $\bind(\eta_n)=Id_{R(n)}$,
\item for all $f\in Fun(stn(m),stn(n))$, $\eta_m\circ \bind(f)=f$,
\item for all $f\in Fun(stn(k),R(m))$, $g\in Fun(stn(m),R(n))$, $\bind(f\circ \bind(g))=\bind(f)\circ \bind(g)$.
\end{enumerate}
%
\end{definition}
%
\begin{remark}\rm
\llabel{2015.08.19.rem2}
The type of pre-algebraic theories is equivalent to the type of clones as defined in \cite[Section 3]{FPT}. Whether this equivalence is an isomorphism in the syntactic category depends on how one formalizes expressions such as $X^n$ that are used in $\cite{FPT}$ but it is clear that these definitions are very close to each other. 
\end{remark} 
%

Let us introduce the following notation:
%
$$F(m,n)=Fun(stn(m),stn(n))$$
%
and, for a pre-algebraic theory $R$,
%
$$R(m,n)=Fun(stn(m),R(n))$$
%
Let ${\bf R}=(R,\eta,bind)$ be a pre-algebraic theory. For each pair $m,n\in\nn$ define a function
%
$$\phi_{\bf R}:F(m,n)\sr R(m,n)$$
%
by the formula
%
$$\phi_{\bf R}(f)=f\circ \eta_m$$
%
For each $l,m,n$ and $f\in R(l,m)$, $g\in R(m,n)$ define $f\hc g\in R(l,n)$ by the formula
%
\begin{eq}\llabel{2015.08.26.eq8}
f\hc g = f\circ \bind(g)
\end{eq}
%
\begin{lemma}
\llabel{2015.08.18.l1}
Let ${\bf R}=(R,\eta,\bind)$ be a pre-algebraic theory. Then one has:
%
\begin{enumerate}
\item for any $k,l,m,n$ and $f\in R(k,l)$, $g\in R(l,m)$, $h\in R(m,n)$ one has
%
$$(f\hc g)\hc h=f\hc(g\hc h)$$
%
\item for any $f\in R(m,n)$ one has
%
$$f\hc \eta_n=f$$
$$\eta_m\hc f=f$$
%
\item for any $f\in F(l,m)$, $g\in R(m,n)$ one has
%
$$\phi_{\bf R}(f)\hc g=f\circ g$$
%
\item for any $f\in F(l,m)$, $g\in F(m,n)$ one has
%
$$\phi_{\bf R}(f)\hc \phi_{\bf R}(g)=\phi_{\bf R}(f\circ g)$$
%
\end{enumerate}
\end{lemma}
%
\begin{proof}
\begin{enumerate}
\item We have
%
$$(f\hc g)\hc h=(f\circ \bind(g))\circ \bind(h)=f\circ (\bind(g)\circ \bind(h))=f\circ \bind(g\circ \bind(h))=f\hc (g\hc h)$$
%
\item We have
%
$$f\hc \eta_n=f\circ \bind(\eta_n)=f\circ Id_{R(n)}=f$$
$$\eta_m\hc f=\eta_m\circ \bind(f)=f$$
%
\item We have 
%
$$\phi_{\bf R}(f)\hc g=\phi_{\bf R}(f)\circ \bind(g)=f\circ \eta_m\circ \bind(g)=f\circ (\eta_m\circ \bind(g))=f\circ g$$
%
\item We have
%
$$\phi_{\bf R}(f)\hc \phi_{\bf R}(g)=f\circ \phi_{\bf R}(g)=f\circ g\circ \eta_n=(f\circ g)\circ \eta_n=\phi_{\bf R}(f\circ g)$$
%
\end{enumerate}
\end{proof}
%

We are going to use the functions $\phi_{\rr}$ as coercions in the terminology of the proof assistant Coq, i.e. when an element $f$ of $F(m,n)$ occurs in a position where an element of $R(m,n)$ should be it is assumed that $f$ has to be replaced by $\phi_{\rr}(f)$ before the computation can occur. We will also use $\bind$ as a coercion so that when an element $g$ of $R(m,n)$ occurs in a position where a function from $R(m)$ to $R(n)$ is expected it has to be replaced by $\bind(g)$ before the computation can occur. In practice, since many of our lemmas assert equalities between expressions where these coercions are not inserted, we will be using expressions without coercions inserted or with coercions only partially inserted in our computations but all the computations and proofs would remain valid if the coercions were fully inserted. 
%
%
\begin{remark}
\rm\llabel{2015.08.22.rem2}
We could also use the functions $\eta_n$ as coercions. This however would lead to an ambiguity of the following form. For $f\in R(m,n)$ and $i\in stn(m)$ we could read $f(i)$ both directly as the result of application of $f\in Fun(stn(m),R(n))$ to $i$ and as $\bind(f)(\eta_m(i))$. While the corresponding elements in $R(n)$ are equal they are equal because of the equality $\eta_m\circ \bind(f)=f$ from Definition \ref{2015.08.17.def1}. In the UniMath and other similar formalizations this equality is not a substitutional equality but only a transportational one and having the same expression to denote two objects that are not substitutionally equal is an ambiguity. See also Remark \ref{2015.08.30.rem3} below. 
\end{remark}
%
Since we will have to deal with elements of the sets of functions $R(m,n)=R(stn(n))^{stn(m)}$ and of similar sets such as the sets $Ob_n(CC(\rr,\lm))$ introduced later we need to choose some way to represent them. For the purpose of the present paper we will write such elements as sequences, i.e., to denote the function, which in the notation of $\lambda$-calculus is written as $\lambda\,i:stn(n), f_i$, we will write $(f_0,\dots,f_{n-1})$.
%
\begin{lemma}
\llabel{2015.08.26.l3}
Let $f\in R(l,m)$ and $g\in R(m,n)$ then for $i=0,\dots,n-1$ one has
%
\begin{eq}\llabel{2015.08.26.eq7}
(f\hc g)(i)=g(f(i))
\end{eq}
%
or, in the sequence notation
%
\begin{eq}\llabel{2015.08.24.eq1}
(f_0,\dots,f_{m-1})\hc g=(g(f_0),\dots,g(f_{m-1}))
\end{eq}
%
\end{lemma}
%
\begin{proof}
After we insert the coercions the equality (\ref{2015.08.26.eq7}) becomes
%
$$(f\hc g)(i)=\bind(g)(f(i))$$
%
which is equivalent to the definition (\ref{2015.08.26.eq8}) of $f\hc g$.
\end{proof}
% 
\begin{lemma}
\llabel{2015.08.30.l1}
Let $f\in F(l,m)$, $g\in R(m,n)$ and $i\in stn(l)$. Then one has
%
\begin{eq}\llabel{2015.08.26.eq4}
(f\hc g)(i)=g(f(i))
\end{eq}
% 
\end{lemma}
%
\begin{proof}
Inserting coercions we get the goal
%
$$(\phi_{\rr}(f)\hc g)(i)=g(f(i))$$
%
which follows by application of Lemma \ref{2015.08.18.l1}(3).
\end{proof}
%
\begin{remark}\rm
\llabel{2015.08.30.rem3}
In the UniMath, or any similar, formalization there is a difference between the equalities of Lemmas \ref{2015.08.26.l3} and \ref{2015.08.30.l1}. The equality of the first lemma is obtained by unfolding the definitions of $\hc$ and of $\circ$. As such it is a substitutional equality which can be used to directly substitute the left hand side of (\ref{2015.08.26.eq7}) for the right hand side and vice versa. The equality of the second lemma is obtained by unfolding definitions and then applying the equality of Definition \ref{2015.08.17.def1}. As a declared equality it is only a transportational one which makes it impossible to use it to directly substitute one hand side of the equality for another. Instead a special ``transport'' function has to be used. 

In this paper we will not distinguish between the two types of equality in part because this distinction is non-existent in either the Zermelo-Fraenkel theory or HOL. Nevertheless, some of our choices, such as the one explained in Remark \ref{2015.08.22.rem2}, have been affected by the existence of this distinction. 
\end{remark}
%



For $n\in\nat$ and $i=0,\dots,n-1$ let
%
$$x_i^n=\eta_n(i)\in R(n)$$
%
then for $f\in R(n,m)$ we have
%
\begin{eq}\llabel{2015.08.24.eq2}
f(x_i^n)=\bind(f)(\eta_n(i))=f(i)
\end{eq}
%
In our sequence notations, for an element $x$ of a set $X$, the expression $(x)$ denotes the function $stn(1)\sr X$ that takes $0$ to $x$. With this fact in mind observe also that for $f\in R(n,m)$ one has
%
\begin{eq}\llabel{2015.08.24.eq5}
(x_i^n)\hc f=f(x_i^n)=f(i)
\end{eq}
%
where the first equality is by  (\ref{2015.08.24.eq1}) and the second one by (\ref{2015.08.24.eq2}). 


Let 
%
$$\partial^{i}_{n}:stn(n)\sr stn(n+1)$$
%
for $0\le i\le n$ be the increasing inclusion that does not take the value $i$ and
%
$$\sigma^{i}_{n}:stn(n+2)\sr stn(n+1)$$
%
for $0\le i\le n$ be the increasing surjection that takes the value $i$ twice. Taking into account that, in the notation of \cite{GabZis}, $[n]=stn(n+1)$ these are the standard generators of the simplicial category $\Delta$ together with $\partial^0_0:stn(0)\sr stn(1)$. 

In our sequence notation we have
%
\begin{eq}\llabel{2015.08.24.eq7}
\phi_{\rr}(\partial^{i}_{n})=(x_0^{n+1},\dots,x_{i-1}^{n+1},x_{i+1}^{n+1},\dots,x_n^{n+1})
\end{eq}
%
and
%
\begin{eq}\llabel{2015.08.24.eq8}
\phi_{\rr}(\sigma^{i}_{n})=(x_0^{n+1},\dots,x_{i-1}^{n+1},x_i^{n+1},x_i^{n+1},x_{i+1}^{n+1},\dots,x_n^{n+1})
\end{eq}
%
in particular
%
\begin{eq}\llabel{2015.07.12.eq5}
\phi_{\rr}(\partial^{n}_n)=(x_0^{n+1},\dots,x_{n-1}^{n+1})
\end{eq}
%

Let 
%
$${\iota}_n^{i}:stn(n)\sr stn(n+i)$$
%
be the function given by ${\iota}_n^i(j)=j$ for $j=0,\dots,n-1$. Note that we have
%
\begin{eq}
\llabel{2015.08.22.eq7}
{\iota}_n^{1}=\partial_{n}^{n}
\end{eq}
%
and
%
\begin{eq}
\llabel{2015.08.22.eq8}
{\iota}_n^i(x^n_j)=\bind(\phi_{\rr}(\iota_n^i))(\eta_n(j))=(\eta_n\circ \bind(\phi_{\rr}(\iota_n^i)))(j)=$$$$\phi_{\rr}(\iota_n^i)(j)=\eta_{n+i}(\iota_n^i(j))=\eta_{n+i}(j)=x^{n+i}_j
\end{eq}
%
\begin{lemma}
\llabel{2015.08.26.l1}
Let $f\in R(n+1,n)$. Then $\iota_n^1\hc f=\eta_n$ if and only if $f(i)=x_n^i$ for $i=0,\dots,n-1$. 
\end{lemma}
%
\begin{proof}
For $i=0,\dots,n-1$ we have
%
$$x_n^i=\eta_n(i)=(\iota_n^1\hc f)(i)=f(\iota_n^1(i))=f(i)$$
%
\end{proof}
%
For $f\in R(n,m)$, $f=(f_0,\dots,f_{n-1})$ define an element $qq(f)\in R(n+1,m+1)$ by the formula: 
%
\begin{eq}\llabel{2015.08.26.eq9}
qq(f)=(\iota_m^1(f_0),\dots,\iota_m^1(f_{n-1}),x_m^{m+1})
\end{eq}
%
\begin{lemma}
\llabel{2015.08.26.l2}
For $i\in\nat$ and $f=(f_0,\dots,f_{n-1})$ in $R(n,m)$ one has
%
$$qq^i(f)=(\iota_m^i(f_0),\dots,\iota_m^i(f_{n-1}),x_m^{m+i},\dots,x_{m+i-1}^{m+i})$$
%
\end{lemma}
%
\begin{proof}
Straightforward by induction on $i$.
\end{proof}
%
\begin{lemma}
\llabel{2015.08.26.l3a}
For $n,i\in\nat$ one has
%
$$qq^i(\iota_n^1)=\partial^n_{n+i}$$
%
\end{lemma}
%
\begin{proof}
Inserting coercions we see that we have to prove that
%
$$qq^i(\phi_{\rr}(\iota_n^1))=\phi_{\rr}(\partial_n^{n+i})$$
%
We have $\phi_{\rr}(\iota_n^1)=(x_0^{n+1},\dots,x^{n+1}_{n-1})$. By Lemma \ref{2015.08.26.l2} and (\ref{2015.08.22.eq8}) we get
%
$$qq^i(\phi_{\rr}(\iota_n^1))=(\iota_{n+1}^i(x_0^{n+1}),\dots,\iota_{n+1}^i(x_{n-1}^{n+1}),x_{n+1}^{n+1+i},\dots,x_{n+i}^{n+1+i})=$$
$$=(x_0^{n+1+i},\dots,x_{n-1}^{n+1+i},x_{n+1}^{n+1+i},\dots,x_{n+i}^{n+1+i})=\phi_{\rr}(\partial_n^{n+i})$$
%
where the last equality is (\ref{2015.08.24.eq7}). 
\end{proof}
%
\begin{lemma}
\llabel{2015.08.28.l1}
For $i,m\in\nat$ and $r\in R(m)$ one has
%
$$qq^i(x_0^m,\dots,x^m_{m-1},r)=(x_0^{m+i},\dots,x^{m+i}_{m-1},\iota_m^i(r),x_m^{m+i},\dots,x_{m+i-1}^{m+i})$$
%
\end{lemma}
%
\begin{proof}
One has
%
$$qq^i(x_0^m,\dots,x^m_{m-1},r)=(\iota_m^i(x_0^m),\dots,\iota_m^i(x^m_{m-1}),\iota_m^i(r),x_m^{m+i},\dots,x_{m+i-1}^{m+i})=$$
$$(x_0^{m+i},\dots,x^{m+i}_{m-1},\iota_m^i(r),x_m^{m+i},\dots,x_{m+i-1}^{m+i})=$$
%
where the first equality is by Lemma \ref{2015.08.26.l2} and the second one by (\ref{2015.08.22.eq8}). 
\end{proof}


Define, for any pre-algebraic theory $\rr$, an operation $\sigma_{\rr}$ such that form $m,n\in\nat$, $n>m$ and $r\in R(m)$, $s\in R(n)$ one has
%
\begin{eq}
\llabel{2015.09.07.eq1}
\sigma_{\rr}(m,r,n,s)=qq^{n-m-1}(x_0^m,\dots,x_{m-1}^m,r)(s)=$$
$$(x_0^{n-1},\dots,x_{m-1}^{n-1},\iota_{m}^{n-m-1}(r),x_m^{n-1},\dots,x_{n-2}^{n-1})(s)
\end{eq}
%
This operation is a {\em dependent} function of the form
%
$$\sigma_{\rr}:\{m\in\nat,r\in R(m),n\in\nat,s\in R(n)\,|\,n>m\}\sr R(n-1),$$
%
i.e., a function whose codomain depends on the argument. 

In the Zermelo-Fraenkel theory this can be expressed as follows. Let us fix a universe $UU$. Then a dependent function ${\bf f}$ with a domain $dom$ is a pair of functions $codom:dom\sr UU$ and $f:dom\sr UU$ such that for all $x\in dom$ one has $f(x)\in codom(x)$.  Introducing a third parameter $U$ instead of a fixed universe $UU$ and taking equivalence classes with respect to the obvious relation obtained from inclusions $U\subset U'$ one can define dependent functions in set theory without using a universe. 

In the language of UniMath and other similar ``dependently typed '' languages there is a syntactic mechanism for working with variable codomains of functions which are called type families. In such languages $\sigma_{\rr}$ can be directly defined as dependent function with the codomain family given by  $codom(\sigma_{\rr})(m,r,n,s)=R(n-1)$. 

Of the four arguments $m,r,n$ and $E$ of $\sigma_{\rr}$ we will use $m$ and $n$ as implicit arguments, that is, arguments that are not written explicitly because they often can be inferred from the remaining arguments by a simple algorithmic procedure. In cases when $m$ and $n$ can not be inferred from $r$ and $E$, which we will not encounter in this paper, the syntax of the proof assistant Coq is to write $@\sigma_{\rr}$ instead of $\sigma_{\rr}$ and to supply all four arguments explicitly. 



\subsection{Free pre-algebraic theories}
%
The goal of this section is to show how to assign to any concrete type theory a pre-algebraic theory and how to characterize this pre-algebraic theory by its universal properties.  

The approach that we use is essentially a re-writing of some of the results of \cite{FPT} and \cite{HM2007} in terms of pre-algebraic theories. 

The construction first assigns to a concrete type theory a binding signature. A binding signature, a concept introduced by Peter Aczel in \cite{Aczel},  is a finite set of data - a sequence of sequences of natural numbers. We will show which sequences correspond to the pre-algebraic theories corresponding to such  type theories as the Martin-Lof type theories MLTT72 and MLTT79.

The other is to characterize these pre-algebraic theories by their universal properties. 

???



\subsection{The C-system $C(\rr)$}
%

Define a category $C(\rr)$ as follows. $Ob(C(\rr))=\nn$ is the set of natural numbers. The set of morphisms of $C(\rr)$ is given by
%
$$Mor(C(\rr))=\amalg_{m,n\in\nn}R(n,m)$$
%
with the obvious domain and codomain functions. To distinguish the positions in formulas where natural numbers are used as objects of $C(\rr)$ we will write in such places $\wh{m}$ instead of $m$, $\wh{n}$ instead of $n$ etc.  

The composition of morphisms is defined by the formula
%
$$(\wh{k},(\wh{m},f))\circ (\wh{m},(\wh{n},g))=(\wh{k},(\wh{n},f\hc g))$$
%
and the identity morphisms by the formula
%
\begin{eq}
\llabel{2015.08.22.eq4}
Id_{\wh{n}}=(\wh{n},(\wh{n},\eta_n))=(\wh{n},(\wh{n},(x_0^n,\dots,x^n_{n-1})))
\end{eq}
%
%
The axioms of a category follow from Lemma \ref{2015.08.18.l1}(1,2). 

We also consider the precategory $F$ with the set of objects $Ob(F)=\nn$ and the set of morphisms given by
%
$$Mor(F)=\amalg_{n,m}F(n,m)$$
%
The domain and codomain functions are obvious and the identity morphisms and compositions are defined by identity functions and compositions of functions between the standard finite sets. 

The identity function on $\nn$ together with the mapping
%
$$(\Phi_{\rr})_{Mor}:(n,(m,f))\mapsto (\wh{m},(\wh{n},\phi_{\rr}(f)))$$
%
defines, in view of the obvious equality $\phi_{\rr}(Id_{\wh{n}})=\eta_{n}$ and Lemma \ref{2015.08.18.l1}(3), a functor
%
$$\Phi_{\rr}:F^{op}\sr C(\rr)$$
%
(i.e., a contravariant functor from $F$ to $C(\rr)$). 
%
\begin{remark}\rm
\llabel{2015.08.19.rem1}
The pair $(C(\rr)^{op},\Phi^{op}_{\rr})$ is an algebraic theory in the sense of Lawvere (cf. \cite[Definition on p.62]{Lawvere}). It should be possible to prove, as noted in \cite[after Theorem 3.3]{FPT}, that the function $\rr\mapsto (C(\rr)^{op},\Phi^{op}_{\rr})$ is an equivalence between pre-algebraic theories and algebraic theories. 
\end{remark}
%

For $n\in\nat$, let $ft(\wh{n+1})=\wh{n}$ and let $ft(\wh{0})=\wh{0}$.

For $n\in\nat$, let $p_{\wh{n+1}}:\wh{n+1}\sr \wh{n}$ be the morphism $(\wh{n+1},(\wh{n},\iota_n^1))$,
where we have used our coercion convention to write $\iota_n^1$ instead of $\phi_{\rr}(\iota_n^1)$. In the sequence notation we have
%
\begin{eq}\llabel{2015.08.24.eq6}
p_{\wh{n+1}}=(\wh{n},(\wh{n+1},(x_0^{n+1},\dots,x_{n-1}^{n+1})))
\end{eq}
%
Let  $p_{\wh{0}}=Id_{\wh{0}}$.
%
\begin{lemma}
\llabel{2015.07.24.l1}
One has:
%
\begin{enumerate}
\item Let $f=(\wh{m},(\wh{n+1},ff))$, where $ff=(f_0,\dots,f_n)$, be a morphism. Then 
%
$$f\circ p_{\wh{n+1}}=(\wh{m},(\wh{n},(f_0,\dots,f_{n-1})))$$
%
\item Let $f=(\wh{m},(\wh{n},ff))$, where $ff=(f_0,\dots,f_{n-1})$, be a morphism. Then 
%
$$p_{\wh{m+1}}\circ f=(\iota_m^1(f_0),\dots,\iota_m^1(f_{n-1}))$$
%
\end{enumerate}
\end{lemma}
%
\begin{remark}\rm
\llabel{2015.08.18.rem2}
In the second assertion of the lemma we use our coercion convention in the right hand side of the equality. The full form of the expressions $\iota_m^1(f_i)$ that we use there are $\bind(\phi_{\rr}(\iota_m^1))(f_i)$.
\end{remark}
%
\begin{proof}
The first assertion follows by unfolding definitions from (\ref{2015.08.26.eq4}). 

The second asserting follows by unfolding definitions from (\ref{2015.08.24.eq1}). 
\end{proof}
%
\begin{lemma}
\llabel{2015.08.20.l1}
For any $n\in\nat$ the square
%
\begin{eq}\llabel{2015.08.20.eq3}
\begin{CD}
\wh{n+1} @>(\wh{n+1},(\wh{1},(x_n^{n+1})))>> 1\\
@Vp_{\wh{n+1}}VV @VVp_{\wh{1}}V\\
\wh{n} @>(\wh{n},(\wh{0},()))>> 0
\end{CD}
\end{eq}
%
is a pull-back square in $C(\rr)$.
\end{lemma}
%
\begin{proof}
Since $\wh{0}$ is a final object, we need to check that for any $m$ the function
%
$$Hom_{C(\rr)}(\wh{m},\wh{n+1})\sr Hom_{C(\rr)}(\wh{m},\wh{n})\times Hom_{C(\rr)}(\wh{m},\wh{1})$$
%
given by $(\wh{m},(\wh{n+1},f))\mapsto (((\wh{m},(\wh{n+1},f))\circ p_{\wh{n+1}}),((\wh{m},(\wh{n+1},f))\circ (x_n^{n+1})))$, is a bijection. This function is isomorphic to the function
%
$$f\mapsto ((\iota_n^1\hc f),(x_n^{n+1}\hc f))$$
%
that can be further computed using (\ref{2015.08.26.eq4}) and (\ref{2015.08.24.eq5}) to be equal to the function 
%
$$(f_0,\dots,f_{n})\sr ((f_0,\dots,f_{n-1}), (f_n))$$
%
that is clearly a bijection. 
\end{proof}
%
Given a morphism $f=(\wh{m},(\wh{n},ff)):\wh{m}\sr \wh{n}$ in $C(\rr)$ set
%
\begin{eq}
\llabel{2015.08.26.eq1}
f^*(\wh{n+1})=\wh{m+1}
\end{eq}
%
and define a morphism $q(f):\wh{m+1}\sr \wh{n+1}$ as  
%
\begin{eq}
\llabel{2015.08.22.eq1}
q(f)=(\wh{m+1},(\wh{n+1},qq(ff)))
\end{eq}
% 
where $qq(ff)$ is defined in (\ref{2015.08.26.eq9}).
%
\begin{lemma}
\llabel{2015.08.18.l4}
For any $f$ as above the square
%
\begin{eq}\llabel{2015.08.20.eq2}
\begin{CD}
\wh{m+1} @>q(f)>> \wh{n+1}\\
@Vp_{\wh{m+1}}VV @Vp_{\wh{n+1}}VV\\
\wh{m} @>f>> \wh{n}
\end{CD}
\end{eq}
%
is a pull-back square.
\end{lemma}
%
\begin{proof}
Let us show first that this square commutes. We need to show that for each $i=0,\dots, n-1$ one has
%
$$(\iota_n^1\hc qq(ff))(i)=(ff\hc \iota_m^1)(i)$$
%
We have
%
$$(\iota_n^1\hc qq(ff))(i)=qq(ff)(i)=\iota_m^1(ff(i))$$
%
where the first equality is by (\ref{2015.08.26.eq4}) and the second equality by definition of $qq(ff)$. On the other hand
%
$$(ff\hc \iota_m^1)(i)=\iota_m^1(ff(i))$$
%
by (\ref{2015.08.26.eq7}).  To show that the square (\ref{2015.08.20.eq2}) is a pull-back square let us consider the diagram
%
$$
\begin{CD}
\wh{m+1} @>q(f)>> \wh{n+1} @>(\wh{n+1},(\wh{1},(x_n^{n+1})))>> \wh{1}\\
@Vp_{\wh{m+1}}VV @Vp_{\wh{n+1}}VV @VVp_{\wh{1}}V\\
\wh{m} @>f>> \wh{n} @>(\wh{n},(\wh{0},()))>> 0
\end{CD}
$$
%
We have
%
\begin{eq}\label{2015.08.20.eq4}
q(f)\circ (\wh{n+1},(\wh{1},(x_n^{n+1})))=(\wh{m+1},(\wh{1},(x_n^{n+1})\hc qq(ff)))=(\wh{m+1},(\wh{1},(x_m^{m+1})))
\end{eq}
%
where the second equality is by (\ref{2015.08.24.eq5}). Therefore the outer square of this diagram is of the form (\ref{2015.08.20.eq3}) and therefore is a pull-back square by Lemma \ref{2015.08.20.l1}. The right hand side square of this diagram is of the same form and therefore is a pull-back square as well. The left hand side square commutes. Therefore the left hand side square is a pull-back square by the general properties of pull-back squares.
\end{proof}
%
\begin{problem}
\llabel{2015.08.20.prob1}
To construct a structure of a C-system on the category $C(\rr)$.
\end{problem}
%
\begin{construction}\rm
\llabel{2015.08.20.constr1}
For the definition of the C-system that we will use see \cite[Def. 2.1 and Def. 2.3]{Csubsystems}. 

The length function is the identity function $Ob(C(\rr))\sr \nn$. 

The object $pt$ is $\wh{0}$. 

The $ft$ function was defined above. 

The morphisms $p_{\wh{n}}$ were defined above. 

The objects $f^*(X)$ were defined above. 

One defines $q(f,X)$ as $q(f)$. 

The first four properties of \cite[Def. 2.1]{Csubsystems} are obvious. 

The fifth property is the commutativity part of Lemma  \ref{2015.08.18.l4}. 

The sixth property is obvious. 

To prove the seventh property consider $g=(\wh{k},(\wh{m},gg))$ and $f=(\wh{m},(\wh{n},ff))$. We need to show that
%
$$q(g)\circ q(f)=q(g\circ f)$$
%
Consider the diagram
%
$$
\begin{CD}
\wh{k+1} @>q(g)>> \wh{m+1} @>q(f)>> \wh{n+1} @>(\wh{n+1},(\wh{1},(x_n^{n+1})))>> \wh{1}\\
@Vp_{\wh{k+1}}VV @Vp_{\wh{m+1}}VV @Vp_{\wh{n+1}}VV @VVp_{\wh{1}}V\\
\wh{k} @>g>> \wh{m} @>f>> \wh{n} @>(\wh{n},(\wh{0},()))>> \wh{0}
\end{CD}
$$
%
Since the rightmost square is a pull-back square it is sufficient to prove that
%
$$q(g)\circ q(f)\circ p_{\wh{n+1}}=q(g\circ f)\circ p_{\wh{n+1}}$$
%
and
%
$$q(g)\circ q(f)\circ (\wh{n+1},(\wh{1},(x_n^{n+1})))=q(g\circ f)\circ (\wh{n+1},(\wh{1},(x_n^{n+1})))$$
%
The first equality follows from the commutativity of the left hand side and central squares of the diagram and the commutativity of the square (\ref{2015.08.20.eq2}) for $g\circ f$. For the second equality we have
%
$$q(g)\circ q(f)\circ (\wh{n+1},(\wh{1},(x_n^{n+1})))=q(g)\circ (\wh{m+1},(\wh{1},(x_m^{m+1})))=(\wh{k+1},(\wh{1},(x_k^{k+1})))$$
%
and
%
$$q(g\circ f)\circ (\wh{n+1},(\wh{1},(x_n^{n+1})))=(\wh{k+1},(\wh{1},(x_k^{k+1})))$$
%
where all three equalities are of the form (\ref{2015.08.20.eq4}). This completes the construction of the structure of a  C0-system on $C(\rr)$. To extend it to the structure of a C-system we can apply \cite[Prop. 2.4]{Csubsystems} and Lemma \ref{2015.08.18.l4}. 
\end{construction}
%
Recall that for a C-system $CC$, and object $\Gamma$ of $CC$ such that $l(\Gamma)\ge i$ we let $p_{\Gamma,i}$ denote the morphism $\Gamma\sr ft^i(\Gamma)$ defined inductively as
%
$$p_{\Gamma,0}=Id_{\Gamma}$$
$$p_{\Gamma,i+1}=p_{\Gamma}\circ p_{ft(\Gamma),i}$$
%
For $\Gamma$ as above and $f:\Gamma'\sr ft^i(\Gamma)$ we let $f^*(\Gamma,i)$ and 
%
$$q(f,\Gamma,i):f^*(\Gamma,i)\sr \Gamma$$ 
%
define a pair of an object and a morphism defined inductively as
%
$$f^*(\Gamma,0)=\Gamma'\spc q(f,\Gamma,0)=f$$
$$f^*(\Gamma, i+1)=q(f,ft(\Gamma),i)^*(\Gamma)\spc q(f,\Gamma,i+1)=q(q(f,ft(\Gamma),i),\Gamma)$$
%

For $\Gamma,\Gamma'$ in a C-system let us write $\Gamma\le \Gamma'$ if $l(\Gamma)\le l(\Gamma')$ and $\Gamma=ft^{l(\Gamma')-l(\Gamma)}(\Gamma')$. We will write $\Gamma<\Gamma'$ if $\Gamma\le \Gamma'$ and $l(\Gamma)<l(\Gamma')$. 

If $\Gamma'$ is over $\Gamma$ we will denote by $p_{\Gamma',\Gamma}$ the morphism
%
$$p_{\Gamma',l(\Gamma')-l(\Gamma)}:\Gamma'\sr \Gamma$$
%
If $\Gamma'$ and $\Gamma''$ are over $\Gamma$ then we have morphisms 
%
$$p_{\Gamma',\Gamma}:\Gamma'\sr \Gamma$$
$$p_{\Gamma'',\Gamma}:\Gamma''\sr\Gamma$$
%
and we say that a morphism $f:\Gamma'\sr \Gamma''$ is over $\Gamma$ if 
%
$$f\circ p_{\Gamma,\Gamma''}=p_{\Gamma,\Gamma'}$$
%
If $\Gamma'$ is an object over $\Gamma$ and  $f:\Delta\sr \Gamma$ is a morphism then let us denote simply by $f^*(\Gamma')$ the object $f^*(\Gamma',n)$ where $n=l(\Gamma')-l(\Gamma)$. Note that $n$ can always be inferred from $f$ and $\Gamma'$. 

Similarly we will write simply $q(f,\Gamma)$ for $q(f,\Gamma,n)$ since $n$ can be inferred as $l(\Gamma)-l(codom(f))$. 
%
\begin{lemma}
\llabel{2015.08.23.l1a}
Let $\Gamma',\Gamma''$ be objects over $\Gamma$, $a:\Gamma'\sr \Gamma''$ a morphism over $\Gamma$ and $f:\Delta\sr \Gamma$ a morphism. Then there is a unique morphism $f^*(a):f^*(\Gamma')\sr f^*(\Gamma'')$ over $\Delta$ such that the square
%
$$
\begin{CD}
f^*(\Gamma') @>q(f,\Gamma')>> \Gamma'\\
@Vf^*(a)VV @VVaV\\
f^*(\Gamma'') @>q(f,\Gamma'')>> \Gamma''
\end{CD}
$$
%
commutes.
\end{lemma}
%
\begin{proof}
We have a square
%
\begin{eq}\llabel{2015.08.23.eq3}
\begin{CD}
f^*(\Gamma'') @>q(f,\Gamma'')>> \Gamma''\\
@Vp_{f^*(\Gamma''),\Delta}VV @VVp_{\Gamma'',\Delta}V\\
\Delta @>f>> \Gamma\\
\end{CD}
\end{eq}
%
This square is a pull-back square as a vertical composition of $l(\Gamma'')-l(\Gamma)$ pull-back squares. We define $f^*(a)$ as the unique morphism such that 
%
\begin{eq}\llabel{2015.08.23.eq1}
f^*(a)\circ q(f,\Gamma'')=q(f,\Gamma')\circ a
\end{eq}
%
and
%
\begin{eq}\llabel{2015.08.23.eq2}
f^*(a)\circ p_{f^*(\Gamma''),\Delta}=p_{f^*(\Gamma'),\Delta}
\end{eq}
%
The first of these two equalities is equivalent to the commutativity of the square (\ref{2015.08.23.eq3}) and the second to the condition that $f^*(a)$ is a morphism over $\Delta$.
\end{proof}
%
\begin{lemma}
\llabel{2015.08.29.l2}
Let $a:\Gamma'\sr\Gamma''$ be a morphism over $\Gamma$, $\Gamma'''$ another object over $\Gamma$ and suppose that $a$ is a morphism over $\Gamma'''$. Let $f:\Delta\sr \Gamma$ be a morphism. Then one has
%
\begin{eq}\llabel{2015.08.29.eq2}
f^*(a)=q(f,\Gamma''')^*(a)
\end{eq}
%
\end{lemma}
%
\begin{proof}
The morphisms involved in the proof can be seen on the diagram
%
$$
\begin{CD}
f^*(\Gamma') @>q(f,\Gamma')>> \Gamma'\\
@Vf^*(a)VV @VVaV\\
f^*(\Gamma'') @>q(f,\Gamma'')>> \Gamma''\\
@Vp_{f^*(\Gamma''),f^*(\Gamma''')}VV @VVp_{\Gamma'',\Gamma'''}V\\
f^*(\Gamma''') @>q(f,\Gamma''')>> \Gamma'''\\
@Vp_{f^*(\Gamma'''),\Delta}VV @VVp_{\Gamma''',\Gamma}V\\
\Delta @>f>> \Gamma
\end{CD}
$$
%
The right hand side of (\ref{2015.08.29.eq2}) is a morphism over $f^*(\Gamma''')$ and therefore a morphism over $\Delta$. It remains to verify that it satisfies equation (\ref{2015.08.23.eq1}). This follows immediately from its definition. 
\end{proof}

Let us describe the constructions introduced above in the case of $C(\rr)$. Note that our wide-hat notation that distinguishes the places in formulas where natural numbers are used as objects of $C(\rr)$ allows us to avoid the ambiguity that might have arisen otherwise. For example $p_{n',n}$ could be understood either as the canonical morphism $n'\sr n$ using the notation $p_{\Gamma',\Gamma}$ introduced above or as the canonical morphism $n'\sr n'-n$ using the notation $p_{\Gamma,i}$ that we have used in \cite{Csubsystems}.  The use of the wide-hat diacritic allows to distinguish between $p_{\wh{n'},\wh{n}}$ - a morphism $\wh{n'}\sr \wh{n}$,  and $p_{\wh{n'},n}$ - a morphism $\wh{n'}\sr \wh{n'-n}$. 



\begin{lemma}
\llabel{2015.08.22.l6}
Let $n,i\in\nat$. 
%
\begin{enumerate}
\item One has
%
\begin{enumerate}
\item $p_{\wh{n+i},i}=(\wh{n+i},(\wh{n},(x_0^n\dots,x_{n-i-1}^n))=(\wh{n+i},(\wh{n},\iota^{n+i}_{n}))$,
\item for $g=(\wh{n'},(\wh{n+i},(g_0,\dots,g_{n+i-1})))$ one has $g\circ p_{\wh{n+i},i}=(\wh{n'},(\wh{n},(g_0,\dots,g_{n-1})))$,
\end{enumerate}
%
\item for $f=(\wh{m},(\wh{n},ff)$ one has
%
$$f^*(\wh{n+i},i)=m+i$$
%
and
%
$$q(f,\wh{n+i},i)=q^i(f)=(\wh{m+i},(\wh{n+i},qq^i(ff)))$$
%
where $q^i(f)$ is the $i$-th iteration of $q$ applied to $f$.  
\end{enumerate}
\end{lemma}
%
\begin{proof}
All three assertions a proved by induction on $i$. For the first assertion both parts are proved by induction simultaneously. One has
%
\begin{enumerate}
\item the case $i=0$ is (\ref{2015.08.22.eq4}) and the identity axiom of the category $C(\rr)$,
\item for the successor of $i$ we have
%
$$p_{\wh{n+i+1},i+1}=p_{\wh{n+i+1}}\circ p_{\wh{n+i},i}=(\wh{n+i+1},(\wh{n},(x_0^n,\dots,x_{n-1}^n)))$$
%
where the second equality is by the second part of the inductive assumption. For the inductive step in the second part we have
%
$$(\wh{n'},(\wh{n+i+1},(g_0,\dots,g_{n+i})))\circ p_{\wh{n+i+1},i+1}=(\wh{n'},(\wh{n+i+1},(g_0,\dots,g_{n+i})))\circ p_{\wh{n+i+1}}\circ p_{\wh{n+i},i}=$$$$
(\wh{n'},(\wh{n+i},(g_0,\dots,g_{n+i-1})))\circ p_{\wh{n+i},i}=(\wh{n'},(\wh{n},(g_0,\dots,g_{n-1})))$$
%
\end{enumerate}
%
The proof of the first part of the second assertion is obvious. For the second part we have:
%
\begin{enumerate}
\item for $i=0$ the assertion is obvious,
\item for the successor of $i$ we have 
%
$$q(f,\wh{n},i+1)=q(q(f,\wh{n-1},i))=q(q^i(f))$$
%
and 
$$q(q^i(f))=q((\wh{m+i},(\wh{n+i},qq^i(ff)))=(\wh{m+i+1},(\wh{n+i+1},qq^{i+1}(ff)))$$
%
\end{enumerate}
%
\end{proof}
%

%
\begin{lemma}
\llabel{2015.08.22.l7}
Let $f=(\wh{n},(\wh{n+1},(f_0,\dots,f_n)))$. Then $f\circ p_{\wh{n+1}}=Id_{\wh{n}}$ if and only if $f_i=x_i^{n+1}$ for $i=0,\dots,n-1$.
\end{lemma}
%
\begin{proof}
It follows immediately from Lemma \ref{2015.08.26.l1}.
\end{proof}
%
\begin{lemma}
\llabel{2015.09.09.l1}
Let $f=(\wh{m},(\wh{n},(f_0,\dots,f_{n-1}))$ where $n>0$. Then one has
%
$$s_f=(\wh{m},(\wh{m+1},(x_0^m,\dots,x_{m-1}^m,f_{n-1})))$$
%
\end{lemma}
%
\begin{proof}
By \cite[Definition 2.3(2)]{Csubsystems} we have that 
%
$$s_f\circ p_{\wh{m+1}}=Id_{\wh{m}}$$
%
Therefore, by Lemma \ref{2015.08.22.l7}, it is of the form $(\wh{m},(\wh{m+1},(x_0^m,\dots,x_{m-1}^m,sf)))$ for some $sf\in R(m)$. By \cite[Definition 2.3(3)]{Csubsystems} we have $f=s_f\circ q(ft(f))$ where $ft(f)=f\circ p_{\wh{n}}$. By Lemma \ref{2015.07.24.l1}(1) we have $ft(f)=(\wh{m},(\wh{n-1},(f_0,\dots,f_{n-1})))$ and by (\ref{2015.08.22.eq1}) and (\ref{2015.08.26.eq9}) we have that 
%
$$q(ft(f))=(\wh{m+1},(\wh{n},(\iota_m^1(f_0),\dots,\iota_m^1(f_{n-2}),x_{m}^{m+1})))$$
%
Therefore, by (\ref{2015.08.24.eq1}) we should have
%
$$(f_0,\dots,f_{n-1})=(\iota_m^1(f_0),\dots,\iota_m^1(f_{n-2}),x_{m}^{m+1})\hc (x_0^m,\dots,x_{m-1}^m,sf)$$
%
which is equivalent to 
%
$$f_i=(x_0^m,\dots,x_{m-1}^m,sf)(\iota_m^1(f_i))$$
%
for $i=0,\dots,n-2$ and 
%
$$f_{n-1}=(x_0^m,\dots,x_{m-1}^m,sf)(x_{m}^{m+1})$$
%
The first series of equalities follow for any $sf$ from (\ref{2015.08.26.eq7}) since 
%
$$\iota_m^1\hc (x_0^m,\dots,x_{m-1}^m,sf)=(x_0^m,\dots,x_{m-1}^m)$$
%
The last equality gives us, by (\ref{2015.08.24.eq5}) that $f_{n-1}=sf$.
\end{proof}
%






Recall from \cite{Csubsystems} that for a C-system $CC$ one defines $\wt{Ob}(CC)$ as the subset of $Mor(CC)$ which consists of morphisms $s$ of the form $ft(X)\sr X$ such that $l(X)>0$ and $s\circ p_X=Id_{ft(X)}$. 
%
\begin{lemma}
\llabel{2015.08.24.l1}
Let $f=(\wh{m},(\wh{n},ff))$ and let $s=(\wh{n},(\wh{n+1},ss))$ be an element of $\wt{Ob}$. Then one has
%
$$f^*(s)=(\wh{m},(\wh{m+1},fs))$$
%
where 
%
$$fs=(x_0^m,\dots,x_{m-1}^m,ff(ss_n))$$
%
\end{lemma}
%
\begin{proof}
The fact that the first $m$ terms of the sequence representation of $fs$ have the required form follows from Lemma \ref{2015.08.22.l7}. It remains to prove that
%
$$fs_m=ff(ss_n)$$
%
By (\ref{2015.08.22.eq1}) we have  
%
$$q(f,\wh{n+1})=q(f)=(\wh{m+1},(\wh{n+1},qq(ff)))$$
%
The morphism $f^*(s)$, as a morphism over $\wh{m}$ is defined by the equation
%
$$f^*(s)\circ q(f)=f\circ s$$
%
which is equivalent to
%
$$qq(ff)\hc fs=(\iota_m^1(f_0),\dots,\iota_m^1(f_{n-1}),x_m^{m+1})\hc fs=ss\hc ff$$
%
Considering only the last terms of the corresponding sequences we get
%
$$fs_{m}=fs(x_m^{m+1})=ff(ss_n)$$
%
where the first equality is (\ref{2015.08.24.eq2}). 
%
\end{proof}
%
\begin{lemma}
\llabel{2015.08.29.l1}
Let $f=(\wh{m},(\wh{n},ff))$ and let $s=(\wh{n+i},(\wh{n+i+1},ss))$ be an element of $\wt{Ob}$. Then one has
%
\begin{eq}\llabel{2015.08.29.eq1}
f^*(s)=(\wh{m+i},(\wh{m+i+1},(x_0^{m+i},\dots,x_{m+i-1}^{m+i},(qq^i(ff))(ss_{n+i}))))
\end{eq}
%
\end{lemma}
%
\begin{proof}
The morphisms involved in the proof can be seen on the following diagram
%
$$
\begin{CD}
\wh{m+i} @>q^i(f)>> \wh{n+i}\\
@Vf^*(s)VV @VVsV\\
\wh{m+i+1} @>q^{i+1}(f)>> \wh{n+i+1}\\
@Vp_{m+i+1,i+1}VV @VVp_{n+i+1,i+1}V\\
\wh{m} @>f>> \wh{n}
\end{CD}
$$
%
The morphism $s$ is a morphism to $Id_{\wh{n+i}}$ over $\wh{n+i}$. Therefore, we may apply Lemma \ref{2015.08.29.l2} obtaining the equality
%
$$f^*(s)=(q^i(f))^*(s)$$
%
On the other hand by Lemma \ref{2015.08.22.l6}(2) we have $q^i(f)=(\wh{m+i},(\wh{n+i},qq^i(ff)))$ and by Lemma \ref{2015.08.24.l1} we have
%
$$(\wh{m+i},(\wh{n+i},qq^i(ff)))^*s=(\wh{m+i},(\wh{m+i+1},(x_0^{m+i},\dots,x_{m+i-1}^{m+i},(qq^i(ff))(ss_n)))).$$
%
\end{proof}
%
Another operation that we would like to have an explicit form of is operation $\delta$. For C-system $CC$ and an object $\Gamma$ in $CC$ one defines $\delta_{\Gamma}:\Gamma\sr p_{\Gamma}^*(\Gamma)$ as the unique morphism over $\Gamma$ such that 
%
\begin{eq}\llabel{2015.08.24.eq10}
\delta_{\Gamma}\circ q(p_{\Gamma},\Gamma)=Id_{\Gamma}
\end{eq}
%
\begin{lemma}\llabel{2015.08.24.l5}
Let $n>0$ then 
%
$$\delta_{\wh{n}}=(n,(n+1,(x_0^{n},\dots,x_{n-1}^{n},x_{n-1}^n)))$$
%
\end{lemma}
%
\begin{proof}
In view of Lemma \ref{2015.08.22.l7}, we have $\delta_n=(n,(n+1,(x_0^{n},\dots,x_{n-1}^{n},dn)))$ for some $dn\in R(n)$. By Lemma \ref{2015.08.26.l3a} we have
%
$$q(p_{\wh{n}})=(\wh{n+1},(\wh{n},\partial^{n-1}_{n}))=(\wh{n+1},(\wh{n}, (x_0^{n+1},\dots,x_{n-2}^{n+1},x_n^{n+1})))$$
%
and the defining equation (\ref{2015.08.24.eq10}) gives us
%
$$(n,(n+1,(x_0^{n},\dots,x_{n-1}^{n},dn)))\circ (\wh{n+1},(\wh{n}, (x_0^{n+1},\dots,x_{n-2}^{n+1},x_n^{n+1})))=(n,(n,(x_0^n,\dots,x_{n-1}^n)))$$
%
i.e.,
%
$$(x_0^{n+1},\dots,x_{n-2}^{n+1},x_n^{n+1})\hc (x_0^{n},\dots,x_{n-1}^{n},dn) =(x_0^n,\dots,x_{n-1}^n)$$
%
and comparing the last terms of the sequences we get
%
$$dn=(x_0^{n},\dots,x_{n-1}^{n},dn)(x_n^{n+1})=x_{n-1}^n$$
%
\end{proof}














%
\begin{problem}
To construct a bijection
%
\begin{eq}\llabel{2015.08.24.eq9}
mb_{\rr}:\wt{Ob}(C(\rr))\sr \amalg_{n\in\nat} R(n)
\end{eq}
%
\end{problem}
%
\begin{construction}\rm
\llabel{2015.08.22.constr3}
For $s=(n,(n+1,ss))$ define
%
$$mb_{\rr}(s)=(n,ss_n)$$
%
To show that this is a bijection let us construct the inverse bijection. For $o\in R(n)$ set
%
$$mb_{\rr}^!(n,o)=(n,(n+1,(x_0^n,\dots,x_{n-1}^n,o)))$$
%
The fact that these pas a mutually inverse follows easily from Lemma \ref{2015.08.22.l7}.
\end{construction}
%

Our next goal is to describe operations $T'$, $\wt{T}'$, $S'$, $\wt{S}'$ and $\delta'$ obtained from operations $T$, $\wt{T}$, $S$, $\wt{S}$ and $\delta$ that were introduced at the end of Section 3 in \cite{Csubsystems} through transport by means of the bijection (\ref{2015.08.24.eq9}).

Let us first recall the definition of operations $T$, $\wt{T}$, $S$, $\wt{S}$ and $\delta$ associated with a general C-system $CC$. 
%
\begin{definition}
\llabel{2015.08.26.def1}
Let $CC$ be a C-system. We will write $Ob$ for $Ob(CC)$ and $\wt{Ob}$ for $\wt{Ob}(CC)$. 
%
%
\begin{enumerate}
\item Operation $T$ is defined on the set
%
$$T_{dom}=\{\Gamma,\Gamma'\in Ob\,|\,l(\Gamma)>0\,\,and\,\, \Gamma'>ft(\Gamma)\}$$
%
and takes values in $Ob$. For $(\Gamma,\Gamma')\in T_{dom}$ one has
%
$$T(\Gamma,\Gamma')=p_{\Gamma}^*(\Gamma')$$
%
\item Operation $\wt{T}$ is defined on the set
%
$$\wt{T}_{dom}=\{\Gamma\in Ob, s\in \wt{Ob}\,|\,l(\Gamma)>0\,\,and\,\, \partial(s)>ft(\Gamma)\}$$
%
and takes values in $\wt{Ob}$. For $(\Gamma,s)\in \wt{T}_{dom}$ one has
%
$$\wt{T}(\Gamma,s)=p_{\Gamma}^*(s)$$
%
\item Operation $S$ is defined on the set
%
$$S_{dom}=\{r\in \wt{Ob}, \Gamma\in Ob\,|\,\Gamma>\partial(r)\}$$
%
and takes values in $Ob$. For $(r,\Gamma)\in S_{dom}$ one has
%
$$S(r,\Gamma)=r^*(\Gamma)$$
%
\item Operation $\wt{S}$ is defined on the set 
%
$$\wt{S}_{dom}=\{r,s\in \wt{Ob}\,|\,\partial(s)>\partial(r)\}$$
%
and takes values in $\wt{Ob}$. For $(r,s)\in \wt{S}_{dom}$ one has
%
$$S(r,s)=r^*(s)$$
%
\item Operation $\delta$ is defined on the set 
%
$$\delta_{dom}=\{\Gamma\in Ob\,|\,l(\Gamma)>0\}$$
%
and takes values in $\wt{Ob}$. For $\Gamma\in \delta_{dom}$, $\delta(\Gamma)$ is the unique morphism $\Gamma\sr p_{\Gamma}^*(\Gamma)$ over $\Gamma$ such that 
%
$$\delta_{\Gamma}\circ q(p_{\Gamma},\Gamma)=Id_{\Gamma}$$
%
\end{enumerate}
\end{definition}
%
\begin{theorem}
\llabel{2015.08.26.th1}
Let $Ob=Ob(C(\rr))$ and let $\wt{Ob}'$ be the right hand side of (\ref{2015.08.24.eq9}). One has:
%
\begin{enumerate}
\item Operation $T'$ is defined on the set
%
$$T'_{dom}=\{\wh{m},\wh{n}\in Ob\,|\,m>0\,\,and\,\,n>m-1\}$$
%
and is given by 
%
$$T'(\wh{m},\wh{n})=\wh{n+1}$$
%
\item Operation $\wt{T}'$ is defined on the set 
%
$$\wt{T}'_{dom}=\{\wh{m}\in Ob, (n,s)\in \wt{Ob}'\,|\,m>0\,\,and\,\,n+1>m-1\}$$
%
and is given by
%
$$\wt{T}'(\wh{m},(n,s))=(n+1,\partial_n^{m-1}(s))$$
%
\item Operation $S'$ is defined on the set
%
$$S'_{dom}=\{(m,r)\in \wt{Ob}',\wh{n}\in Ob\,|\,n>m+1\}$$
%
and is given by
%
$$S'((m,r),\wh{n})=\wh{n-1}$$
%
\item Operation $\wt{S}'$ is defined on the set 
%
$$\wt{S}'_{dom}=\{(m,r)\in\wt{Ob}',(n,s)\in \wt{Ob}'\,|\,n>m\}$$
%
and is given by
%
$$\wt{S}'((m,r),(n,s))=(n-1,\sigma_{\rr}(r,s))$$
%
\item Operation $\delta'$ is defined on the subset
%
$$\delta'_{dom}=\{\wh{n}\in Ob\,|\,n>0\}$$
%
and is given by
%
$$\delta'(\wh{n})=(n,x_{n-1}^n)$$
%
\end{enumerate}
\end{theorem}
%
\begin{proof}
We have:
%
\begin{enumerate}
%
\item Operation $T'$ is the same as operation $T$ for $C(\rr)$ since $\wt{Ob}$ is not involved in it. The form of $T'_{dom}$ is obtained by unfolding definitions and the formula for the operation itself follows from (\ref{2015.08.26.eq1}).
%
\item Operation $\wt{T}'$ is defined on the set of pairs $(\wh{m}\in Ob, (n,s)\in \wt{Ob}')$ such that $m>0$ and $\partial(mb_{\rr}^!(n,s))>m-1$. Since $\partial(mb_{\rr}^!(n,s)=n+1$ we obtain the required domain of definition. The formula by the operation itself is obtained immediately by combining Lemma \ref{2015.08.29.l1} and Lemma \ref{2015.08.26.l3a}.
%
\item Operation $S'$ is defined on the set of pairs $((m,r)\in \wt{Ob}',\wh{n}\in Ob)$ such that $n>\partial(mb_{\rr}^!(m,r))$. Since $\partial(mb_{\rr}^!(m,r))=m+1$ we obtained the required domain of definition. The operation itself is given by
%
$$S'((m,r),n)=(mb_{\rr}^!(m,r))^*(\wh{n})=((\wh{m},(\wh{m+1},(x_0^m,\dots,x_{m-1}^m,r)))^*(\wh{n}))=$$
$$\wh{n+m-(m+1)}=\wh{n-1}$$
%
\item Operation $\wt{S}'$ is defined on the set of pairs $(m,r),(n,s)\in \wt{Ob}'$ 
such that $\partial(mb_{\rr}^!(n,s))>\partial(mb_{\rr}^!(m,r))$ which is equivalent to $n>m$. The formula by the operation itself is obtained immediately by combining Lemma \ref{2015.08.29.l1} with $i=n-m-1$, Lemma \ref{2015.08.28.l1} and the definition of $\sigma_{\rr}$ in (\ref{2015.09.07.eq1}). 
%
\item Operation $\delta'$ is defined on the subset $\wh{n}\in Ob$ such that $n>0$ and is given by
%
$$\delta'(\wh{n})=mb_{\rr}(\delta(\wh{n}))=mb_{\rr}(\wh{n},(\wh{n+1},(x_0^n,\dots,x_{n-1}^n,x_{n-1}^n)))=(n,x_{n-1}^n)$$
%
\end{enumerate}
\end{proof}
%
\begin{remark}\rm
\llabel{2015.08.29.rem1}
The description of operations $T'$, $\wt{T}'$, $S$, $\wt{S}'$ and $\delta$ given in Theorem \ref{2015.08.26.th1} uses only three operations on the sets $R(n)$:
%
\begin{enumerate}
\item for all $m,n\in\nat$, $n>m$, a function $\sigma_{m,n}:R(m)\times R(n)\sr R(n-1)$ given by 
%
$$\sigma_{m,n}(r,s)=@\sigma(m,r,n,s)=(x_0^{n-1},\dots,x_{m-1}^{n-1},\iota_m^{n-m-1}(r),x_{m}^{n-1},\dots,x_{n-2}^{n-1})(s)$$
%
\item for all $i,n\in\nat$, $n\ge i$, a function $\partial_n^i:R(n)\sr R(n+1)$ 
%
\item for all $n\in\nat$ an element $x_{n}\in R(n+1)$ given as $x_{n}=\eta_{n+1}(n)$.
\end{enumerate}
%
Therefore, the conjectural equivalence between C-systems and B-systems implies that it is possible to construct $C(\rr)$ starting with a family of sets $R(n)$ equipped with operations:
%
$$\sigma_{m,n}:R(m)\times R(n)\sr R(n-1)$$
$$\partial_n^i:R(n)\sr R(n+1)$$
$$x_{n}\in R(n+1)$$
%
that satisfy some axioms. To avoid working with families of sets or types which might be inconvenient in simple-typed languages such as HOL we can further re-write this definition as follows. Let $lR$ be the disjoint union of $R(n)$ for all $n$. Then the operations that we need to consider are:
%
\begin{enumerate}
\item a function $l:lR\sr\nat$,
\item a function $\eta:\nat\sr lR$,
\item a function $\partial:\{r\in lR, i\in\nat\,|\, l(r)\ge i\}\sr lR$,
\item a function $\eta:\{r,s\in lR,\,|\,l(r)>l(s)\}\sr lR$,
\end{enumerate}
%
such that
%
\begin{enumerate}
\item for all $n\in\nat$, $l(\eta(n))=n+1$,
\item for all $r\in lR$, $i\in\nat $ such that $l(r)\ge i$, $l(\partial(r,i))=l(r)+1$,
\item for all $r,s\in lR$ such that $l(s)>l(r)$ one has $l(\sigma(r,s))=l(s)-1$.
\end{enumerate}
%
Clearly more axioms need to be added to obtain a full subcategory in the category whose objects are sets $lR$ with operations of the form $l,\eta,\partial,\sigma$ that is equivalent to the category of Lawvere theories or equivalently pre-algebraic theories or equivalently Fiore-Plotkin-Turi substitution algebras. When all the axioms are added one would obtain a definition of an l-algebraic theory that is convenient for formalization both in set theory and in HOL. 
\end{remark}
%
\begin{remark}\rm
\llabel{2015.08.29.rem1b}
It would appear that there should be examples of $(\eta,\partial,\sigma)$- structures that do not arise from pre-algebraic theories. Indeed, it seems unclear why it should be possible to realize the action of the symmetric group on $R(n)$ using these operations since  in the case of pre-algebraic theories  they all seem to respect the linear ordering on the sets $stn(n)$ in some sense. 

In the substitution notation of Remark \ref{2015.08.18.rem1}, given $r$ in $R(m)$ and $E$ in $R(n)$, 
%
$$\sigma(r,E)=E[r/x_m,x_m/x_{m+1},\dots,x_{n-2}/x_{n-1}],$$
%
i.e., operation $\sigma$ corresponds to the substitution of an expression in variables $x_0,\dots,x_{m-1}$ for the variable $x_m$ in an expression in variables $x_0,\dots,x_n$ followed by a downshift of the indexes of the variables with the higher index. 

The operation $\partial_n^i$ and the constants $x_{n}$ are similarly defined in terms of linear orderings.

To see how it is, nevertheless, possible to realize, for example, the permutation of $x_0$ and $x_1$ consider the following. First let, for all $i,n\in\nat$, 
%
$$\iota_n^i=\partial_{n+i-1}^{n+i-1}\circ \dots\circ \partial_n^n:R(n)\sr R(n+i)$$
%
Then define for all $i,n\in\nat$, $n\ge i+1$ an element $x^n_i\in R(n)$ by the formula
%
$$x^n_i=\iota_{i+1}^{n-i-1}(x_i)$$
%
such that, in particular, $x^{n+1}_{n}=x_n$.

Define now a function $\psi:R(2)\sr R(2)$ by the formula
%
$$\psi=\partial^0_2\circ \partial^0_3\circ \sigma_{3,4}(x_0^3,-)\circ \sigma_{2,3}(x_1^2,-)$$
%
One can verify that for any pre-algebraic theory $R$ one has $\psi=\phi_{\rr}(\sigma)$ where $\sigma$ is the permutation of $0$ and $1$ in $stn(2)$.

In the substitution notation this can be seen as follows:
%
$$\psi(E(x^2_0,x_1^2))=\sigma_{2,3}(x_1^2,\sigma_{3,4}(x_0^3,\partial^0_3(\partial^0_2(E(x^2_0,x_1^2)))))=\sigma_{2,3}(x_1^2,\sigma_{3,4}(x_0^3,\partial^0_3(E(x^3_1,x^3_2))))=$$
$$\sigma_{2,3}(x_1^2,\sigma_{3,4}(x_0^3,E(x^4_2,x^4_3)))=\sigma_{2,3}(x_1^2,E(x^3_2,x^3_0))=E(x^2_1,x^2_0)$$
%
\end{remark}
%
\begin{remark}\rm
\llabel{2015.08.29.rem2}
The fact that the full structure of a pre-algebraic theory can be reconstructed from operations $\sigma,\partial$ and $\eta$ of the form described above can also be approached via the comparison of such $\sigma\partial\eta$-structures with the substitution algebras of \cite[Definition 3.1]{FPT}. Such a comparison is more straightforward since their operation $\zeta$ of the form $R(n+1)\times R(n)\sr R(n)$ is the same as operation $(s,r)\mapsto \sigma_{n,n+1}(r,s)$.
\end{remark}

























\subsection{The C-system $CC(\rr,\lm)$.}
%
Let $\rr$ be a pre-algebraic theory and let $\lm=(LM,LM_{Mor})$ be a pre-sheaf of sets on the category $C(\rr)$, i.e., a functor $C(\rr)^{op}\sr Sets$. 

The morphism component $LM_{Mor}$ of $\lm$ is a function that sends a morphism $f=(\wh{m},(\wh{n},ff))$ from $\wh{m}$ to $\wh{n}$ in $C(\rr)$ to a function $LM_{Mor}(f)\in Fun(LM(\wh{n}),LM(\wh{m}))$. In particular we have for, each $m,n\in\nat$ a function
%
$$R(n,m)\sr Fun(LM(\wh{n}),LM(\wh{m}))$$
%
given by $ff\mapsto LM_{Mor}((\wh{m},(\wh{n},ff)))$. We will use this function as a coercion so that, for $ff\in R(n,m)$ and $E\in LM(\wh{n})$ the expression $ff(E)$ needs to be expanded into $LM_{Mor}((\wh{m},(\wh{n},ff)))(E)$ before the computation can occur (see the explanation after Lemma \ref{2015.08.18.l1} for more details). 
%???not sure that this expression "before the computation can occur should be used
\begin{remark}\rm
\llabel{2015.08.18.rem1}
If we think of $E\in LM(\wh{n})$ as of an expression in variables $0,\dots,n-1$ then the action of $R(n,m)$ on $LM(\wh{n})$ can be thought of as the substitution. This analogy can be used to introduce the notation when for $ff=(f_0,\dots,f_{n-1})\in R(n,m)$ and $E\in LM(\wh{n})$ one writes $ff(E)$ as 
%
$$ff(E)=E[f_0/0,\dots,f_{n-1}/n-1]$$
%
For example, in this notation we have 
%
$$\partial^i_n(E)=E[0/0,\dots,i-1/i-1,i+1/i,\dots,n/n-1]$$
%
Similarly, for $E\in LM(\wh{n+2})$ one has
%
$$\sigma^i_n(E)=E[0/0,\dots,i/i,i/i+1,\dots,n/n+1]$$
%
and $\iota_n^i(E)$ is ``the same expression'' but considered as an expression of $n+i$ variables.
\end{remark}
%
\begin{example}\rm
\llabel{2015.09.07.rem3}
An important example of $\lm$ is given by the functor $\Phi$ given on objects by $\Phi_{Ob}(\wh{n})=R(n)$ and on morphisms by 
%
$$\Phi_{Mor}((\wh{m},(\wh{n},r))(s)=r(s)$$
%
We will denote this functor by the same symbol $\rr$ as the underlying pre-algebraic theory.

This functor is isomorphic to the (contravariant) functor represented by the object $\wh{1}$ but it is not equal to this functor since the set of elements of the form  $(\wh{n},(\wh{1},r'))$ where $r'\in R(1,n)$ is isomorphic but not equal to the set $R(n)$.
\end{example}
%
%
\begin{example}\rm
\llabel{2015.09.07.rem4}
Another important example of a presheaf $\lm$ is the constant presheaf corresponding to a set $S$. The C-system $CC(\rr,\lm)$ for $\lm=S$ corresponds to the multi-sorted algebraic theory with a fixed set of sorts $S$. 

Taking $\lm$ to be a sub-presheaf of $\lm_0\times S$ one can add and extra ``sorting dimension'' to a theory. Cf. Remark \ref{}. 
\end{example}





Recall that we defined, for any pre-algebraic theory $\rr$, an operation $\sigma$ that we can write in the form
%
$$\sigma_{\rr}:\{m\in\nat,r\in R(m),n\in\nat,s\in R(n)\,|\,n>m\}\sr R(n-1)$$
%
which is a {\em dependent} function, i.e., a function whose codomain depends on the argument. 
%??? lift up to where we explain what is Ob_n

For $LM$ as above define a dependent function $\sigma_{\lm}$ with the domain of definitions 
%
$$dom(\sigma_{\lm})=\{m\in\nat,r\in R(m),n\in nat, E\in LM(\wh{n})\,|\,n>m\},$$
%
and the codomain function
%
$$codom(\sigma_{\lm})(m,r,n,E)=LM(\wh{n-1})$$
%
by the formula
%
\begin{eq}\llabel{2015.09.07.eq2}
\sigma_{\lm}(m,r,n,E)=(qq^{n-m-1}(x_0^m,\dots,x_{m-1}^m,r))(E)=$$
$$(x_0^{n-1},\dots,x_{m-1}^{n-1},\iota_m^{n-m-1}(r),x_m^{n-1},\dots, x_{n-2}^{n-1})(E)
\end{eq}
%
where the second equality is the equality of Lemma \ref{2015.08.28.l1}. Alternatively, one can think of $\sigma_{\lm}$ as of a family of functions $\sigma_{\lm,n}$ with different codomains but we will use the dependent function viewpoint.

Of the four arguments $m,r,n$ and $E$ of $\sigma_{\lm}$ we will use $m$ and $n$ as implicit arguments, that is, arguments that are not written explicitly because they often can be inferred from the remaining arguments by a simple algorithmic procedure. In cases when $m$ and $n$ can not be inferred from $r$ and $E$, which we will not encounter in this paper, the syntax of the proof assistant Coq is to write $@\sigma_{\lm}$ instead of $\sigma_{\lm}$ and to supply all four arguments explicitly. 

Define a category $CC(\rr,\lm)$ as follows.
%
$$Ob(CC(\rr,\lm))=\amalg_{n\in\nat} Ob_n(\rr,\lm)$$
%
where 
%
$$Ob_n(\rr,\lm)=LM(\wh{0})\times\dots\times LM(\wh{n-1})$$
%
\begin{remark}\rm
\llabel{2015.08.14.rem1}
In a univalent formalization based on UniMath one can define $Ob_n(\rr,\lm)$ as the type $forall(i:stn\,n),LM\, (i)$. Based on this formalization elements of $Ob_n(\rr,\lm)$ are dependent functions with the domain $stn(n)$ and the codomain function $i\mapsto LM(\wh{i})$. Therefore, for $X\in Ob_n$ and $i\in stn(n)$ it makes sense to write $X(i)$ for the $i$-th component of $X$. However, for typographical reasons, we will sometimes write $X_i$ instead of $X(i)$. 
\end{remark}
%

Define a function $l_f$ on $Ob(CC(\rr,\lm))$ setting $l_f(n,A)=n$.

The set of morphisms of $CC(\rr,\lm)$ is given by
%
$$Mor(CC(\rr,\lm))=\coprod_{\Gamma,\Gamma'\in Ob(CC(\rr,\lm))} R(l_f(\Gamma'),l_f(\Gamma))$$
%
with the obvious domain and codomain maps. 

The composition of morphisms in $CC(\rr,\lm)$ is defined by the formula
%
$$(\Gamma,(\Gamma',f))\circ (\Gamma',(\Gamma'',g))=(\Gamma,(\Gamma'', g\hc f))$$
%
and the identity morphisms by
%
\begin{eq}\llabel{2015.08.22.eq6}
Id_{\Gamma}=(\Gamma,(\Gamma, \eta_{l_f(\Gamma)}))=(\Gamma,(\Gamma,(x^n_0,\dots,x^n_{n-1})))
\end{eq}
%
The axioms of a category follow from Lemma \ref{2015.08.18.l1}(1,2). 


The proof of the following lemma is omitted because of its simplicity.
%
\begin{lemma}
\llabel{2015.08.22.l1}
The mappings 
%
$$\Gamma\mapsto l_f(\Gamma)$$
$$(\Gamma,(\Gamma',f))\mapsto (l_f(\Gamma),(l_f(\Gamma'),f))$$
%
define a fully faithful functor 
%
$$Fl:CC(\rr,\lm)\sr C(\rr)$$
%
\end{lemma}
%
\begin{remark}\rm
\llabel{2015.09.01.rem1}
For any two objects $\Gamma,\Gamma'$ of $CC(\rr,\lm)$ such that $l_f(\Gamma)=l_f(\Gamma')=n$, the formula
%
$$can_{\Gamma,\Gamma'}=(\Gamma,(\Gamma',(x_0^n,\dots,x_{n-1}^n)))$$
%
defines a morphism which is clearly an isomorphism with $can_{\Gamma',\Gamma}$ being a canonical inverse. Therefore, all objects of the same length in $CC(\rr,\lm)$ are ``canonically isomorphic''. 
\end{remark}
%
\begin{remark}\rm
\llabel{2015.09.01.rem2}
If $LM(\wh{0})=\emptyset$ then $CC(\rr,\lm)=\emptyset$. On the other hand, the choice of an element $y$ in $LM(\wh{0})$ defines distinguished elements $\iota_0^n(y)$ in all sets $LM(\wh{n})$ and therefore distinguished objects 
%
$$y_n=(n,(\iota_0^0(y),\dots,\iota_0^{n-1}(y)))\in Ob(CC(\rr,\lm))$$
%
of length $n$ for all $n$. Mapping $\wh{n}$ to $y_n$ defines, as one can immediately prove from the definitions, a functor $lF(y):C(\rr)\sr CC(\rr,\lm)$. 

This functor clearly satisfies the conditions $lF(y)\circ Fl=Id_{C(\rr})$.

One verifies easily that the morphisms 
%
$$can_{\Gamma,y_{l_f(\Gamma)}}:\Gamma\sr lF(y)(Fl_f(\Gamma))$$
%
form a natural transformation. We conclude that $Fl$ and $lF(y)$ is a pair of mutually inverse equivalences of categories.

However this equivalence is not an isomorphism unless $LM(\wh{n})\cong unit$ for all $n$.
\end{remark}
%


For $\Gamma\in Ob(CC(\rr,\lm))$ such that $\Gamma=(n+1,(T_0,\dots,T_n))$ denote by $ft(\Gamma)$ the object 
%
$$ft(\Gamma)=(n,(T_0,\dots,T_{n-1}))$$
%
and by $p_{\Gamma}$ the morphism 
%
$$p_{\Gamma}=(\Gamma, (ft(\Gamma), \iota_n^1))$$
%
The following immediate analog of Lemma \ref{2015.07.24.l1} holds in $CC(\rr,\lm)$:
%
\begin{lemma}
\llabel{2015.08.22.l6b}
One has:
%
\begin{enumerate}
\item Let $f=(\Gamma',(\Gamma,(f_0,\dots,f_n)))$, then 
%
$$f\circ p_{\Gamma}=(\Gamma',(ft(\Gamma),(f_0,\dots,f_{n-1})))$$
%
\item Let $f=(ft(\Gamma'),(\Gamma,(f_0,\dots,f_n)))$, then 
%
$$p_{\Gamma'}\circ f=(\iota_m^1(f_0),\dots,\iota_m^1(f_{n-1}))$$
%
\end{enumerate}
\end{lemma}
%
\begin{proof}
Since $Fl$ is a fully faithful functor it is sufficient to verify that the asserted equalities hold after application of $Fl$. This follows immediately from Lemma \ref{2015.07.24.l1}.
\end{proof}
%

Given two objects $\Gamma'=(m,(T'_0,\dots,T'_{m-1}))$ and $\Gamma=(n+1,(T_0,\dots,T_{n}))$ and a morphism $f=(\Gamma',(ft(\Gamma),ff))$
define an object $f^*(\Gamma)$ by the formula:
%
\begin{eq}\llabel{2015.09.09.eq3old}
f^*(\Gamma)=(m+1,(T'_0,\dots,T'_{m-1},ff(T_{n})))
\end{eq}
%
and a morphism $q(f,\Gamma):f^*(\Gamma)\sr \Gamma$ by the formula
%
$$q(f,\Gamma)=(f^*(\Gamma),(\Gamma, qq(ff)))$$
% 
\begin{lemma}
\llabel{2015.08.26.l7}
Let $\Gamma=(n,(T_0,\dots,T_{n-1}))$ where $n\ge i$, $\Gamma'=(m,(T_0',\dots,T_{m-1}'))$ and let $(\Gamma',(ft^i(\Gamma),ff))$ be a morphism.
Then one has
%
$$f^*(\Gamma,i)=(m+i,(T_0,',\dots,T_{m-1}',ff(T_{n-i}),qq(ff)(T_{n-i+1}) ,\dots,qq^{i-1}(ff)(T_{n-1})))$$
%
\end{lemma}
%
\begin{proof}
By straightforward induction on $i$.
\end{proof}
%
\begin{lemma}
\llabel{2015.08.26.l8}
Let $\Gamma=(n,(T_0,\dots,T_{n-1}))$ and $\Gamma'=(m,(T_0,\dots,T_{m-2},T))$ where $n>m-1$. Then one has
%
$$p_{\Gamma'}^*(\Gamma)=(n+1,(T_0,\dots,T_{m-2},T,\partial_{m-1}^{m-1}(T_{m-1}),\dots,\partial_{n-1}^{m-1}(T_{n-1})))$$
%
\end{lemma}
%
\begin{proof}
One has
%
$$p_{\Gamma'}^*(\Gamma)=(\Gamma',(ft(\Gamma'),\iota_{m-1}^1))^*(\Gamma)=$$$$(n+1,(T_0,\dots,T_{m-2},T,\iota_{m-1}^1(T_{m-1}),\dots,qq^{n-m-2}(\iota_{m-1}^1)(T_{n-1})))=$$
$$(n+1,(T_0,\dots,T_{m-2},T,\partial_{m-1}^{m-1}(T_{m-1}),\dots,\partial^{m-1}_{n-1}(T_{n-1})))$$
%
where the second equality is by Lemma \ref{2015.08.26.l7} and the third equality is by Lemma \ref{2015.08.26.l3a}.
\end{proof}
%
\begin{lemma}
\llabel{2015.08.18.l4b}
For any $\Gamma'$, $\Gamma$ and $f$ as above the square
%
\begin{eq}\llabel{2015.08.22.eq2}
\begin{CD}
f^*(\Gamma) @>q(f,\Gamma)>> \Gamma\\
@Vp_{f^*(\Gamma)}VV @Vp_{\Gamma}VV\\
\Gamma' @>f>> ft(\Gamma)
\end{CD}
\end{eq}
%
is a pull-back square.
\end{lemma}
%
\begin{proof}
Since $Fl$ of Lemma \ref{2015.08.22.l1} a fully faithful functor it is sufficient to show that the image of the square (\ref{2015.08.22.eq2}) under this functor is a pull-back square. This image is the square
%
$$
\begin{CD}
m+1 @>q(f)>> n+1\\
@Vp_{m+1}VV @Vp_{n+1}VV\\
m @>f>> n
\end{CD}
$$
%
which is a pull-back square by Lemma \ref{2015.08.18.l4}.
\end{proof}
%
\begin{problem}\llabel{2015.08.17.prob1}
To construct the structure of a C-system on the category $CC(\rr,\lm)$.
\end{problem}
%
\begin{construction}\rm
\llabel{2015.08.17.constr1}
The length function $l_f$ is already defined.

The object $pt$ is the only object of length $0$.

The function $ft$ on objects of length $>0$ is already defined.  We set $ft(pt)=pt$.  

The canonical morphisms $p_{\Gamma}$ have already been defined for elements of length $>0$ and we define $p_{pt}$ to be the identity morphism.

The operation $f^*$ on objects and morphisms $q(f,\Gamma)$ is already defined.

The first four conditions of \cite[Definition 2.1]{Csubsystems} are obvious. 

The fifth condition is the commutativity of the squares (\ref{2015.08.22.eq2}) which is a part of Lemma \ref{2015.08.18.l4b}. 

The the sixth condition has two parts. One is that $Id_{ft(\Gamma)}^*(\Gamma)=\Gamma$ which follows from the identity morphism property of the functor $\lm$. The second part is that $q(Id_{ft(\Gamma)},\Gamma)=Id_{\Gamma}$ which follows from the first part, the fact that $Fl$ is fully faithful and the corresponding property of the C-system $C(\rr)$.

The seventh conditions also has two parts. The first one is that for $g:\Gamma''\sr \Gamma'$ one has $g^*(f^*(\Gamma))=(g\circ f)^*(\Gamma)$. If $\Gamma''=(T''_0,\dots,T_{k-1}'')$ and $g=(\Gamma'',(\Gamma',gg)$ then we have
%
$$g^*(f^*(\Gamma))=g^*(T_0',\dots,T_{m-1}',ff(T_{n-1}))=(T_0'',\dots,T_{k-1}'',gg(ff(T_n)))$$
%
and
%
$$(g\circ f)^*(\Gamma)=(T_0'',\dots,T_{k-1}'',(ff\hc gg)(T_n))$$
%
we conclude that $g^*(f^*(\Gamma))=(g\circ f)^*(\Gamma)$ by the composition of morphisms property of the functor $\lm$. 

The second part of the seventh condition follows from the fact that $Fl$ is fully faithful and from the second part of the seventh condition for $C(\rr)$.

This completes the verification of the conditions of \cite[Definition 2.1]{Csubsystems} and the construction of the structure of a C0-system on $CC(\rr,\lm)$. To extend it to the structure of a C-system we apply \cite[Proposition 2.4]{Csubsystems} and Lemma \ref{2015.08.18.l4b}. 
\end{construction}
%
%
%

We provide the following lemma without a proof because the proof is immediate from the definitions and \cite[Lemma 3.4]{Cfromauniverse}. 
%
\begin{lemma}
\llabel{2015.08.22.l4}
The functor $Fl:CC(\rr,\lm)\sr C(R)$ is a homomorphism of C-systems.
\end{lemma}
%
\begin{remark}\rm
\llabel{2015.08.22.rem1} 
For $f=(\wh{m},(\wh{n},ff))$ we have
%
$$(lF(y)(f))^*(y_{n+1})=(m+1,(\iota_0^0(y),\dots,\iota_0^{m-1}(y),ff(\iota_0^n(y))))$$
%
By (\ref{2015.08.26.eq7}) we have 
%
$$ff(\iota_0^n(y))=(\iota_0^n\hc ff)(y)=\iota_0^m(y)$$
%
because both $\iota_0^n\hc ff$ and $\iota_0^m$ are elements of $R(0,m)=R(m)^{stn(0)}$ which is a one element set. Therefore
%
$$(lF(y)(f))^*(y_{n+1})=y_{m+1}$$
%
The rest of the conditions that one needs to prove in order to show that $lF$ is a homomorphism of C-systems is immediate from definitions and we obtain that 
%
$$lF(y):C(\rr)\sr CC(\rr,\lm)$$
%
is a homomorphism of C-systems.  However it is not an isomorphism of C-systems and, as one can see for example from our study of sub-quotients of $CC(\rr,lm)$, the C-systems $C(\rr)$ and $CC(\rr,\lm)$ can be very different. Cf. Remark \ref{}. 
\end{remark}
%
\begin{remark}\rm
\llabel{2015.08.22.rem2.from.old}
%??? should E be from LM(\wh{n}) or LM(x_1,\dots,x_n)? Probably it does not matter as it leads to isomorphic C-systems
%
There is another construction of a pre-category from $(\rr,\lm)$ which takes as an additional parameter a countable set $Var$ (with decidable equality) which is called the set of variables. Let $F_n(Var)$ be the set of sequences of length $n$ of pair-wise distinct elements of $Var$. Define the pre-category $CC(\rr,\lm,Var)$ as follows. The set of objects of $CC(\rr,\lm,Var)$ is 
%
$$Ob(CC(\rr,\lm,Var))= \amalg_{n\in\nat} \amalg_{(x_0,\dots,x_{n-1})\in F_n(Var)} LM(\wh{0})\times\dots\times LM(\wh{n})$$
%
For compatibility with the traditional type theory we will write the elements of $Ob(CC(\rr,\lm,X))$ as sequences of the form $x_0:E_1,\dots,x_{n-1}:E_{n-1}$. The set of morphisms is given by
%
$$Mor(CC(\rr,\lm,Var))=\amalg_{\Gamma,\Gamma'\in Ob}R(l_f(\Gamma'),l_f(\Gamma))$$
%
The composition is defined in such a way that the projection 
%
$$(x_0:E_0,\dots,x_{n-1}:E_{n-1})\mapsto (E_0,E_1,\dots,E_{n-1})$$
%
is a functor from $CC(\rr,\lm,Var)$ to $CC(\rr,\lm)$. 

This functor is clearly an equivalence but not an isomorphism of categories. 

There are an obvious object $pt$, function $ft$ and $p$-morphisms. 

What is unclear is how to define operation $f^*$ on objects such as to satisfy the first parts of the sixth and seventh conditions in the definition \cite[Definition 2.1]{Csubsystems} of a C0-system. For $\Gamma'=(x'_0:T'_0,\dots, x'_{m-1}:T'_{m-1})$, $\Gamma=(y_0:T_0,\dots,y_n:T_n)$ and $f:\Gamma'\sr ft(\Gamma)$ the object $f^*(\Gamma)$ must be of the form $(x'_0:T_0',\dots,x'_{m-1}:T'_{m-1}, z:T'_m)$ in order to satisfy the equation $ft(f^*(\Gamma))=\Gamma'$ and we should have $z\ne x_0',\dots,x'_{m-1}$.

Consider the case when $LM(\wh{i})=unit$ for all $i$. Then the problem is to construct functions 
%
$$z_{n,m}:F_m(Var)\times F_{n+1}(Var)\times R(n,m)\sr Var$$
%
such that $z_{n,m}(x',y,f)$ does not occur in $x'$ and such that
%
\begin{eq}
\llabel{2015.08.22.eq1b}
z_{n,m}((x_0,\dots,x_{n-1}),(x_0,\dots,x_{n-1},x_n),\eta_n)=x_n
\end{eq}
%
and for all $x'\in F_{m}$, $x''\in F_{k}$, $y\in F_{n+1}$, $f\in R(n,m)$ and $g\in R(m,k)$ one has
%
\begin{eq}
\llabel{2015.08.22.eq2b}
z_{n,k}(x'',y,g\hc f)=z_{m,k}(x'',(x'_0,\dots,x'_{m-1},z_{m,n}(x',y,f)),g)
\end{eq}
%
I do not know whether it is possible to construct a function $z$ satisfying these two equations for a general $R$.
\end{remark}
%


%
\begin{lemma}
\llabel{2015.08.22.l5}
A morphism $f=(\Gamma',(\Gamma,ff))$, where $l_f(\Gamma)=n+1$,  belongs to $\wt{Ob}(CC(\rr,\lm))$ if and only if $\Gamma'=ft(\Gamma)$ and $ff(i)=x^n_i$ for all $i=0,\dots,n-1$. 
\end{lemma}
%
\begin{proof}
It follows immediately from Lemma \ref{2015.08.26.l1}.
\end{proof}
%
The following analog of Lemma \ref{2015.09.09.l1} for the C-system $CC(\rr,\lm)$ provides us with the explicit form of the operation $f\mapsto s_f$.
%
\begin{lemma}
\llabel{2015.09.09.l2}
Let $f=(\Gamma,(\Gamma',(f_0,\dots,f_{n-1})))$ where $n>0$. Then one has
%
\begin{eq}\llabel{2015.09.09.eq1}
s_f=(\Gamma,((ft(f))^*(\Gamma'),(x_0^m,\dots,x_{m-1}^m,f_{n-1})))
\end{eq}
%
where $ft(f)=f\circ p_{\Gamma'}$ and $m=l_f(\Gamma)$.

If $\Gamma=(m,(X_0,\dots,X_m))$ and $\Gamma'=(n,(Y_0,\dots,Y_m))$ then
%
\begin{eq}\llabel{2015.09.09.eq2}
(ft(f))^*(\Gamma')=(X_0,\dots,X_{m-1},(f_0,\dots,f_{n-2})(Y_{n-1}))
\end{eq}
%
\end{lemma}
%
\begin{proof}
By definition $s_f$ is a morphism from $\Gamma$ to $(ft(f))^*(\Gamma)$. Therefore it is sufficient to show that the left hand side of (\ref{2015.09.09.eq1}) agrees with the right hand side after application of the homomorphism $Fl$. Since $Fl$ is a homomorphism of C-systems, $Fl(s_f)=s_{Fl(s)}$ and our goal follows from Lemma \ref{2015.09.09.l1}.

Applying Lemma \ref{2015.08.22.l6b} we see that $ft(f)=(\Gamma,(ft(\Gamma'),(f_0,\dots,f_{n-2})))$. Therefore (\ref{2015.09.09.eq2}) follows immediately from (\ref{2015.09.09.eq3old}). 
\end{proof}
%
For Lemma \ref{2015.09.03.l1} below we first need some general results about homomorphisms of C-systems.
%
\begin{lemma}
\llabel{2015.09.03.l2}
Let $F:CC\sr CC'$ be a homomorphism of C-systems. Then one has:
%
\begin{enumerate}
\item for $\Gamma\in CC$ and $i\in\nat$ one has $F(p_{\Gamma,i})=p_{F(\Gamma),i}$,
\item for $\Gamma,\Gamma'\in CC$, $\Gamma\le \Gamma'$ implies $F(\Gamma)\le F(\Gamma')$ and similarly for $<$,
\item for $\Gamma'\ge \Gamma$ and $f:\Delta\sr \Gamma$ one has
%
$$F(f^*(\Gamma'))=(F(f))^*(F(\Gamma'))$$
%
\item for $\Gamma',\Gamma''\ge \Gamma$, $a:\Gamma'\sr \Gamma''$ over $\Gamma$ and $f:\Delta\sr \Gamma$ one has
%
$$F(f^*(a))=(F(f))^*(F(a))$$
%
\item for $\Gamma$ such that $l(\Gamma)>0$ one has
%
$$F(\delta(\Gamma))=\delta(F(\Gamma))$$
%
\end{enumerate}
\end{lemma}
%
\begin{proof}
The proofs are straightforward and we leave them for the formalized version of the paper.
\end{proof}
%
\begin{lemma}
\llabel{2015.09.03.l1}
For $i>0$, $f:\Gamma'\sr ft^i(\Gamma)$ and $s=(ft(\Gamma),(\Gamma,ss))$ in $\wt{Ob}(CC(\rr,\lm))$ one has
%
$$f^*(s)=(f^*(ft(\Gamma)),(f^*(\Gamma),(x_0^{m+i-1},\dots,x_{m+i-2}^{m+i-1},(qq^{i-1}(ff))(ss(n-1)))))$$
%
where $m=l(\Gamma')$ and $n=l(\Gamma)$.
\end{lemma}
%
\begin{proof}
Since $Fl$ is a full embedding, it is sufficient, in order to verify the equality of two morphisms to verify that their domain and codomain are equal and that their images under $Fl$ are equal. For the domain and codomain it follows from the definition of $f^*$ on morphisms. For the images under $Fl$ it follows from the fact that $Fl$ is a homomorphism of C-systems, Lemma \ref{2015.09.03.l2}(4) and
Lemma \ref{2015.08.29.l1}. 
\end{proof}
%
\begin{problem}
\llabel{2015.08.22.prob1}
To construct a bijection
%
\begin{eq}
\llabel{2009.10.15.eq2}
mb_{\rr,\lm}:\wt{Ob}(CC(\rr,\lm))\sr \coprod_{n\in\nat} Ob_{n+1}(\rr,\lm)\times R(n)
\end{eq}
%
\end{problem}
%
\begin{construction}\rm
\llabel{2015.08.22.constr1}
\llabel{2014.06.30.l2}
Let $s\in \wt{Ob}(CC(\rr,\lm))$. Then $s=(ft(\Gamma),(\Gamma,ss))$ for some $ss\in R(n,n+1)$ and $\Gamma=(n+1,X)$. We set:
%
$$mb_{\rr,\lm}(s)=(n, (X, ss(n)))$$
%
To show that this is a bijection let us construct an inverse. For $n\in\nat$, $X\in Ob_{n+1}(\rr,\lm)$ and $o\in R(n)$ let
%
$$mb_{\rr,\lm}^!(n,(X,o))=(ft((n+1,X)),((n+1,X),(x^{n}_0,\dots,x^{n}_{n-1},o)))$$
%
This is a morphism from $ft(\Gamma)$ to $\Gamma$ where $\Gamma=(n+1,X)$. The equation $mb_{\rr,\lm}^!(n,(\Gamma,o))\circ p_\Gamma=Id_{ft(\Gamma)}$ follows from Lemma \ref{2015.08.22.l5}. 

Let us show now that $mb_{\rr,lm}$ and $mb_{\rr,lm}^!$ are mutually inverse bijections. Let $s\in \wt{Ob}(CC(\rr,\lm))$ be as above, then:
%
$$mb_{\rr,\lm}^!(mb_{\rr,\lm}(s))=mb_{\rr,\lm}^!(n,(X,ss(n)))=(ft(\Gamma),(\Gamma,(x^{n}_0,\dots,x^{n}_{n-1},ss(n))))=s$$
%
where the last equality follows from the assumption that $s\in \wt{Ob}$ and Lemma \ref{2015.08.22.l5}.

On the other hand for $X\in Ob_{n+1}(\rr,\lm)$ and $o\in R(n)$ we have
%
$$mb_{\rr,\lm}(mb_{\rr,lm}^!(n,(X,o)))=mb_{\rr,\lm}(ft((n+1,X)),((n+1,X),(x^{n}_0,\dots,x^{n}_{n-1},o)))=$$
$$(n,(X,o))$$
%
This completes Construction \ref{2015.08.22.constr1}.
\end{construction}
%
\begin{lemma}
\llabel{2015.09.09.l3}
Let $f=(\Gamma,(\Gamma',(f_0,\dots,f_{n-1}))$ where $\Gamma=(m,X)$, $\Gamma'=(n,Y)$ and $ff=(f_0,\dots,f_{n-1})$. Then one has
%
$$mb_{\rr,\lm}(s_f)=(m,((X_0,\dots,X_{m-1},(f_0,\dots,f_{n-2})(Y_{n-1})), f_{n-1}))$$
%
\end{lemma}
%
\begin{proof}
It follows immediately from Lemma \ref{2015.09.09.l2} and the formula for $mb_{\rr,\lm}$.
\end{proof}
%
Consider operations $T'$, $\wt{T}'$, $S'$, $\wt{S}'$ and $\delta'$ obtained by transport by means of the bijection of Construction \ref{2015.08.22.constr1} from the operations $T$, $\wt{T}$, $S$ and $\wt{S}$ and $\delta$ corresponding to the C-system $CC(\rr,\lm)$ (cf. Definition \ref{2015.08.26.def1}).  Let us give an explicit description of these operations. 
%
\begin{theorem}\llabel{2015.08.26.th2}
Let $Ob=Ob(CC(\rr,\lm))$ and let $\wt{Ob}'=\wt{Ob}'(\rr,\lm)$ be the right hand side of (\ref{2009.10.15.eq2}). One has:
%
\begin{enumerate}
\item Operation $T'$ is defined on the set $T'_{dom}$ of pairs $(m,X),(n,Y)\in Ob$ such that $m>0$, $n>m-1$ and $X_i=Y_i$ for $i=0,\dots,m-2$. It takes values in $Ob$ and is given by 
%
$$T((m,X),(n,Y))=$$$$(n+1,(Y_0,\dots,Y_{m-2},X_{m-1},\partial_{m-1}^{m-1}(Y_{m-1}),\dots,\partial_{n-1}^{m-1}(Y_{n-1})))$$
%
\item Operation $\wt{T}'$ is defined on the set $\wt{T}'_{dom}$ of pairs $(m,X)\in Ob$, $(n,(Y,s))\in\wt{Ob}'$ such that $m>0$, $n+1>m-1$ and $X_i=Y_i$ for $i=0,\dots,m-2$. It takes values in $\wt{Ob'}$ and is given by
%
$$\wt{T}'((m,X),(n,(Y,s)))=(n+1,(T((m,X),(n,Y)),\partial_{n}^{m-1}(s)))$$
%
\item Operation $S'$ is defined on the set of pairs $(m,(X,r))\in \wt{Ob}'$, $(n,Y)\in Ob$ where $n>m+1$ and $X_i=Y_i$ for $i=0,\dots,m$. It takes values in the set $Ob$ and is given by 
%
$$S'((m,(X,r)),(n,Y))=(n-1,(Y_0,\dots,Y_{m-1},\sigma_{\lm}(r,Y_{m+1}),\sigma_{\lm}(r,Y_{m+2}),\dots,\sigma_{\lm}(r,Y_{n-1})))$$
%
\item Operation $\wt{S}'$ is defined on the set of pairs $(m,(X,r))\in \wt{Ob}'$, $(n,(Y,s))\in \wt{Ob}'$ such that $n>m$ and $X_i=Y_i$ for $i=0,\dots,m$. It takes values in $\wt{Ob}'$ and is given by 
%
$$\wt{S}'((m,(X,r)),(n,(Y,s)))=(n-1,(S'((m,(X,r)),(n+1,Y))),\sigma_{\rr}(r,s))$$
%
\item Operation $\delta'$ is defined on the subset of $(n,X)$ in $Ob$ such that $n>0$. It takes values in $\wt{Ob}'$ and is given by 
%
$$\delta'((n,X))=(n,(p_{(n,X)}^*(n,X),x_{n-1}^n))$$
%
\end{enumerate}
\end{theorem}
%
\begin{proof}
In the proof we will write $mb$ and $mb^!$ instead of $mb_{\rr,\lm}$ and $mb^!_{\rr,lm}$. We have:
%
\begin{enumerate}
%
\item Operation $T'$ is the same as operation $T$ for $C(\rr)$ since $\wt{Ob}$ is not involved in it. The form of $T'_{dom}$ is obtained by unfolding definitions and 
using Lemma \ref{2015.08.22.l6b}(1). 

The operation itself is given by 
%
$$T'((m,X),(n,Y))=p_{(m,X)}^*((n,Y))=$$
$$(m,(Y_0,\dots,Y_{m-1},\partial_{m-1}^{m-1}(Y_{m-1}),\dots, \partial_{n-1}^{m-1}(Y_{n-1})))$$
%
where the first equality is by Definition \ref{2015.08.26.def1}(1) and the second by Lemma \ref{2015.08.26.l8}. 
%
\item Operation $\wt{T}'$ is defined on the set of pairs $((m,X)\in Ob, (n,(Y,s))\in \wt{Ob}')$ such that $m>0$ and $\partial(mb^!(n,(Y,s)))>ft(m,X)$. Since $\partial(mb^!(n,(Y,s))=(n+1,Y)$ we obtain the required domain of definition from Lemma \ref{2015.08.22.l6b}(1). 

To verify the formula for the operation itself consider the equalities:
%
$$\wt{T}'((m,X),(n,(Y,s)))=mb(p_{(m,X)}^*(mb^!(n,(Y,s))))=$$
$$mb(p_{(m,X)}^*((ft((n+1,Y)),((n+1,Y),(x^{n}_0,\dots,x^{n}_{n-1},s)))))$$
%
where the first equality is by Definition \ref{2015.08.26.def1}(2). By Lemma \ref{2015.09.03.l1} we can extend these equalities as follows:
%
$$mb(p_{(m,X)}^*((ft((n+1,Y)),((n+1,Y),(x^{n}_0,\dots,x^{n}_{n-1},s)))))=$$
$$mb(p_{\Gamma'}^*(ft(\Gamma)),(p_{\Gamma'}^*(\Gamma),(x^{n+1}_0,\dots,x^{n+1}_{n},(qq^{n-m+1}(\iota^1_{m-1}))(s))))=$$
$$(n+1,(p_{\Gamma'}^*(\Gamma),\partial_{n}^{m-1}(s)))=(n+1,(T((m,X),(n+1,Y)),\partial_n^{m-1}(s)))$$
%
where $\Gamma'=(m,X)$, $\Gamma=(n+1,Y)$, the first equality is by Lemma \ref{2015.09.03.l1}, the second by Lemma \ref{2015.08.26.l3a} and the third by Definition \ref{2015.08.26.def1}(1). 
%
%
\item Operation $S'$ is defined on the set of pairs $((m,(X,r))\in \wt{Ob}',(n,Y)\in Ob)$ such that $(n,Y)>\partial(mb^!(m,(X,r)))$. Since $\partial(mb^!(m,(X,r)))=(m+1,X)$ we obtained the required domain of definition. The operation itself is given by
%
$$S'((m,(X,r)),(n,Y))=(mb^!((m,(X,r))))^*((n,Y))=$$
$$(ft((m+1,X)),((m+1,X),(x^{m}_0,\dots,x^{m}_{m-1},r)))^*((n,Y))=$$
$$(ft((m+1,X)),((m+1,X),(x^{m}_0,\dots,x^{m}_{m-1},r)))^*((n,Y),i)$$
%
where $i=n-m-1$. By Lemma \ref{2015.08.26.l7} we can extend this equality as follows:
%
$$(n-1,(X_0,\dots,X_{m-1},rr(Y_{m+1}),qq(rr)(Y_{m+2}),\dots,qq^{n-m-2}(rr)(Y_{n-1})))=$$
$$(n-1,(Y_0),\dots,Y_{m-1},rr(Y_{m+1}),qq(rr)(Y_{m+2}),\dots,qq^{n-m-2}(rr)(Y_{n-1})))$$
%
where $rr=(x^{m}_0,\dots,x^{m}_{m-1},r)$ and the second equality holds by our assumption on $X$ and $Y$. The required formula follows from the equality 
%
$$qq^j(rr)(Y_{m+j+1})=\sigma_{\lm}(r,Y_{m+j+1})$$
%
\item Operation $\wt{S}'$ is defined on the set of pairs $(m,(X,r))\in \wt{Ob}'$, $(n,(Y,s))\in \wt{Ob}'$ such that 
%
$$\partial(mb^!((n,(Y,s))))>\partial(mb^!(m,(X,r)))$$
%
which is equivalent to 
%
$$(n+1,Y)>(m+1,X)$$
%
which is, in turn, equivalent to the conditions in the theorem. The operation itself is given by:
%
$$\wt{S}'((m,(X,r)),(n,(Y,s)))=mb((mb^!(m,(X,r)))^*(mb^!((n,(Y,s)))))=$$
$$mb((ft((m+1,X)),((m+1,X),rr))^*((ft(n+1,Y),((n+1,Y),ss))))$$
%
where
%
$$rr=(x_0^m,\dots,x_{m-1}^n,r)$$
$$ss=(x_0^n,\dots,x_{n-1}^n,s)$$
%
By Lemma \ref{2015.09.03.l1} we can extend this equality as follows:
%
$$mb((ft((m+1,X)),((m+1,X),rr))^*((ft(n+1,Y),((n+1,Y),ss))))=$$
$$mb(((mb^!(m,(X,r)))^*(ft(\Gamma)),((mb^!(m,(X,r)))^*(\Gamma),(x_0^{n-1},\dots,x^{n-1}_{n-2},(qq^{n-m-1}(rr))(s)))))=$$
$$(n-1,((mb^!(m,(X,r)))^*(\Gamma),(qq^{n-m-1}(rr))(s)))=$$
$$(n-1,(S'((m,(X,r)),(n+1,Y))),\sigma_{\rr}(r,s))$$
%
where $\Gamma'=ft(m,X)$, $\Gamma=(n+1,Y)$, the first equality is by Lemma {2015.09.03.l1} and the third equality by Definition Definition \ref{2015.08.26.def1}(3). 
\item Operation $\delta'$ is defined on the subset $(n,X)\in Ob$ such that $n>0$ and is given by
%
$$\delta'((n,X))=mb(\delta((n,X)))$$
%
Therefore it is sufficient to show that
%
$$\delta((n,X))=((n,X),(p_{(n,X)}^*((n,X)),(x_0^n,\dots,x_{n-1}^n,x_{n-1}^n)))$$
%
By Definition \ref{2015.08.26.def1}(5), $\delta((n,X))$ is a morphism from $(n,X)$ to $p_{(n,X)}^*((n,X))$. Therefore, since $Fl$ is a fully faithful functor it is sufficient to show that 
%
$$Fl(\delta((n,X)))=(n,(n+1,(x_0^n,\dots,x_{n-1}^n,x_{n-1}^n)))$$
%
which follows from Lemma \ref{2015.09.03.l2}(5) and Lemma \ref{2015.08.24.l5}.
%
\end{enumerate}
\end{proof}
%
\begin{remark}\rm
\llabel{2015.09.07.rem5}
As we did in Remark \ref{2015.08.29.rem1} for $R$ so we can do for $LM$, representing the category of pairs $(R,LM)$, which is equivalent to the full subcategory of finitary objects in the Hirschowitz-Maggesi category for $Sets$, as follows.

Given an l-algebraic theory $l\rr=(lR,l,\eta,\partial,\sigma)$ we can define a left l-module $l\lm$ over $\rr$ as a quadruple:
%
\begin{enumerate}
\item a set $lLM$,
\item a function $l_{\lm}:lLM\sr \nn$,
\item a function $\partial_{\lm}:\{E\in lLM, i\in\nat\,|\, l_{\lm}(E)\ge i\}\sr lLM$,
\item a function 
%
$$\sigma_{\lm}:\{r\in lR,E\in lLM\,|\,l_{\lm}(E)>l_{\rr}(r)\}\sr lLM$$
%
\end{enumerate}
%
where operations $l_{\lm},\partial_{\lm}$ and $\sigma_{\lm}$ satisfy some conditions. 

Once these conditions are properly established the category of such pairs $(l\rr,l\lm)$ should be equivalent to the Hirschowitz-Maggesi category and in particular the systems of expressions associated with binding signatures can be described as universal objects carrying some additional operations in this category. 

Let us emphasize again that the main reason to consider these l-versions of the main constructions of this paper is that they should be easier to formalize in systems without dependent types such as HOL or ZF. 
\end{remark} 
%









\subsection{C-subsystems of $CC(\rr,\lm)$.}
%
Let $CC$ be a C-subsystem of $CC(\rr,\lm)$.  Then, obviously, $Ob(CC)\subset Ob(CC(\rr,\lm))$ and $\wt{Ob}(CC)\subset \wt{Ob}(CC(\rr,\lm))$. It was proved in \cite[Lemma 4.1]{Csubsystems} that the function 
%
$$CC\mapsto (Ob(CC)\subset Ob(CC(\rr,\lm)),\wt{Ob}(CC)\subset \wt{Ob}(CC(\rr,\lm))$$
%
is an injection from the set of C-subsystems of $CC(\rr,\lm)$ to the set of pairs of subsets in $Ob(CC(\rr,\lm))$ and $\wt{Ob}(CC(\rr,\lm))$ and in \cite[Proposition 4.3]{Csubsystems} that its image consists of those pairs of subsets $(B,\wt{B})$ that satisfy the following conditions:
%
\begin{enumerate}
\item $pt\in B$
\item if $X\in B$ then $ft(X)$ is in $B$,
\item if $r\in \wt{B}$ then $\partial(r)\in \wt{B}$,
\item if $X\in B$, $s\in \wt{B}$ and $(X,s)\in \wt{T}_{dom}$ then $\wt{T}(X,s)\in \wt{B}$,
\item if $r,s\in \wt{B}$ and $(r,s)\in \wt{S}_{dom}$ then $\wt{S}(s,r)\in \wt{B}$,
\item if $X\in B$ and $X\in \delta_{dom}$ then $\delta(X)\in \wt{B}$.
\end{enumerate}
%
Clearly the same result holds for subsets $B\subset Ob(CC(\rr,\lm))$ and $\wt{B}'\subset \wt{Ob}'$ if we replace $\partial$ by $\partial'$ (where $\partial'(m,(X,r))=X$),  $T$ by $T'$ and $\wt{S}$ by $\wt{S}'$.

Let us combine this result with the explicit description of the operations $T'$ and $\wt{S'}$ obtained in Theorem \ref{2015.08.26.th2} and the following notation:
%
\begin{enumerate}
\item for $(m,X)$ in $Ob(CC(\rr,\lm))$ we write $(X\rhd^{B})$ if $(m,X)\in B$, when no confusion is possible we will omit the superscript $\rhd^B$ from $\rhd$,
\item for $(m,(X,r))$ in $\wt{Ob}'(\rr,\lm)$ we write $(X\rhd^{\wt{B}} r:X_m)$ if $(m,(X,r))$ is in $\wt{B}'$, similarly to what was said above, if no confusion is possible we will omit the superscript $\wt{B}'$ from $\rhd$. 
\end{enumerate}
%
Those who are used to the turnstile notations $(X_0,\dots,X_{m-1}\vdash r:X_m)$ for the statement that the ``judgement'' that $r$ is an object of type $X_m$ in the context $(X_0,\dots,X_{m-1})$  is derivable, should only replace $\vdash$ with $\rhd$ and sometimes add the superscript with $B$ or $\wt{B}$ referring to the class of judgements that are derivable relative to the particular systems of inference rules under consideration\footnote{The reason for the replacement of the familiar $\vdash$ with the unfamiliar $\rhd$ is that $\vdash$ carries a meaning in logic that does not always agree with its use in type theory, for example $\Gamma\vdash$ reads as $\Gamma$ implies the empty set set of conclusions which always holds and so $\Gamma\vdash$ always holds, while the type theoretic meaning is that $\Gamma$ is a well-formed context of the type theory under considerations.}. In a subsequent paper we will consider the case when the sets $B$ and $\wt{B}$ are the sets of derivable judgements relative to a set of inference rules with both the concept of an inference rule and that of the derivability being precisely defined in the mathematical terms. So far, $B$ and $\wt{B}$ may refer to any subsets on $Ob$ and $\wt{Ob}$ respectively. 

Another group of notations that we would like to introduce is as follows. Recall that our use of sequences such as $(X_0,\dots,X_{m-1})$ is a notational convention and that the object underlying this notation is a dependent function with the domain $stn(m)$ and the codomain function $i\mapsto R(i)$. In what follows we will use more such notations explained below:
%
\begin{enumerate}
\item Given a dependent function on $stn(m)$, $\Gamma=(X_0,\dots,X_{m-1})$ where $X_i\in LM(\wh{i})$ and a dependent function on $\{j\in\nat\,|\, j\ge m, j<n\}$, $\Delta=(X_m,\dots,X_{n-1})$ where $X_j\in LM(\wh{j})$ we will write $(\Gamma,\Delta)$ for the dependent function of the obvious form on $stn(n)$,
%
\item Given $\Delta=(X_m,\dots,X_{m+j})$ where $X_i\in LM(\wh{i})$ and $k\ge i$ we define 
%
$$\partial^k(\Delta)=(\partial^k_m(X_m),\dots,\partial^k_{m+j}(X_{m+j})).$$  
%
\item Given $\Delta=(X_m,\dots,X_{m+j})$ where $X_i\in LM(\wh{i})$ and $r\in R(j)$ where $j<m$ we define
%
$$\sigma_{\lm}(s,\Delta)=(\sigma_{\lm}(s,X_m),\dots,\sigma_{\lm}(s,X_{m+j})).$$
%
\end{enumerate}
%
In this notation the description of the operations $T,\wt{T},S,\wt{S}$ and $\delta$  given in Theorem \ref{2015.08.26.th2} takes the form:
%
\begin{enumerate}
\item $T((\Gamma,X_m\rhd),(\Gamma,\Delta\rhd))=(\Gamma,X_m,\partial^m(\Delta)\rhd)$ where $m=l_f(\Gamma)$,
\item $\wt{T}((\Gamma,X_m\rhd),(\Gamma,\Delta\rhd s:Y_n))=(\Gamma,X_m,\partial^m(\Delta)\rhd \partial^m(s:Y_n))$ where $m=l_f(\Gamma)$,
\item $S((\Gamma\rhd r:X_m),(\Gamma,X_m,\Delta\rhd))=(\Gamma,\sigma_{\lm}(r,\Delta)\rhd)$,
\item $\wt{S}((\Gamma\rhd r:X_m),(\Gamma,X_m,\Delta\rhd s:Y_n))=(\Gamma,\sigma_{\lm}(r,\Delta)\rhd \sigma_{\lm}(r,s):\sigma_{\lm}(r,Y_n))$,
\item $\delta(\Gamma,X_m\rhd)=(\Gamma,X_m\rhd x^{m+1}_m:X_m)$ where $m=l_f(\Gamma)$.
\end{enumerate}
%

The following result is an immediate corollary of \cite[Proposition 4.3]{Csubsystems} together with the description of the operations $T,\wt{T},S,\wt{S}$ and $\delta$ for $CC(\rr,\lm)$ which is given above. 
%
\begin{proposition}
\llabel{2009.10.16.prop3}
Let $(\rr,\lm)$ be as above. Let $(B,\wt{B}')$ be a pair of subsets in $Ob(CC(\rr,\lm))$ and $\wt{Ob}'(\rr,\lm)$ respectively. Then the following two conditions are equivalent:
%
\begin{enumerate}
\item There exists a C-subsystem $CC$ of $CC(\rr,\lm)$ such that $Ob(CC)=B$ and $mb_{\rr,lm}(\wt{Ob}(CC))=\wt{B}'$ as subsets in $Ob(CC(\rr,\lm))$ and $\wt{Ob}(\rr,\lm)$ respectively.
\item The following conditions hold:
%
\begin{enumerate}
\item $(\rhd^{B})$
\item $(\Gamma, X_m\rhd^{B})\Rightarrow (\Gamma\rhd^{B})$
\item $(\Gamma\rhd^{\wt{B}} r:X_m)\Rightarrow (\Gamma,X_m\rhd^{B})$
\item $(\Gamma, X_m\rhd^{B})\wedge(\Gamma,\Delta,\rhd^{\wt{B}} s:Y_n)\Rightarrow  (\Gamma, X_m, \partial^{m}(\Delta)\rhd^{\wt{B}} \partial^{m} (s): \partial^{m}(Y_n))$
where $m=l_f(\Gamma)$
\item  $(\Gamma\rhd^{\wt{B}}  r:X_m)\wedge (\Gamma,X_m,\Delta\rhd^{\wt{B}} s:Y_n)\Rightarrow (\Gamma, \sigma_{\lm}(r,\Delta) \rhd^{\wt{B}} \sigma_{\lm}(r,s) : \sigma_{\lm}(r,Y_n))$ ,
%
\item $(\Gamma,X_m\rhd^{B})\Rightarrow (\Gamma,X_m\rhd^{\wt{B}} x_{m}^{m+1}:X_m)$ where $m=l_f(\Gamma)$.
\end{enumerate}
\end{enumerate}
%
In addition if a C-subsystem $CC$ satisfying the conditions of the proposition exists then it is unique.  
%
\end{proposition}
%
Note that conditions (4) and (5) together with condition (6) and condition (3) imply the following 
%
\begin{description}
\item[{\em 4a}] $(\Gamma, X_m\rhd^{B})\wedge (\Gamma,\Delta\rhd^{B})\Rightarrow (\Gamma, X_m, \partial^m(\Delta)\rhd^{B})$ where $m=l_f(\Gamma)$,
%
\item[{\em 5a}] $(\Gamma\rhd^{\wt{B}}  r:X_m)\wedge (\Gamma,X_m,\Delta\rhd^{B})\Rightarrow (\Gamma, \sigma_{\lm}(r,\Delta)\rhd^{B})$.
%
\end{description}
%
\begin{remark}\rm\llabel{2010.08.07.rem1} If one re-writes the conditions of Proposition \ref{2009.10.16.prop3} in the more familiar in type theory form where the variables introduced in the context are named rather than directly numbered and where the numbering is not from $0$ but from $1$ one arrives at the following rules:
%
\begin{center}
%
$$\frac{}{\rhd^{B}}\,\,\,\,\,\,\,\,\,\,
\frac{x_1:T_1,\dots,x_n:T_n\rhd^{B}}{x_1:T_1,\dots,x_{n-1}:T_{n-1}\rhd^{B}} \,\,\,\,\,\,\,\,\,\, 
\frac{x_1:T_1,\dots,x_n:T_n\rhd^{\wt{B}'} t:T}{x_1:T_1,\dots,x_n:T_n, y:T\rhd^{B}}$$

$$\frac{x_1:T_1,\dots,x_n:T_n, y:T\rhd^{B}\,\,\,\,\,\,\,x_1:T_1,\dots,x_n:T_n,\dots, x_m:T_m\rhd^{\wt{B}'} r:R}{x_1:T_1,\dots,x_n:T_n, y:T, x_{n+1}:T_{n+1},\dots,x_m:T_m\rhd^{\wt{B}'} r:R}$$

$$\frac{x_1:T_1,\dots,x_n:T_n\rhd^{\wt{B}'} s:S\,\,\,\,\,\,\,x_1:T_1,\dots,x_n:T_n,y:S,x_{n+1}:T_{n+1},\dots,x_m:T_m\rhd^{\wt{B}'} r:R}
{x_1:T_1,\dots,x_n:T_n,x_{n+1}:T_{n+1}[s/y],\dots,x_m:T_m[s/y]\rhd^{\wt{B}'} (r:R)[s/y]}$$

$$\frac{x_1:E_1,\dots,x_n:E_n\rhd^{B}}{x_1:E_1,\dots,x_n:E_n\rhd^{\wt{B}'} x_n:E_n}$$

\end{center}
%
which are similar (and probably equivalent) to the ``basic rules of DTT'' given in \cite[p.585]{Jacobs1}. The advantage of the rules given here is that they are precisely the ones which are necessary and sufficient for a given collection of contexts and judgements to define a C-subsystem.
\end{remark}
%
The following lemma is needed in order to show that the pre-category that we obtain from $(B,\wt{B})$ using our construction of a sub-C-system from a pair of subsets in $Ob$ and $\wt{Ob}'$ satisfying certain conditions has the same morphisms as the pre-category whose construction from such subsets is outlined  in more traditional texts such as \cite{MH1995}. The fact that one obtains the same composition is more difficult to prove since I do not know of any traditional texts where the composition would be described in sufficient detail. 
%
\begin{lemma}
\llabel{2009.11.05.l1}
Let $(B,\wt{B}')$ be a pair of subsets satisfying the conditions of Proposition \ref{2009.10.16.prop3} and let $CC$ be the corresponding C-subsystem of $CC(\rr,\lm)$. Let $(m,X),(n,Y)\in B$ and 
%
$$f=((m,X),((n,Y),(f_0,\dots,f_{n-1}))\in Hom_{CC(\rr,\lm)}((m,X),(n,Y))$$
%
Then $f\in Hom_{CC}((m,X), (n,Y))$ if an only if 
%
$$f\circ p_{(n,Y)}\in Hom_{CC}((m,X), ft((n,Y)))$$
%
and 
%
\begin{eq}\llabel{2015.09.09.eq4}
(X_0,\dots,X_{m-1}\rhd^{\wt{B}'} f_{n-1} : (f_0,\dots,f_{n-2})(Y_{n-1}))
\end{eq}
%
\end{lemma}
%
\begin{proof}
The expression (\ref{2015.09.09.eq4}) is our notation for the statement that 
%
$$(m,((X_0,\dots,X_{m-1},(f_0,\dots,f_{n-2})(Y_{n-1})),f_{n-1}))\in \wt{B}'$$
%
By Lemma \ref{2015.09.09.l3} this is equivalent to the condition that $s_f\in \wt{B}$ where $\wt{B}=mb^!_{\rr,\lm}(\wt{B}')$. By definition of $CC$ in Proposition \ref{2009.10.16.prop3} we have $\wt{B}=\wt{Ob}(CC)$. 

By \cite[Definition 2.3(3)]{Csubsystems} we have 
%
$$f=s_f\circ q(f\circ p_{(n,Y)},(n,Y))$$
%
therefore if $s_f\in Mor(CC)$ and $f\circ p_{(n,Y)}\in Mor(CC)$ then $f\in Mor(CC)$ since $CC$ is a C-subsystem of $CC(\rr,\lm)$. This proves the "if" part of the Lemma. 

The "only if" part follows similarly from the assumption that $CC$ is a C-subsystem and therefore both $f\circ p_{(n,Y)}$ and $s_f$ belong to $Mor(CC)$.
\end{proof}
%






\subsection{Operations $\sigma$ and $\wt{\sigma}$.}
%
C-systems of the form $CC(\rr,\lm)$ have an important additional structure which will play a role in the next section. This structure is given by two operations:
%
\begin{enumerate}
\item For $(m,X)$, $(n,Y)$ where $m\ge n$ we define $\sigma((m,X),(n,Y))$ as the object given in the sequence notation by 
%
$$\sigma((m,X),(n,Y))=(Y_0,\dots,Y_{n-1},X_n,\dots,X_{m-1})$$
%
This gives us an operation with values in $Ob$ defined on the subset of $Ob\times Ob$ which consists of pairs $(\Gamma,\Gamma')$ such that $l_f(\Gamma)\ge l_f(\Gamma')$. Note that for $m=n$ one has 
%
$$\sigma((m,X),(n,Y))=(n,Y)$$
%
\item for $(m,(X,r))$ in $\wt{Ob}'$ and $(n,Y)\in Ob$ such that $m+1\ge n$
%
$$\wt{\sigma}((m,(X,r)),(n,Y))=(m, (\sigma((m+1,X),(n,Y)),r))$$
%
This gives us an operation with values in $\wt{Ob}'$ defined on the subset of $\wt{Ob}'\times Ob$ which consists of pairs $(r,\Gamma')$ such that $l_f(\partial(r)\le l_f(\Gamma')$.
\end{enumerate}
%
Both operations can be easily re-written using $\wt{Ob}$ instead of $\wt{Ob}'$ but no analog of these operations exist on general, non-split, C-systems (cf. Remark \ref{}). 



\subsection{Regular sub-quotients of $CC(\rr,\lm)$.} 
%
The concept of a regular congruence relation on a C-system was introduced in \cite[Section 5]{Csubsystems}. This concept is crucial for the mathematics analysis of quotients of the C-systems that arise from ``definitional equalities'' of type systems.

We are going here to describe the regular congruence  relations  on C-systems of the form $CC(\rr,\lm)$ in terms of pairs of subsets 
%
$$Beq\subset \coprod_{n\in\nat}  Ob_n(\rr,\lm)\times (LM(\wh{n})\times LM(\wh{n}))$$
$$\wt{Beq}'\subset \coprod_{n\in\nat}  Ob_n(\rr,\lm)\times (LM(\wh{n})\times (R(n)\times R(n))$$
%
satisfying certain conditions. 

For $\Gamma\in Ob(CC(\rr,\lm))$ and $S_1,S_2\in LM(n)$ we write $(\Gamma\rhd^{Beq} S_1=S_2)$ to signify that $(\Gamma,(S_1,S_2))\in Beq$. Similarly for $T\in LM(n)$ and $o,o'\in R(n)$ we write $(\Gamma\rhd^{\wt{Beq}'} o=o':T)$ to signify that $(T_1,\dots,T_n,S,o,o')\in \wt{Beq}$.  When no confusion is possible we will omit the subscripts $Beq$ and $\wt{Beq}'$ at $\rhd$. 

Similarly we will write $\rhd$ instead of $\rhd^C$ and $\rhd$ instead of $\rhd^{\wt{B}}$ if the subsets $C$ and $\wt{B}$ are unambiguously  determined by the context.  

%
\begin{definition}
\llabel{simandsimeq}
Given subsets $C$, $\wt{B}$, $Beq$, $\wt{Beq}$ as above define relations $\sim$ on $C$ and $\simeq$ on $\wt{B}$ as follows:
%
\begin{enumerate}
\item for $\Gamma=(T_1,\dots,T_n)$, $\Gamma'=(T_1',\dots,T_n')$ in $C$ we set  $\Gamma\sim\Gamma'$ iff $ft(\Gamma)\sim ft(\Gamma')$ and 
%
$$T_1,\dots,T_{n-1}\rhd T_n=T_n',$$
\item for $(\Gamma\rhd o:S)$, $(\Gamma'\rhd o':S')$ in $\wt{B}$ we set $(\Gamma\rhd o:S)\simeq(\Gamma'\rhd o':S')$ iff $(\Gamma,S)\sim(\Gamma',S')$ and 
%
$$(\Gamma\rhd o=o':S).$$
\end{enumerate}
\end{definition}
%

\begin{proposition}
\llabel{2014.07.10.prop1}
%
Let $C$, $\wt{B}$, $Beq$, $\wt{Beq}$ be as above and suppose in addition that one has:
%
\begin{enumerate}
\item $C$ and $\wt{B}$ satisfy conditions (1)-(6) of Proposition \ref{2009.10.16.prop3} which are referred to below as conditions (1.1)-(1.6) of the present proposition,
%
\item 
%
$$
\begin{array}{l}
(a)\spc(\Gamma\rhd T=T')\impl (\Gamma,T\rhd)\\
(b)\spc(\Gamma,T\rhd)\impl (\Gamma\rhd T=T)\\
(c )\spc(\Gamma\rhd T=T')\impl(\Gamma\rhd T'=T)\\
(d)\spc(\Gamma\rhd T=T')\wedge(\Gamma\rhd T'=T'')\impl(\Gamma\rhd T=T'')
\end{array}
$$
%
\item 
%
$$
\begin{array}{l}
(a)\spc(\Gamma\rhd o=o':T)\impl (\Gamma\rhd o:T)\\
(b)\spc(\Gamma\rhd o:T)\impl (\Gamma\rhd o=o:T)\\
(c )\spc(\Gamma\rhd o=o':T)\impl(\Gamma\rhd o'=o:T)\\
(d)\spc (\Gamma\rhd o=o':T)\wedge(\Gamma\rhd o'=o'':T)\impl(\Gamma\rhd o=o'':T)
\end{array}
$$
%
\item 
%
$$
\begin{array}{l}
(a)\spc (\Gamma_1\rhd T=T')\wedge(\Gamma_1,T,\Gamma_2\rhd S=S')\impl(\Gamma_1,T',\Gamma_2\rhd S=S')\\
(b)\spc (\Gamma_1\rhd T=T')\wedge(\Gamma_1,T,\Gamma_2\rhd o=o':S)\impl(\Gamma_1,T',\Gamma_2'\rhd o=o':S)\\
(c )\spc (\Gamma\rhd S=S')\wedge(\Gamma\rhd o=o':S)\impl(\Gamma\rhd o=o':S')
\end{array}
$$
%
\item 
%
$$
\begin{array}{ll}
(a)\spc (\Gamma_1,T\rhd)\wedge(\Gamma_1,\Gamma_2\rhd S=S')\impl(\Gamma_1,T,t_{i+1}\Gamma_2\rhd t_{i+1}S=t_{i+1}S')& i=l(\Gamma)\\
(b)\spc (\Gamma_1,T\rhd)\wedge(\Gamma_1,\Gamma_2\rhd o=o':S)\impl(\Gamma_1,T,t_{i+1}\Gamma_2\rhd t_{i+1}o=t_{i+1}o':t_{i+1}S)& i=l_f(\Gamma)
\end{array}
$$
%
\item
%
$$
\begin{array}{ll}
(a)\spc (\Gamma_1,T,\Gamma_2\rhd S=S')\wedge(\Gamma_1\rhd r:T)\impl&\\
(\Gamma_1,s_{i+1}(\Gamma_2[r/i+1])\rhd s_{i+1}(S[r/i+1])=s_{i+1}(S'[r/i+1]))&i=l_f(\Gamma_1)\\
(b)\spc (\Gamma_1,T,\Gamma_2\rhd o=o':S)\wedge(\Gamma_1\rhd r:T)\impl&\\
(\Gamma_1,s_{i+1}(\Gamma_2[r/i+1])\rhd s_{i+1}(o[r/i+1])=s_{i+1}(o'[r/i+1]):s_{i+1}(S[r/i+1]))&i=l_f(\Gamma_1)
\end{array}
$$
%
\item 
%
$$
\begin{array}{ll}
(a)\spc (\Gamma_1,T,\Gamma_2,S\rhd)\wedge(\Gamma_1\rhd r=r':T)\impl&\\
(\Gamma_1,s_{i+1}(\Gamma_2[r/i+1])\rhd s_{i+1}(S[r/i+1])=s_{i+1}(S[r'/i+1]))&i=l_f(\Gamma_1)\\
(b)\spc (\Gamma_1,T,\Gamma_2\rhd o:S)\wedge(\Gamma_1\rhd r=r':T)\impl&\\
(\Gamma_1,s_{i+1}(\Gamma_2[r/i+1])\rhd s_{i+1}(o[r/i+1])=s_{i+1}(o[r'/i+1]):s_{i+1}(S[r/i+1]))&i=l_f(\Gamma_1)
\end{array}
$$
\end{enumerate}
%
Then the relations $\sim$ and $\simeq$ are equivalence relations on $C$ and $\wt{B}$ which satisfy the conditions of \cite[Proposition 5.4]{Csubsystems} and therefore they correspond to a regular congruence relation on the C-system defined by $(C,\wt{B})$. 
\end{proposition}
%
\begin{lemma}
\llabel{iseqrelsiml1}
One has:
%
\begin{enumerate}
\item If conditions (1.2), (4a) of the proposition hold then $(\Gamma\rhd S=S')\wedge(\Gamma\sim\Gamma')\impl (\Gamma'\rhd S=S')$.
\item If conditions (1.2), (1.3), (4a), (4b), (4c) hold then $(\Gamma\rhd o=o':S)\wedge((\Gamma,S)\sim(\Gamma',S'))\impl (\Gamma'\rhd o=o':S')$.
\end{enumerate}
\end{lemma}
%
\begin{proof}
By induction on $n=l_f(\Gamma)=l_f(\Gamma')$.

(1) For $n=0$ the assertion is obvious. Therefore by induction we may assume that $(\Gamma\rhd S=S')\wedge(\Gamma\sim\Gamma')\impl (\Gamma'\rhd S=S')$ for all $i<n$ and all appropriate $\Gamma$,$\Gamma'$, $S$ and $S'$ and that $(T_1,\dots,T_n\rhd S=S')\wedge(T_1,\dots,T_n\sim T'_1,\dots,T'_n)$ holds and we need to show that $(T'_1,\dots,T'_n\rhd S=S')$ holds. Let us show by induction on $j$ that $(T'_1,\dots,T'_j,T_{j+1},\dots,T_n\rhd S=S')$ for all $j=0,\dots,n$. For $j=0$ it is a part of our assumptions. By induction we may assume that $(T'_1,\dots,T'_j,T_{j+1},\dots,T_n\rhd S=S')$. By definition of $\sim$ we have $(T_1,\dots,T_j\rhd T_{j+1}=T'_{j+1})$. By the inductive assumption we have $(T'_1,\dots,T'_j\rhd T_{j+1}=T'_{j+1})$. Applying (4a) with $\Gamma_1=(T'_1,\dots T'_j)$, $T=T_{j+1}$, $T'=T'_{j+1}$ and $\Gamma_2=(T_{j+2},\dots,T_n)$ we conclude that $(T'_1,\dots,T'_{j+1},T_{j+2},\dots,T_n\rhd S=S')$.

(2)  By the first part of the lemma we have $\Gamma'\rhd S=S'$. Therefore by (4c) it is sufficient to show that $(\Gamma\rhd o=o':S)\wedge(\Gamma\sim\Gamma')\impl (\Gamma'\rhd o=o':S)$. The proof of this fact is similar to the proof of the first part of the lemma using (4b) instead of (4a).  
\end{proof}
%
\begin{lemma}
\llabel{iseqrelsim}
One has:
%
\begin{enumerate}
\item Assume that conditions (1.2), (2b), (2c), (2d) and (4a) hold. Then $\sim$ is an equivalence relation.
\item Assume that conditions of the previous part of the lemma as well as conditions (1.3), (3b), (3c), (3d), (4b) and (4c) hold. Then $\simeq$ is an equivalence relation. 
\end{enumerate}
\end{lemma}
%
\begin{proof}
By induction on $n=l_f(\Gamma)=l_f(\Gamma')$. 

(1) Reflexivity follows directly from (1.2) and (2b). For $n=0$ the symmetry is obvious. Let $(\Gamma,T)\sim(\Gamma',T')$. By induction we may assume that $\Gamma'\sim\Gamma$. By Lemma \ref{iseqrelsiml1}(a) we have $(\Gamma'\rhd T=T')$ and by (2c) we have $(\Gamma'\rhd T'=T)$. We conclude that $(\Gamma',T')\sim(\Gamma,T)$.  The proof of transitivity is by a similar induction.

(2) Reflexivity follows directly from  reflexivity of $\sim$, (1.3) and (3b). Symmetry and transitivity are also easy using Lemma \ref{iseqrelsiml1}.
\end{proof}
%
From this point on we assume that all conditions of Proposition \ref{2014.07.10.prop1}  hold. Let $C'=C/\sim$ and $\wt{B}'=\wt{B}/\simeq$. It follows immediately from our definitions that the functions $ft:C\sr C$ and $\partial:\wt{B}\sr C$ define functions $ft':C'\sr C'$ and $\partial':\wt{B}'\sr C'$.
%
\begin{lemma}
\llabel{surjl1}
The conditions (3) and (4) of \cite[Proposition 5.4]{Csubsystems} hold for $\sim$ and $\simeq$.
\end{lemma}
%
\begin{proof}
1. We need to show that for $(\Gamma,T\rhd)$, and $\Gamma\sim\Gamma'$ there exists $(\Gamma',T'\rhd)$ such that $(\Gamma,T)\sim(\Gamma',T')$. It is sufficient to take $T=T'$. Indeed by (2b) we have $\Gamma\rhd T=T$, by Lemma \ref{iseqrelsiml1}(1) we conclude that $\Gamma'\rhd T=T$ and by (1a) that $\Gamma',T\rhd$.  

2.  We need to show that for $(\Gamma\rhd o:S)$ and $(\Gamma,S)\sim(\Gamma',S')$ there exists $(\Gamma'\rhd o':S')$ such that $(\Gamma'\rhd o':S')\simeq(\Gamma\rhd o:S)$. It is sufficient to take $o'=o$. Indeed, by (3b) we have $(\Gamma\rhd o=o:S)$, by Lemma \ref{iseqrelsiml1}(2) we conclude that $(\Gamma'\rhd o=o:S')$ and by (2a) that $(\Gamma'\rhd o:S')$. 
\end{proof}
%
\begin{lemma}
\llabel{TSetc}
The equivalence relations $\sim$ and $\simeq$ are compatible with the operations $T,\wt{T},S,\wt{S}$ and $\delta$.
\end{lemma}
%
\begin{proof}
(1) Given $(\Gamma_1,T\rhd)\sim(\Gamma_1',T'\rhd)$ and $(\Gamma_1,\Gamma_2\rhd)\sim(\Gamma_1',\Gamma_2'\rhd)$ we have to show that 
%
$$(\Gamma_1,T,\partial^n\Gamma_2)\sim (\Gamma'_1,T',\partial^n\Gamma'_2).$$
%
where $n=l_f(\Gamma_1)=l_f(\Gamma_1')$.

Proceed by induction on $l_f(\Gamma_2)$. For $l_f(\Gamma_2)=0$ the assertion is obvious. Let  $(\Gamma_1,T\rhd)\sim(\Gamma_1',T'\rhd)$ and $(\Gamma_1,\Gamma_2,S\rhd)\sim(\Gamma_1',\Gamma_2',S'\rhd)$. The later condition is equivalent to $(\Gamma_1,\Gamma_2\rhd)\sim(\Gamma_1',\Gamma_2'\rhd)$  and $(\Gamma_1,\Gamma_2\rhd S=S')$. By the inductive assumption we have $(\Gamma_1,T,\partial^n\Gamma_2)\sim (\Gamma'_1,T',\partial^n\Gamma'_2)$. By (5a) we conclude that $(\Gamma_1,T,\partial^n\Gamma_2\rhd \partial^nS=\partial^nS')$. Therefore by definition of $\sim$ we have $(\Gamma_1,T,\partial^n\Gamma_2,\partial^nS)\sim(\Gamma'_1,T',\partial^n\Gamma'_2, \partial^nS')$.

(2) Given $(\Gamma_1,T\rhd)\sim(\Gamma_1',T'\rhd)$ and $(\Gamma_1,\Gamma_2\rhd o:S)\simeq(\Gamma_1',\Gamma_2'\rhd o':S')$ we have to show that $(\Gamma_1,T,\partial^n\Gamma_2\rhd \partial^no:\partial^nS)\simeq (\Gamma'_1,T',\partial^n\Gamma'_2\rhd \partial^no':\partial^nS')$ where $n=l_f(\Gamma_1)=l_f(\Gamma_1')$. We have $(\Gamma_1,\Gamma_2,S)\sim(\Gamma_1',\Gamma'_2,S')$ and $(\Gamma_1,\Gamma_2\rhd o=o':S)$. By (5b) we get $(\Gamma_1,T, \partial^n\Gamma_2\rhd \partial^no=\partial^no':\partial^nS)$. By (1) of this lemma we get $(\Gamma_1,T,\partial^n\Gamma_2,\partial^nS)\sim(\Gamma'_1,T',\partial^n\Gamma'_2,\partial^nS')$ and therefore by definition of $\simeq$ we get $(\Gamma_1,T,\partial^n\Gamma_2\rhd \partial^no:\partial^nS)\simeq (\Gamma'_1,T',\partial^n\Gamma'_2\rhd \partial^no':\partial^nS')$.

(3) Given $(\Gamma_1\rhd r:T)\simeq(\Gamma_1'\rhd r':T')$ and $(\Gamma_1,T,\Gamma_2\rhd)\sim(\Gamma_1',T',\Gamma_2'\rhd)$ we have to show that 
%
$$(\Gamma_1,s_{n+1}(\Gamma_2[r/n+1]))\sim(\Gamma'_1,s_{n+1}(\Gamma'_2[r'/n+1])).$$
%
where $n=l_f(\Gamma_1)=l_f(\Gamma_1')$. Proceed by induction on $l_f(\Gamma_2)$. For $l_f(\Gamma_2)=0$ the assertion follows directly from the definitions. Let $(\Gamma_1\rhd r:T)\simeq(\Gamma_1'\rhd r':T')$ and $(\Gamma_1,T,\Gamma_2,S\rhd)\sim(\Gamma_1',T',\Gamma_2',S'\rhd)$. The later condition is equivalent to $(\Gamma_1,T,\Gamma_2\rhd)\sim(\Gamma_1',T',\Gamma_2'\rhd)$  and $(\Gamma_1,T,\Gamma_2\rhd S=S')$. By the inductive assumption we have $(\Gamma_1,s_{n+1}(\Gamma_2[r/n+1]))\sim(\Gamma'_1,s_{n+1}(\Gamma'_2[r'/n+1]))$. It remains to show that $(\Gamma_1,s_{n+1}(\Gamma_2[r/n+1])\rhd s_{n+1}(S[r/n+1])=s_{n+1}(S'[r'/n+1]))$. By (2d) it is sufficient to show that $(\Gamma_1,s_{n+1}(\Gamma_2[r/n+1])\rhd s_{n+1}(S[r/n+1])=s_{n+1}(S'[r/n+1]))$ and $(\Gamma_1,s_{n+1}(\Gamma_2[r/n+1])\rhd s_{n+1}(S'[r/n+1])=s_{n+1}(S'[r'/n+1]))$. The first relation follows directly from (6a). To prove the second one it is sufficient by (7a) to show that $(\Gamma_1,T,\Gamma_2,S'\rhd)$ which follows from our assumption through (2c) and (2a). 

(4) Given $(\Gamma_1\rhd r:T)\simeq(\Gamma_1'\rhd r':T')$ and $(\Gamma_1,T,\Gamma_2\rhd o:S)\simeq(\Gamma_1',T',\Gamma_2'\rhd o':S')$ we have to show that 
%
$$(\Gamma_1,s_{n+1}(\Gamma_2[r/n+1])\rhd s_{n+1}(o[r/n+1]):s_{n+1}(S[r/n+1]))\simeq$$ 
$$ (\Gamma'_1,s_{n+1}(\Gamma'_2[r'/n+1])\rhd s_{n+1}(o'[r'/n+1]):s_{n+1}(S'[r'/n+1])).$$
%
%
where $n=l_f(\Gamma_1)=l_f(\Gamma_1')$ or equivalently that 
%
$$(\Gamma_1,s_{n+1}(\Gamma_2[r/n+1]),s_{n+1}(S[r/n+1]))\sim(\Gamma'_1,s_{n+1}(\Gamma'_2[r'/n+1]), s_{n+1}(S'[r'/n+1]))$$
%
and $(\Gamma_1,s_{n+1}(\Gamma_2[r/n+1])\rhd s_{n+1}(o[r/n+1])=s_{n+1}(o'[r'/n+1]):s_{n+1}(S[r/n+1]))$. The first statement follows from part (3) of the lemma. To prove the second statement it is sufficient by (3d) to show that  $(\Gamma_1,s_{n+1}(\Gamma_2[r/n+1])\rhd s_{n+1}(o[r/n+1])=s_{n+1}(o'[r/n+1]):s_{n+1}(S[r/n+1]))$ and  $(\Gamma_1,s_{n+1}(\Gamma_2[r/n+1])\rhd s_{n+1}(o'[r/n+1])=s_{n+1}(o'[r'/n+1]):s_{n+1}(S[r/n+1]))$. The first assertion follows directly from (6b). To prove the second one it is sufficient in view of (7b) to show that $(\Gamma_1,T,\Gamma_2\rhd o':S)$ which follows conditions (3c) and (3a).

(5) Given $(\Gamma,T)\sim(\Gamma',T')$ we need to show that $(\Gamma,T\rhd (n+1):T)\simeq(\Gamma',T'\rhd (n+1):T')$ or equivalently that $(\Gamma,T,T)\sim(\Gamma,T',T')$ and $(\Gamma,T\rhd (n+1)=(n+1):T)$. The second part follows from (3b). To prove the first part we need to show that $(\Gamma,T\rhd T=T')$. This follows from our assumption by (5a). 
\end{proof}
%
\begin{lemma}
\llabel{2014.07.12.l1}
Let $C$ be a subset of $Ob(CC(\rr,\lm))$ which is closed under $ft$. Let $\le$ be a transitive relation on $C$ such that:
%
\begin{enumerate}
\item $\Gamma\le \Gamma'$ implies $l_f(\Gamma)=l_f(\Gamma')$,
\item $\Gamma\in C$ and $ft(\Gamma)\le F$ implies $\sigma(\Gamma,F)\in C$ and $\Gamma\le \sigma(\Gamma,F)$.
\end{enumerate}
%
Then $\Gamma\in C$ and $ft^i(\Gamma)\le F$ for some $i\ge 1$, implies that $\Gamma\le \sigma(\Gamma,F)$. 
\end{lemma}
%
\begin{proof}
Simple induction on $i$.
\end{proof}
%
\begin{lemma}
\llabel{2014.07.12.l2}
Let $C$ and $\le$ be as in Lemma \ref{2014.07.12.l1}. Then one has:
%
\begin{enumerate}
\item $(\Gamma,T)\le (\Gamma,T')$ and $\Gamma\le \Gamma'$ implies that $(\Gamma,T)\le (\Gamma',T')$,
\item if $\le$ is $ft$-monotone (i.e. $\Gamma\le \Gamma'$ implies $ft(\Gamma)\le ft(\Gamma')$) and symmetric then $(\Gamma,T)\le (\Gamma',T')$ implies that $(\Gamma,T)\le (\Gamma,T')$.
\end{enumerate}
\end{lemma}
%
\begin{proof}
The first assertion follows from
%
$$(\Gamma,T)\le (\Gamma,T')\le \sigma((\Gamma,T'),\Gamma')=(\Gamma',T')$$
%
The second assertion  follows from
%
$$(\Gamma,T)\le (\Gamma',T')\le \sigma((\Gamma',T'),\Gamma)=(\Gamma,T')$$
%
where the second $\le$ requires $\Gamma'\le \Gamma$ which follows from $ft$-monotonicity and symmetry.
\end{proof}
%
\begin{lemma}
\llabel{2014.07.12.l3}
Let $C,\le$ be as in Lemma \ref{2014.07.12.l1}, let $\wt{B}$ be a subset of $\wt{Ob}(CC(\rr,\lm))$ and $\le'$ a transitive relation on $\wt{B}$ such that: 
%
\begin{enumerate}
\item ${\cal J}\le' {\cal J}'$ implies $\partial({\cal J})\le\partial({\cal J}')$,
\item ${\cal J}\in \wt{B}$ and $\partial({\cal J})\le F$ implies $\wt{\sigma}({\cal J},F)\in \wt{B}$ and ${\cal J}\le' \wt{\sigma}({\cal J},F)$.
\end{enumerate}
%
Then ${\cal J}\in \wt{B}$ and $ft^i(\partial({\cal J}))\le F$ for some $i\in\nat$ implies ${\cal J}\le \wt{\sigma}({\cal J},F)$. 
\end{lemma}
%
\begin{proof}
Simple induction on $i$.
\end{proof}
%
\begin{lemma}
\llabel{2014.07.12.l4}
Let $C,\le$ and $\wt{B},\le'$ be as in Lemma \ref{2014.07.12.l3}. Then one has:
%
\begin{enumerate}
\item $(\Gamma\rhd o:T)\le' (\Gamma\rhd o':T)$ and $(\Gamma,T)\le (\Gamma',T')$ implies that $(\Gamma\rhd o:T)\le' (\Gamma'\rhd o':T')$,
\item if $(\le,\le')$ is $\partial$-monotone (i.e. ${\cal J}\le' {\cal J}'$ implies $\partial({\cal J})\le \partial({\cal J}')$) and $\le$ is symmetric then $(\Gamma\rhd o:T)\le' (\Gamma'\rhd o':T')$ implies that $(\Gamma\rhd o:T)\le' (\Gamma\rhd o':T)$.
\end{enumerate}
\end{lemma}
%
\begin{proof}
The first assertion follows from
%
$$(\Gamma\rhd o:T)\le'  (\Gamma\rhd o':T)\le' \wt{\sigma}((\Gamma\rhd o':T) ,(\Gamma',T'))=(\Gamma'\rhd o':T')$$
%
The second assertion follows from
%
$$\Gamma\rhd o:T)\le' (\Gamma'\rhd o':T')\le' \sigma((\Gamma'\rhd o':T'),(\Gamma,T))=(\Gamma\rhd o':T)$$
%
where the second $\le$ requires $\Gamma'\le \Gamma$ which follows from $\partial$-monotonicity of $\le'$ and symmetry of $\le$.
\end{proof}
%



\begin{proposition}
\llabel{2014.07.10.prop2}
Let $(C,\wt{B})$ be subsets in $Ob(CC(\rr,\lm))$ and $\wt{Ob}(CC(\rr,\lm))$ respectively which correspond to a C-subsystem $CC$ of $CC(\rr,\lm)$. Then the constructions presented above establish a bijection between pairs of subsets $(Beq,\wt{Beq})$ which together with $(C,\wt{B})$ satisfy the conditions of Proposition \ref{2014.07.10.prop1} and pairs of equivalence relations $(\sim,\simeq)$ on $(C,\wt{B})$ such that:
%
\begin{enumerate}
\item $(\sim,\simeq)$ corresponds to a regular congruence relation on $CC$ (i.e., satisfies the conditions of \cite[Proposition 5.4]{Csubsystems}),
%
\item $\Gamma\in C$ and $ft(\Gamma)\sim F$ implies $\Gamma\sim \sigma(\Gamma,F)$,
%
\item ${\cal J}\in \wt{B}$ and $\partial({\cal J})\sim F$ implies ${\cal J}\simeq \wt{\sigma}({\cal J},F)$.
\end{enumerate}
\end{proposition}
%
\begin{proof}
One constructs a pair $(\sim,\simeq)$ from $(Beq,\wt{Beq})$ as in Definition \ref{simandsimeq}. 
This pair corresponds to a regular congruence relation by Proposition \ref{2014.07.10.prop1}.
Conditions (2),(3) follow from Lemma \ref{iseqrelsiml1}.

Let $(\sim,\simeq)$ be equivalence relations satisfying the conditions of the proposition. Define $Beq$ as the set of sequences $(\Gamma,T,T')$ such that $(\Gamma,T), (\Gamma,T')\in C$ and $(\Gamma,T)\sim (\Gamma,T')$. Define $\wt{Beq}$ as the set of sequences $(\Gamma,T,o,o')$ such that $(\Gamma,T,o),(\Gamma,T,o')\in \wt{B}$ and $(\Gamma,T,o)\simeq (\Gamma,T,o')$. 

Let us show that these subsets satisfy the conditions of Proposition \ref{2014.07.10.prop1}. Conditions (2.a-2.d) and (3.a-3d) are obvious. 

Condition (4a) follows from (2) by Lemma \ref{2014.07.12.l1}.
Conditions (4b) and (4c) follow from (3) by Lemma \ref{2014.07.12.l3}.

Conditions (5a) and (5b) follow from the compatibility of $(\sim,\simeq)$ with $T$ and $\wt{T}$. 

Conditions (6a),(6b),(7a),(7b) follow from the compatibility of $(\sim,\simeq)$ with $S$ and $\wt{S}$.
\end{proof}


























\comment{
\subsection{Pairs $(\rr,\lm)$ associated with nominal signatures.}
%
\llabel{2014.07.22.sec}
%
The constructions of this paper produce C-systems from a pair $(\rr,\lm)$ where $R$ is a monad on $Sets$ and $LM$ is a left $R$-module with values in $Sets$ together with sets $C$, $\wt{B}$, $Beq$ and $\wt{Beq}$. 

One class of such pairs is obtained by taking $R$ to be the monad defined by a signature as in \cite[p.228]{HM2007}. For example, the contextual category of the Martin-L\"{o}f type theory from 1972,  $MLTT72$ defined in \cite{ML72}, is obtained by applying Proposition \ref{2014.07.10.prop1} in the case of the pair $(R,R)$ where $R$ is the monad defined by the signature that corresponds to the nominal signature of Example \ref{2014.08.ex}.


  

The following construction that covers more examples associates a pair $(\rr,\lm)$ to a quadruple $(\Sigma, Term, P, {\bf Type})$ where $\Sigma$ is a nominal signature with one name-sort $Var$ and a set of data-sorts $D$, $Term\in {\bf D}$ is a data-sort, $P$ is a family of sets parametrized by ${\bf D}-\{Term\}$,  and ${\bf Type}\subset \{\bf D\}$ is a subset of data-sorts. 

In most examples either ${\bf D}=\{Term\}$ or ${\bf D}=\{Term,Type\}$, ${\bf Type}=\{Type\}$ and $P=P_{Type}$ is the set of "type-variables". 

The only example which I know of where there are more than two data-sorts is the logic-enriched type theory of \cite{AczelGambino} where ${\bf D}=\{Term, Type, Prop\}$, ${\bf Type}=\{Type\}$, $P_{Type}$ is the set of type variables and $P_{Prop}$ is the set of propositional variables. 

The construction is as follows.  A {\em nominal signature} (see \cite[Section 8.1]{Pitts}) starts with a set of name-sorts $\bf N$ and the set of data-sorts $\bf D$. We will be interested in the case when there is only one name-sort $Var$.

A compound sort $S$ is defined as an expression formed from $Var$, elements of $\bf D$, and the unit sort $1$ using two operations: one sending $S_1$ and $S_2$ to $(S_1,S_2)$ and another one sending $S$ to $Var.S$.  For better notations one takes $(\_,\_)$ to associate on the left i.e. $(S_1,S_2,S_3)$ means $((S_1,S_2),S_3)$ and similarly for longer sequences. 


 Let $CS$ be the set of compound sorts. An arity is a pair $(S,D)$ where $S\in CS$ and $D\in {\bf D}$. Let $A({\bf D})$ be the set of arities for the set of data-sorts $\bf D$. 

A nominal signature is defined as a set $Op$, which is called the set of operations, together with a function  $Ar:Op\sr A({\bf D})$ which assigns to any operation its ``arirty". One writes $O:S\sr D$ to denote that operation $O$ has arity $(S,D)$. We let $Ar_{CS}$ and $Ar_{\bf D}$ denote the two components of the arity. 

For example, the nominal signature of the lambda calculus has one data-sort $Term$ and three operations $V$, $L$, and $A$  of the form:
%
$$V:Var\sr Term$$
$$L:Var.Term\sr Term$$
$$A:(Term,Term)\sr Term$$
%
The algebraic signature with one sort $Term$, one operation $S$ in one variable and one constant $O$ will, in this language, have {\em three}  operations:
%
$$V:Var\sr Term$$
$$S: Term\sr Term$$
$$O:1\sr Term$$
%
More generally, one associates to an algebraic signature with the set of sorts $D$ and a set of operations $Op_0$ a nominal signature where 
%
$$Op=Op_0\coprod\{v_D\}_{D\in {\bf D}}$$
%
with 
%
$$v_D:Var\sr D$$
%
and for $O\in Op_0$ the nominal arity of $O$ being
%
$$O:(D_1,\dots,D_n)\sr D$$
%
for some $n\in\nat$ and $D_1,\dots,D_n,D\in {\bf D}$ where $n$ and $D$'s may depend on $O$.  

An example of a signature where variables are not terms is given in \cite{Pitts}. 

A nominal signature can be used to construct terms of all compound sorts in the more or less obvious way. Next one defines the notion free and bound occurrences of variables in these terms and the notion of the  $\alpha$-equivalence. For a nominal signature $\Sigma$ and a compound sort $S$ one writes $\Sigma_{\alpha}(S)$ for the set of $\alpha$-equivalence classes of terms of sort $S$ build using $\Sigma$.

In the case when $\Sigma$ is the $\lambda$-calculus signature one gets the usual set of $\alpha$-equivalence classes of $\lambda$-terms considering $\Sigma_{\alpha}(Term)$. 

To any nominal signature $\Sigma$ one associates, following \cite{Pitts}, a functor $T_{\Sigma}:Nom^{\bf D}\sr Nom^{\bf D}$ where $Nom$ is the category of nominal sets, as follows.

First one associates a functor $[S]:Nom^{\bf D}\sr Nom$ to any compound sort $S$ by the rule:
%
$$[Var](X)={\bf A}$$
$$[D](X)=X_D$$
$$[1](X)=1$$
$$[(S_1,S_2)](X)=X\times X$$
$$[(Var.S)]=[{\bf A}](X)$$
%
where ${\bf A}$ is the standard atomic nominal set (the set of names with the canonical action of the permutation group $Perm$) and $[{\bf A}]$ is the name-abstraction functor $Nom\sr Nom$ which is defined in \cite[Section 4]{Pitts}. 

Let $Op_D$ for $D\in {\bf D}$ be the set of operations $O$ with the target sort $D$, i.e., such that $Ar_{\bf D}(O)=D$.  Then one defines $T_{\Sigma}(X)$ by the rule
%
$$T_{\Sigma}(X)_D=\coprod_{O\in Op_D} [Ar_{CS}(O)].$$
%
For example, if $\Sigma$ is the signature of $\lambda$-calculus then 
%
$$T_{\Sigma}(X)={\bf A}\coprod [{\bf A}](X)\coprod (X\times X)$$
%

One of the main results of \cite{Pitts} is that the functor $T_{\Sigma}$ has an initial algebra $I_{\Sigma}$ for any $\Sigma$ and $(I_{\Sigma})_D=\Sigma_{\alpha}(D)$. 

Let us extend this construction to a monad on $Nom^{\bf D}$ and then on $Sets^{\bf D}$. First observe that for any $X\in Nom^{\bf D}$ the functor $Y\mapsto T_{\Sigma}(Y)\coprod X$ is finitely presented and therefore it has an initial algebra. Let us denote this algebra by $NR_{\Sigma}(X)$. 

By \cite[pp. 243-244]{Awodey2010}, $NR_{\Sigma}$ is a monad on $Nom^{\bf D}$ whose category of algebras is equivalent to the category of $T_{\Sigma}$-algebras (i.e. $NR_{\Sigma}$ is the free monad generated by $T_{\Sigma}$).

The functor $Discr:Sets \sr Nom$ which takes a set to the corresponding discrete nominal set has a right adjoint $Inv:Nom\sr Sets$ which sends a nominal set $X$ to the set of its fixed points $X^{Perm}$. The functors $Discr^{\bf D}$ and $Inv^{\bf D}$ form an adjoint pair between the categories $Nom^{\bf D}$ and $Sets^{\bf D}$.

Given a monad $R$ on a category $\cal C$ and an adjoint pair $(LF,RF)$ where $RF:{\cal C}\sr{\cal C}'$ is the right adjoint, the composition $R'=RF\circ R\circ LF$ is a monad on ${\cal C}'$.

Applying this fact to the monad $NR_{\Sigma}$ and the pair $(Discr^{\bf D},Inv^{\bf D})$ we conclude that the functor 
%
$$R_{\Sigma}:X\mapsto NR_{\Sigma}(Discr^{\bf D}(X))^{Perm}$$
% 
is a monad on $Sets^{\bf D}$.

For a family of sets $X$ the functor $T_{\Sigma}\coprod Discr^{\bf D}(X)$ is naturally isomorphic to the functor $T_{\Sigma+X}$ where $\Sigma+X$ is the signature with the set of operations $Op\coprod (\coprod_{D\in {\bf D}} X_D)$ and the arity function defined on $x\in X_D$ by $Ar(x)=(1,D)$ and
%
$$R_{\Sigma}(X)=NR_{\Sigma}(Discr^{\bf D}(X))^{Perm}=I_{T_{\Sigma}\coprod Discr^{\bf D}(X)}^{Perm}=I_{T_{\Sigma+X}}^{Perm}.$$
%
Therefore
%
$$(R_{\Sigma}(X))_D=(\Sigma+X)_{\alpha}(D)^{Perm}$$
%
is the set of invariants in the set of $\alpha$-equivalence classes of terms of sort $D$ with respect to the signature $\Sigma+X$ i.e. the set of $\alpha$-equivalence classes of closed terms of sort $D$ with respect to $\Sigma+X$. 

If $X_D=\{x_{1,D},\dots,x_{n_D,D}\}$ are finite sets, then the terms with respect to the signature $\Sigma+X$ can be seen as terms with respect to $\Sigma$ which depend on additional parameters $x_{i,D}$ of the corresponding sorts and the closed terms as the terms with respect to $\Sigma$ relative to the name space ${\bf A}^{\bf D}+X$ such that all the occurrences of names from ${\bf A}^{\bf D}$ are bound and all the occurrences of names from $X$ are free. 

To obtain from this construction a pair $(\rr,\lm)$ of a monad on $Sets$ and a left module over this monad with values in $Sets$ we will use Lemma \ref{2014.07.28.l3}. Let $Term\in{\bf D}$ and ${\bf Type}\subset{\bf D}$. Let $P$ a family of sets parametrized by ${\bf D}-{Term}$. For a set $X$ let $(X,P)$ be the family such that $(X,P)_{Term}=X$ and $(X,P)_{D}=P_{D}$ for $D\ne Term$. 

Then $X\mapsto (R_{\Sigma}(X,P))_{Term}$ is a monad $R_{\Sigma,Term,P}$ on $Sets$ by Lemma \ref{2014.07.28.l2} and 
%
$$X\mapsto \coprod_{D\in {\bf Type}} (R_{\Sigma}(X,P))_D$$
%
is a left module $LM_{\Sigma,Term,P,{\bf Type}}$ over $R_{\Sigma,Term,P}$ by Lemmas \ref{2014.07.28.l3} and \ref{2014.07.28.l1}(b). 
%
\begin{example}\rm
The C-systems of generalized algebraic theories (GATs) of \cite{Cartmell0},\cite{Cartmell1} (see also \cite{Garner}) are obtained by using algebraic signatures with two data sorts ${\bf D}=\{Term,Type\}$, ${\bf Type}=\{Type\}$ and $P=\emptyset$. The ``symbols'' of the GAT are operations of the corresponding algebraic signature. The term symbols of degree $n$ have arity $(Term,\dots,Term)\sr Term$ and the type symbols of degree $n$ have arity $(Term,\dots,Term)\sr Type$ where in both cases the length of the sequence $(Term,\dots,Term)$ is $n$. 
\end{example}
%
\begin{example}
\llabel{2014.08.ex}\rm
###not correct! M-L uses only one or two quantifiers the rest are treated using lambda-abstraction
To define the Martin-L\"{o}f Type theory MLTT72 of \cite{ML72}  one needs to consider the case when ${\bf D}=\{Term\}$ and the nominal signature is of the form:
%
$$v:Var\sr Term$$
$$\Pi:(Term, Var.Term)\sr Term\spc\lambda:(Term,Var.Term)\sr Term$$ $$app:(Term,Term)\sr Term$$
$$\Sigma:(Term,Var.Term)\sr Term\spc pair:(Term,Term)\sr Term$$ $$E:(Term,Var.(Var.Term))\sr Term$$
$$+:(Term,Term)\sr Term\spc i:Term\sr Term\spc j:Term\sr Term$$ $$D:((Term,Var.Term),Var.Term))\sr Term$$
$$V:1\sr Term$$
$$N_n:1\sr Term\spc i_n:1\sr Term\spc R_n:(Term,\dots,Term),\dots)\sr Term$$ $$n\in\nat\spc 1\le i \le n$$
$$N:1\sr Term\spc 0:1\sr Term\spc s:Term\sr Term$$ $$R:((Term,Term),(Var.(Var.Term)))\sr Term$$

Note that in fact $E$, $D$, $R_n$, and $R$ should also have the type family $C$ (see \cite[2.3.6, 2.3.8, 2.3.10, 2.3.12]{ML72}) as an argument which, in our notation, means an additional component of the form $Var.Term$ in their arities.  

In fact, the original definition from \cite{ML72} allows for additional ``type constants'' (see \cite[2.2.1]{ML72}) of various algebraic arities which are analogous to the predicate constants in the predicate logic. As such it is a definition of a family of type systems. The signatures underlying all type systems in this family are obtained by extending the signature described above by a set of operations of the form $P:(Term,\dots,Term)\sr Term$. 

For the signature of the MLTT79 see \cite[p. 158]{MLTT79}
\end{example}
%
\begin{remark}\rm
It is possible to ``encode'' a nominal signature in typed $\lambda$-calculus using the idea that closed terms are objects of a base type $term$, terms with one free variable are objects of the type $term\sr term$, terms with two free variables are objects of $term\sr term\sr term$ etc. This encoding allows one to describe the substitutions of closed terms into terms with free variables as applications in the meta-theory.  However, it does not allow to describe the substitution of, e.g., terms with one free variable into terms with one free variable, i.e., the full monadic structure is not recoverable from such a description. This is the reason why the use of typed $\lambda$-calculus systems such as the Logical Framework for the description of the syntax of dependent type theories is of limited use.
\end{remark}
%



\comment{To be more precise, the input data consists of a nominal signature $\Sigma$ with one name-sort and a set of data-sorts $\bf D$, a distinguished data-sort $Term\in {\bf D}$, a subset of data-sorts ${\bf Type}\subset {\bf D}$ and a family of sets $(P_{D})_{D\in {\bf D}-\{Term\}}$ parametrized by data-sorts distinct from $Term$. For such a quadruple we describe a monad $R$ such that $R(X)$ is the set of $\alpha$-equivalence classes of expressions of sort $Term$ with variables from the name-space 
%
$$varnames := {\bf A}\amalg X\amalg (\amalg_{D\in {\bf D}-\{Term\}} P_D)$$
%
where ${\bf A}$ is a countable set, all occurrences of variables from ${\bf A}$ are bound and all occurrences of variables from $X\coprod (\coprod_{D\in {\bf D}-\{Term\}} P_D)$ are free. Note that $R(X)$ depends, up to a canonical isomorphism, only on $X$ but not on the choice of a countable set ${\bf A}$.  We also describe a left module $LM$ over $R$ such that $LM(X)$ is the disjoint union of $\alpha$-equivalence classes of similar expressions of sorts $D$ for $D\in {\bf Type}$. 

When $\Sigma$ Suppose now that we are given a type theory based on the syntax of expressions with free and bound variables specified by a nominal signature $\Sigma$ with one name-sort $var$ and one data-sort $Term$ that is formulated in terms of four kinds of basic judgements originally introduced by Per Martin-L\"{o}f in \cite[p.161]{MLTT79}.  

Choosing $\bf Type$ to be $\{Term\}$ we obtain a pair $(\rr,\lm)$ where $LM$ is isomorphic to $R$ considered as a left module over itself. For a set $X$ the set $R(X)$ is the set of $\alpha$-equivalence classes of $\Sigma$-expressions over the name space ${\bf A}\amalg X$ where all occurrences of names from $\bf A$ are bound and all occurrences of names from $X$ are free.  

Since we are only interested in the $\alpha$-equivalence classes of judgements we may assume that the variables declared in the context are taken from the set of natural numbers such that the first declared variable is $1$, the second is $2$ etc.  Then, the set of judgements of the form $(1:A_1,\dots,n:A_n\rhd A\, type)$ (in the notation of Martin-L\"{o}f ``$A\,type\,(1\in A_1,\dots,n\in A_n)$'') can be identified with the set of judgements of the form $(1:A_1,\dots,n:A_n, n+1:A\rhd)$ stating that the context $(1:A_1,\dots,n:A_n, n+1:A)$ is well-formed. 

With this identification the type theory is specified by four sets $C,\wt{B},Beq$ and $\wt{Beq}$ where 
%
$$C \subset \coprod_{n\in\nat} R({stn(0)})\times\dots\times R({stn(n-1)})$$
$$\wt{B}\subset  \coprod_{n\in\nat} R({stn(0)})\times\dots\times R({stn(n-1)})\times R({stn(n)})\times R({stn(n)})$$
$$Beq \subset \coprod_{n\in\nat} R({stn(0)})\times\dots\times R({stn(n-1)})\times R({stn(n)})^2$$
$$\wt{Beq} \subset \coprod_{n\in\nat} R({stn(0)})\times\dots\times R({stn(n-1)})\times R({stn(n)})^2\times R({stn(n)})$$ 
%
and Proposition \ref{2014.07.10.prop1} spells out the necessary and sufficient conditions that these sets should satisfy in order for it to be possible to construct from them a C-system. 





More generally, one may consider the case when $\Sigma$ has more than one data-sort as is for example the case in the description of type theories where there is a strict distinction between type expressions and term expressions. In order to define the associated C-system one only needs to have the substitution of expressions for variables when expression is a term expression i.e. an expression of the sort $Term$. Also not all data-sorts of the signature need to correspond to type expressions as for example in the case of logic enriched type theory (see \cite{AczelGambino}) where there is an additional data-sort of propositional expressions. This leads to the idea to consider $\bf Type$ in our construction as a subset of the set of data-sorts of the signature. In order to have everything properly defined one also needs to specify a family $P$. While one can always take it to be the family of empty sets it might be interesting to consider also non-empty cases which correspond to the C-systems determined by a choice of fixed sets of variables or parameters of data-sorts other than the $Term$ sort. 

}

}



\comment{

\begin{lemma}
\llabel{2014.07.28.l2}
Let $R$ be a monad on the product category ${\cal C}\times {\cal D}$. Let $A\in {\cal D}$. Then the functor $R_{A,1}:X\mapsto pr_{\cal C}(R(X,A))$ has a natural structure of a monad on $\cal C$.
\end{lemma}
%
\begin{proof}
One defines the morphisms $\eta_X:X\sr R_{A,1}(X)$ by
%
$$\eta_X := pr_{\cal C}(\eta_{(X,A)})$$
%
and morphisms $ \bind(f):R_{A,1}(X)\sr R_{A,1}(X')$ for $f:X\sr R_{A,1}(X')$ by
%
$$ \bind(f) := pr_{\cal C}( \bind(f,pr_{\cal D}(\eta_{(X,A)})))$$
%
The verification of the conditions of Lemma \ref{2014.06.30.l1} is straightforward. 
\end{proof}
% 

}



%
\comment{

\begin{lemma}
\llabel{2014.07.28.l1}
Let $R$ be a monad on a category $\cal C$. Then one has:
%
\begin{enumerate}
\item If $LM_1$, $LM_2$ are left $R$-modules with values in ${\cal D}_1$ and ${\cal D}_2$ respectively then the functor $X\mapsto (LM_1(X),LM_2(X))$ has a natural structure of a left $R$-module with values in ${\cal D}_1\times {\cal D}_2$.
\item If $LM$ is a left $R$-module with values in $\cal D$ and $F:{\cal D}\sr {\cal D'}$ is a functor then $F\circ LM$ has a natural structure of a left $R$-module with values in $\cal D'$.
\end{enumerate}
\end{lemma}
%
\begin{proof}
Straightforward.
\end{proof}
%
\begin{lemma}
\llabel{2014.07.28.l3}
Under the assumptions and in the notation of Lemma \ref{2014.07.28.l2} the morphisms
%
$$\mbind(f:X\sr R_{A,1}(X'))= \bind(f, pr_{\cal D}(\eta_{(X',A)})) : R(X,A)\sr R(X',A)$$
%
define a structure of a left $R_{A,1}$-module with values in ${\cal C}\times {\cal D}$ on the functor 
%
$$M_{A,1}:X\mapsto R(X,A)$$
%
\end{lemma}
%
\begin{proof}
Direct verification of the conditions of Definition \ref{2014.07.26.d1}.
\end{proof}
%
}


\comment{
%
\begin{definition}
\llabel{2015.07.29.def1}
A Kleisli triple (or simply a triple) on a category $\cal C$ is a collection of data of the form:
%
\begin{enumerate}
\item for every object $X$ an object $R(X)$,
\item for every object $X$ a morphism $\eta_X:X \sr R(X)$,
\item for every two objects $X$, $X'$ and a morphism $f:X\sr R(X')$, a morphism 
%
$$\bind(f):R(X)\sr R(X')$$
%
\end{enumerate}
%
such that:
%
\begin{enumerate}
\item for any object $X$ one has
%
$$\bind(\eta_X)=id_{R(X)}$$
%
\item for any morphism of the form $f:X\sr R(X')$ one has
%
$$\eta_X\circ \bind(f)=f$$
%
\item for any two morphisms of the form $f:X\sr R(X')$, $g:X'\sr R(X'')$ one has
%
$$\bind(f\circ\bind(g))=\bind(f)\circ\bind(g).$$
%
\end{enumerate}
\end{definition}
%
\begin{problem}
\llabel{2015.07.30.prob1}
For a monad $(R,\eta,\mu)$ on $\cal C$ to construct a triple on $\cal C$.
\end{problem}
%
\begin{construction}\rm
\llabel{2015.07.30.constr1}
One defines $R$ of the triple to be the same as $R_{Ob}$ where $R=(R_{Ob},R_{Mor})$ is the functor component of the monad. One defines $\eta$ of the triple to be the same as $\eta$ of the monad. For $f:X\sr R_{Ob}(X')$ one defines $\bind(f)$ by the formula
%
$$\bind(f)=R_{Mor}(f)\circ \mu_{X'}$$
%
For the for the first two axioms we have
%
$$\bind(\eta_X)=R(\eta_X)\circ \mu_X=Id_{R(X)}$$
$$\eta_X\circ \bind(f)=\eta_X\circ R(f)\circ \mu_{X'}=f\circ \eta_{R(X')}\circ \mu_{X'}=f\circ Id_{R(X')}=f$$
%
and for the third one:
%
$$\bind(f\circ \bind(g))=R(f\circ \bind(g))\circ \mu_{X''}=R(f)\circ R(R(g)\circ \mu_{X''})\circ \mu_{X''}=R(f)\circ R(R(g))\circ R(\mu_{X''})\circ \mu_{X''}=R(f)\circ R(R(g))\circ \mu_{R(X'')}\circ \mu_{X''}$$
%
and
%
$$\bind(f)\circ \bind(g)=R(f)\circ \mu_{X'}\circ R(g)\circ \mu_{X''}$$
%
and
%
$$R(R(g))\circ \mu_{R(X'')}=\mu_{X'}\circ R(g)$$
%
This completes Construction \ref{2015.07.30.constr1}.
\end{construction}
%
\begin{problem}
\llabel{2015.07.30.prob2}
Given a triple $(R,\eta,\bind)$ on $\cal C$ to construct a monad $(R,\eta,\mu)$ on $\cal C$.
\end{problem}
%
\begin{construction}\rm
\llabel{2015.07.30.constr2}
One takes $R_{Ob}$ of the functor component of the monad to be $R$. For $f:X\sr Y$ one defines
%
$$R_{Mor}(f)=\bind(f\circ \eta_Y)$$
%
One takes $\eta$ component of the monad to be the $\eta$ component of the triple. For an object $X$ one defines $\mu_X$ by the formula
%
$$\mu_X=\bind_{Id(R(X))}$$
%
We leave the verification of the axioms of the monad to the formalized versions of the paper. 
\end{construction}
}



\comment{

\subsection{Monads on sets and their left modules} 


In the case of a monad $R$ on $Sets$ and a left $R$-module $LM$ with values in $Sets$, for $X=\{x_1,\dots,x_n\}$, $E\in LM(X)$ and $f:X\sr R(Y)$ such that $f(x_i)=f_i$ we often write $\mbind(f)(E)$ as $E(f/x)$ or $E(f_1/x_1,\dots,f_n/x_n)$. We also often write $x_i$ for $\eta_{X}(x_i)$. 

In this notation the first condition of Definition \ref{2014.07.26.d1} is that $E(x/x)=E$ and the second condition is that if $f:\{x_1,\dots,x_n\}\sr R(\{y_1,\dots,y_o\})$ and $g:\{y_1,\dots,y_o\}\sr R(Z)$ then $E(f/x)(g/y)=E(f_1(g/y)/x_1,\dots,f_n(g/y)/x_n)$\footnote{Note that this rule refers to the case when one substitutes {\em all} free variables of an expression so that the usual condition that $y_1,\dots,y_o$ don't occur in $E$ is not required.}.

For $E\in LM({stn(m)})$ and $n\ge 1$ we set:
%
$$t_n(E)=E(1/1,\dots,n-1/n-1,n+1/n,n+2/n+1,\dots,m+1/m)\in LM(\wh{m+1})$$
$$s_n(E)=E(1/1,\dots,n/n,n/n+1,n+1/n+2,\dots,m-1/m) \in LM(\wh{m-1})$$
%
If we were numbering elements of a set with $n$ elements from $0$ then in views of Definition \ref{2014.07.26.d1}(3) we would have $t_n=LM(\partial_{n-1})$ and $s_n=LM(\sigma_{n-1})$ where $\partial_i$ and $\sigma_i$ are the usual generators of the simplicial category. 

In particular $t_{m+1}=LM(i_m)$ where $i_m:\wh{m+1}\sr \wh{m}$ is the morphism corresponding to the function given by $j\mapsto j$ for $j=1,\dots,m$. For $E\in LM({stn(m)})$ we will often write $E$ instead of $t_{m+1}(E)$.

For a monad $R$ on $Sets$ we let $R-cor$ (``R-correspondences'') to be the full subcategory of the Kleisli category of $R$ whose objects are finite sets. Recall, that the set of morphisms from $X$ to $Y$ in $R-cor$ is the set of maps from $X$ to $R(Y)$ i.e. $R(Y)^X$ (in other words, $R-cor$ is the 
category of free, finitely generated $R$-algebras).   

We further let ${C(\rr)}$ denote the pre-category\footnote{See the introduction to \cite{Csubsystems}.}  with 
%
%
$$Ob({C(\rr)})=\nn$$
$$Mor({C(\rr)})=\coprod_{m,n\in\nn} Fun({stn(n)},R({stn(m)}))$$
%
%
where $Fun(A,B)$ is the set of functions from the set $A$ to the set $B$. The identity morphism of $n$ is given by $\eta_{{stn(n)}}$. The composition of morphisms is given by 
%
$$f\circ g=f\circ_{Sets} \bind(g)$$
%
Let $F$ be the category such that
%
$$Ob(F)=\nn$$
$$Mor(F)=\amalg_{m,n\in\nn}Fun({stn(m)},{stn(n)})$$
%
Then there is a functor $Crc_2:F^{op}\sr {C(\rr)}$ that is identity on objects and sends a morphism $f=(m,n,f_0)$ where $f_0\in Fun({stn(n)},{stn(m)})$ to $(m,n,f_0\circ \eta_{m})$. We will often use this functor as a ``coercion'', using the terminology of proof assistant Coq, i.e., we will write simply $f$ instead of $\Phi(f)$. 

A left $R$-module $LM$ defines as outlined in \cite[Def. 10]{HM2010} a covariant functor on the Kleisli category of $R$ and correspondingly a contravariant functor (a presheaf) $LM_{PreShv}$ on ${C(\rr)}$. This presheaf is given by:
%
\begin{enumerate}
\item for $n\in Ob({C(\rr)})$ one has $LM_{PreShv}(n)=LM(n)$,
\item for $f:m\sr n$ in ${C(\rr)}$ and $E\in LM_{PreShv}(n)$ one has
%
$$LM_{PreShv}(f)(E)=\mbind(f)(E)$$
%
\end{enumerate}
%
In what follows we will write $LM$ instead of $LM_{PreShv}$.  

\comment{
For two morphisms 
%
$$f:\wh{n_1}\sr \wh{n_2}\spc f=(f_1,\dots,f_{n_2})\spc where\spc f_i\in R(\wh{n_1})$$
$$g:\wh{n_2}\sr \wh{n_3}\spc g=(g_1,\dots,g_{n_3})\spc where\spc g_i\in R(\wh{n_2})$$
%
their composition is given by
%
\begin{eq}\llabel{2015.07.26.eq1}
f\circ g:\wh{n_1}\sr \wh{n_3}\spc f\circ g=((f\circ g)_1,\dots,(f\circ g)_{n_3}) \spc where\spc (f\circ g)_i\in R(\wh{n_3})
\end{eq}
%
and 
%
\begin{eq}\llabel{2015.07.26.eq2}
(f\circ g)_i=(f_1,\dots,f_{n_2})\circ g_i=g_i(f_1/1,\dots,f_{n_2}/n_2)
\end{eq}
%
}
%
\begin{remark}\rm
A finitary monad (on sets) is a monad $R:Sets\sr Sets$ that, as a functor, commutes with filtering colimits. Since any set is, canonically, the colimit of the filtering diagram of its finite subsets, a functor $Sets \sr Sets$ that commutes with filtering colimits can be equivalently described as a functor $FSets \sr Sets$ where $FSets$ is the category of finite sets. Furthermore, Lemma \ref{2014.06.30.l1} can be used to show that finitary monads on $Sets$ can be defined as collections of data of the form:
%
\begin{enumerate}
\item for every finite set $X$ a set $R(X)$,
\item for every finite set $X$ a function $\eta_X: X \sr R(X)$,
\item for every finite sets $X$, $X'$ and a function $f:X\sr R(X')$, a function $ \bind(f):R(X)\sr R(X')$
\end{enumerate}
%
which satisfy the conditions:
%
\begin{enumerate}
\item for a finite set $X$, $\bind(\eta_X)=id_{R(X)}$,
\item for a function of finite sets $f:X\sr X'$, $\eta_X\circ \bind(f)=f$,
\item for two functions $f:X\sr R(X')$, $g:X'\sr R(X'')$, $ \bind(f\circ \bind(g))= \bind(f)\circ \bind(g)$.
\end{enumerate}
%
This description shows how any monad $R$ defines a finitarty monad $R^{fin}$ whose underlying functor is obtained by first taking the restriction of $R$ to a functor $R_{FSets}:FSets\sr Sets$ and then the extension of $R_{FSets}$ to a finitary functor $R^{Fin}:Sets\sr Sets$. 

Similar observation applies to left $R$-modules. The constructions of this paper, while done for a general pair $(\rr,\lm)$, only depend on the corresponding finitary pair $(R^{fin},LM^{fin})$. 
\end{remark}
%
\begin{remark}\rm
The correspondence $R\mapsto {C(\rr)}$ defines an equivalence between the type of the finitary monads on $Sets$ and the type of the pre-category structures on $\nn$ that extend the pre-category structure of finite sets and where the addition remains to be the coproduct. 
\end{remark}
%
\begin{remark}\rm A finitary sub-monad of $R$ is the same as a sub-pre-category in ${C(\rr)}$ which contains all objects. Intersection of two sub-monads is a sub-monad which allows one to speak of sub-monads generated by a set of elements. 
\end{remark}

}


\comment{ Let $C(\rr)$ be the category whose set of objects is the set of symbols of the form $\wh{n}$ where $n\in \nn$ and the set of morphisms is 
%
$$Mor(C(\rr))=\amalg_{\wh{m},\wh{n}}Hom_{Sets_R}(stn(n),stn(m))=\amalg_{\wh{m},\wh{n}} R(stn(m))^{stn(n)}$$
%
The domain and codomain functions $Mor(C(\rr))\sr Ob(C(\rr))$ are defined in the obvious way and the identity and composition are defined in such a way that the mapping $\wh{n}\mapsto stn(n)$ extends to a fully faithful functor $cr_1:C(\rr)^{op}\sr Sets_R$. The unity and the associativity of composition in $C(\rr)$ follows immediately from the unity and associativity of composition in $Sets_R$ which is proved in \cite{Kleisli} (cf. also Construction \ref{2015.07.30.constr3}). 

If $LM$ is a left module over $R$ with values in $Sets$ then the functor $cr_1$ composed with the Kleisli extension $LM_R:Sets_R\sr Sets$ of $LM$  gives a presheaf on $C(\rr)$. We will use both the Kleisli extension construction and the composition with $cr_1$ as ``coercions'' in the terminology of the Coq proof assistant, i.e., we will write $LM$ instead of both $LM_R$ and $cr_1\circ LM_R$. 

Let $F$ be the category whose objects are natural numbers and
%
$$Mor(F)=\amalg_{m,n}Fun(stn(m),stn(n))$$
%
Then for any $R$, there is an obvious functor $cr_0:F\sr C(\rr)^{op}$. 
%
We will use $cr_0$ as a coercions as well, i.e., we will write $f$ instead of $cr_0(f)$.
%
\begin{remark}\rm
\llabel{2015.08.12.rem2}
The pair $(C(\rr)^{op}, cr_0)$ is an algebraic theory in the sense of Lawvere (cf. \cite[Definition on p.62]{Lawvere}). 

The functor $cr_1\circ LM_R:C(\rr)^{op}\sr Sets$ is, by Lawvere's terminology, a pre-coalgebra over this theory (cf. \cite[Ch. III, \S 1]{Lawvere}). Since the construction of $CC(\rr,\lm)$ uses only $C(\rr)$ and $cr_1\circ LM_R$ it could be directly formulated as a construction of a C-system from an algebraic theory and a pre-coalgebra over this theory. However we find the formulation based on a monad and a module over a monad to be easier to understand for a mathematical reader. 
\end{remark}
%
}

\comment{
\begin{problem}
\llabel{2015.07.30.prob3}
Given a monad $(R,\eta,\mu)$ on a precategory $\cal C$ to construct a new precategory ${\cal C}_R$ and a functor $G_R:{\cal C}\sr {\cal C}_R$.
\end{problem}
%
The following construction is due to Kleisli and first appeared in \cite{Kleisli}. Kleisli  worked with the dual concept that we today would call a co-monad. To obtain the correct correspondence between his construction and Construction \ref{2015.07.30.constr3} one needs to replace his $\cal L$ by our ${\cal C}^{op}$, his $\cal K$ by our $({\cal C}_R)^{op}$ and his $G$ by our $(G_R)^{op}$. 
%
\begin{construction}\rm
\llabel{2015.07.30.constr3}
We set $Ob({\cal C}_R)=Ob({\cal C})$ and
%
$$Mor({\cal C}_R)=\amalg_{X,Y\in Ob({\cal C})}Hom_{\cal C}(X, R(Y))$$
%
For $X\in Ob({\cal C})$ define $Id_X$ in $Mor({\cal C}_R)$ by the formula
%
$$Id_{X, {\cal C}_R}=(X,(X,\eta_X))$$
%
For $f=(X,(X',f_0:X\sr R(X')))$ and $g=(X',(X'',g_0:X'\sr R(X'')))$  in $Mor({\cal C}_R)$  define their composition $f\circ g$ by the formula
%
$$f\circ g=(X,(X'', f_0\circ R(g_0)\circ \mu_{X''}))$$
%
Define the object component $(G_R)_{Ob}$ of the functor $G_R$ to be the identity function of $Ob({\cal C})$ the morphism component by the formula
%
$$(G_R)_{Mor}(f:X\sr X')=(X,(X',f\circ \eta_{X'}))$$
%
For the verification of the axioms needed for the proof that these data defines a category and a functor we refer to  \cite{Kleisli}. 
\end{construction}
%
The category ${\cal C}_R$ specified by Construction \ref{2015.07.30.constr3} is called the Kleisli category of $R$. 
%



\begin{remark}\rm
\llabel{2015.08.12.rem3}
In the univalent foundations the relationship between the type of finitary functors $Sets\sr Sets$ (where by $Sets$ we mean the category of h-sets in a fixed universe) and the type of functors $FSets\sr Sets$ is not entirely clear at the moment. On the other hand the relationship between the type of functors $FSets\sr Sets$ and the type of functors $F\sr Sets$ is better in the univalent foundations then in the set-theoretic ones since in the univalent foundations these two types are constructively equivalent (cf. \cite[Theorem 8.4]{RezkCompletion}).
\end{remark}
%


%
Definition \ref{2015.07.30.def1} below is, according to Manes \cite[p.30]{Manes}, due to Godement \cite{Godement}. See also \cite[Ch. VI]{MacLane}.
%
\begin{definition}
\llabel{2015.07.30.def1}
A monad on a category $\cal C$ is a collection of data of the form:
%
\begin{enumerate}
\item a functor $R:{\cal C}\sr {\cal C}$,
\item for any $X\in {\cal C}$, a morphism $\eta_X:X\sr R(X)$,
\item for any $X\in {\cal C}$, a morphism $\mu_X:R(R(X))\sr R(X)$
\end{enumerate}
%
such that:
%
\begin{enumerate}
\item for any $f:X\sr Y$ one has 
%
\begin{enumerate}
\item $\eta_X\circ R(f)=f\circ \eta_Y$,
\item $\mu_X\circ R(f)=R(R(f))\circ \mu_Y$,
\end{enumerate}
%
\item for any $X$ one has 
%
$$R(\mu_X)\circ \mu_X=\mu_{R(X)}\circ \mu_X$$
%
\item for any $X$ one has
%
$$R(\eta_X)\circ \mu_X=Id_{R(X)}$$
%
and
%
$$\eta_{R(X)}\circ \mu_X=Id_{R(X)}$$
%
\end{enumerate}
\end{definition}
%
\begin{remark}\rm
\llabel{2015.07.30.rem1a}
It is very easy to construct an equivalence between the type of monads on a given precategory $\cal C$ (resp. a bijection between the set of monads on $\cal C$) and the type (resp. set) of monoids in the category $Funct({\cal C},{\cal C})$ with respect to the monoidal structure given by the composition of functors. This equivalence, in the case of a type theoretic formalization, is actually an isomorphism where by an isomorphism we mean an isomorphism of the corresponding objects of the syntactic category. 
\end{remark}
%
\begin{remark}\rm
\llabel{2015.08.12.rem1}
There are at least two other definitions that specify, over any universe, types of objects that are equivalent to the type of monads. Objects specified by one of these definition are called by Manes ``algebraic theories in clone form in $\cal C$''. See \cite[Def. 3.2, p.24]{Manes}. The objects specified by another one, which appears in \cite[Exercise 12, p.32]{Manes} and then more explicitly in \cite{Moggi91} are called by Moggi  ``Kleisli triples''. Kleisli triples are more popular than monads in papers related to computer science while monads are more popular in mathematical papers. Formally proving the equivalence between these three definitions as well as constructing examples that show that these equivalences are not isomorphisms in the syntactic category may be the topic for a small project in univalent formalization.

An analogous project in the set-theoretic formalization should be able to construct bijections between the corresponding sets because the underlying function $R_{Ob}:Ob({\cal C})\sr Ob({\cal C})$ remains unchanged by the corresponding equivalences and therefore they can be seen as bijections between the sets of monad, algebraic theory in clone form, and Kleisli triple structures on a given function $R_{Ob}$.
\end{remark} 
%

\begin{definition}
\llabel{2015.07.30.def4}
Let $\cal C$ be a category and $(R,\eta,\mu)$ a monad on $\cal C$. A left module over $R$ with values in a category $\cal D$ is a collection of data of the following form
%
\begin{enumerate}
\item a functor $LM:{\cal C}\sr {\cal D}$,
\item for any $X\in {\cal C}$ a morphism $\rho_X:LM(R(X))\sr LM(X)$
\end{enumerate}
%
such that:
%
\begin{enumerate}
%
\item for any $f:X\sr Y$ one has 
%
$$\rho_X\circ LM(f)=LM(R(f))\circ \rho_Y$$
%
\item for any $X$ one has:
%
$$LM(\eta_X)\circ \rho_X=Id_{LM(X)}$$
%
and
\item for any $X$ one has:
%
$$LM(\mu_X)\circ \rho_X=\rho_{R(X)}\circ \rho_X$$
%
\end{enumerate}
\end{definition}
%
\begin{example}\rm
\llabel{2015.07.30.ex1}
Taking ${\cal D}={\cal C}$, $LM=R$ and $\rho=\mu$ one obtains a left module over $R$ whose underlying functor is $R$ itself. 
\end{example}
%
\begin{remark}\rm
\llabel{2015.07.30.rem1}
It is very easy to construct an equivalence between the type of left modules over a given monad (resp. a bijection between the set of left modules over a given monad) with values in the same category $\cal C$ and the type (resp. set) of left modules over the corresponding monoid in the monoidal category $(Funct({\cal C},{\cal C}),\circ)$. In the type theoretic case this equivalence is an isomorphism of the corresponding objects of the syntactic category. 
\end{remark}
%
The following construction was, to the best of our knowledge, first described in \cite[Def. 10, p.550]{HM2010} under the name of a Kleisli extension. 
%
\begin{problem}
\llabel{2015.07.30.prob5}
For a monad $R$ and a left module $LM$ over $R$ to construct a functor $LM_R:{\cal C}_R\sr {\cal D}$.
\end{problem}
%
\begin{construction}\rm
\llabel{2015.07.30.constr4}
We define the object component of $LM_R$ to be the object component of $LM$. For $f=(X,(X',f_0))$ in $Mor({\cal C}_R)$ we define 
%
$$(LM_R)_{Mor}(f)=LM(f_0)\circ \rho_{X'}$$
%
For the identity morphism axiom we have
%
$$LM_R(Id_X)=LM_R((X,(X,\eta_X)))=LM(\eta_X)\circ \rho_X=Id_{LM(X)}$$
%
For the composition axiom we have
%
$$LM_R((X,(X',f_0))\circ (X',(X'',g_0)))=LM_R((X,(X'',f_0\circ R(g_0)\circ \mu_{X''})))=$$$$LM(f_0\circ R(g_0)\circ \mu_{X''})\circ \rho_{X''}=LM(f_0)\circ LM(R(g_0))\circ LM(\mu_{X''})\circ \rho_{X''}=$$$$LM(f_0)\circ LM(R(g_0))\circ \rho_{R(X'')}\circ \rho_{X''}=LM(f_0)\circ \rho_{X'}\circ LM(g_0)\circ \rho_{X''}$$
%
and
%
$$LM_R((X,(X',f_0)))\circ LM_R((X',(X'',g_0)))=LM(f_0)\circ \rho_{X'}\circ LM(g_0)\circ \rho_{X''}$$
%
This completes Construction \ref{2015.07.30.constr4}.
\end{construction}
%
\begin{lemma}
\llabel{2015.07.30.l1}
For a monad $R$ on $\cal C$, a left module $LM$ and $f:X\sr X'$ in $\cal C$ one has
%
$$LM_R(G_R(f))=LM(f)$$
%
\end{lemma}
%
\begin{proof}
One has
%
$$LM_R(G_R(f))=LM_R((X,(X',f\circ \eta_{X'})))=LM(f\circ \eta_{X'})\circ \rho_{X'}=LM(f)\circ LM(\eta_{X'})\circ \rho_{X'}=$$$$LM(f)\circ Id_{LM(X')}=LM(f)$$
%
\end{proof}
%
%
\begin{remark}\rm
A construction of a left $R$-module from a functor ${\cal C}_R\sr {\cal D}$ is outlined in \cite[Prop. 3]{HM2010} and in the same paper there is an outline of a proof that these two constructions are inverse to each other providing a bijection between left $R$-modules with values in a category $\cal D$ and functors ${\cal C}_R\sr {\cal D}$. This bijection is identity on the underlying functions from the type (resp. set) of objects of ${\cal C}$ to the type (resp. set) of objects of $\cal D$ so that one can talk about the bijection between the sets of a left $R$-module structures on a function $Ob({\cal C})\sr Ob({\cal D})$ and the set of functor structures on the same function considered as a function from $Ob({\cal C}_R)$. In type theoretic formalization this equivalence is not an isomorphism in the syntactic category.
\end{remark}
%


}


\comment{??? Build the example better, less confusing, separate \rr and \lm better
\begin{example}\rm
For the pre-algebraic theory of the form $LM(n)=R(n)=stn(n)$ we have $Ob(CC(\rr,\lm))=\{pt\}$ and there is only one C-subsystem, namely itself. For the pre-algebraic theory of the form $LM(n)=R(n)=stn(1)$ the C-system $CC(\rr,\lm)$ has two subsystems - itself and the trivial one for which $B={pt}$. 

The first non-trivial example is the pre-algebraic theory $R(n)=stn(n)\amalg \{*\}$ and $\lm=\rr$. In this case the set of ``expressions in n-variables'' is the set of variables itself together with one constant $*$. 

We conjecture that in this case the set of all C-subsystems of $CC(\rr,\rr)$ is {\em uncountable}.

One can probably show this as follows. Let $\epsilon:\nn\sr\{0,1\}$, be a sequence of $0$'s and $1$'s. Consider the C-subsystem $CC_{\epsilon}$ of $CC(\rr,\lm)$ which is generated by the set of elements of the form 
%
$$(*, 0,\dots,n-1\rhd^{C(\epsilon_*)})\in Ob(CC(\rr,\rr)$$
%
for all $n\in\nat$ and elements 
%
$$(*,0,\dots,n\rhd^{\wt{C}(\epsilon_*)} n+1:*)\in \wt{Ob}(CC(\rr,\rr)$$
%
for $n$ such that $\epsilon(n)=1$. It should be possible to show that $CC_{\epsilon}\ne CC_{\epsilon'}$ for $\epsilon\ne \epsilon'$ which would imply the conjecture. 

Note that unless $\epsilon(i)=0$ for all $i$, in this C-system $*$ is a universe
\end{example}
}




\bibliography{../../../alggeom}
\bibliographystyle{plain}



\end{document}


